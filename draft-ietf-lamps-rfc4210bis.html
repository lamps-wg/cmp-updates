<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Internet X.509 Public Key Infrastructure -- Certificate Management Protocol (CMP)</title>
<meta content="Hendrik Brockhaus" name="author">
<meta content="David von Oheimb" name="author">
<meta content="Mike Ounsworth" name="author">
<meta content="John Gray" name="author">
<meta content="
       This document describes the Internet X.509 Public Key Infrastructure (PKI)
Certificate Management Protocol (CMP).  Protocol messages are defined for
X.509v3 certificate creation and management. CMP provides interactions between
client systems and PKI components such as a Registration Authority (RA) and
a Certification Authority (CA). 
       This document adds support for management of certificates containing a Key Encapsulation Mechanism (KEM) public key and use
EnvelopedData instead of EncryptedValue. This document also includes the
updates specified in Section 2 and Appendix A.2 of RFC 9480. 
       The updates maintain backward compatibility with CMP version 2 wherever
possible. Updates to CMP version 2 are improving crypto agility, extending the
polling mechanism, adding new general message types, and adding extended
key usages to identify special CMP server authorizations. CMP version 3 is
introduced for changes to the ASN.1 syntax, which are support of
EnvelopedData, certConf with hashAlg, POPOPrivKey with agreeMAC, and
RootCaKeyUpdateContent in ckuann messages. 
       This document obsoletes RFC 4210 and together with I-D.ietf-lamps-rfc6712bis
and it also obsoletes RFC 9480. Appendix F of this document updates the
Section 9 of RFC 5912. 
    " name="description">
<meta content="xml2rfc 3.25.0" name="generator">
<meta content="CMP" name="keyword">
<meta content="Certificate Management" name="keyword">
<meta content="PKI" name="keyword">
<meta content="draft-ietf-lamps-rfc4210bis-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.25.0
    Python 3.12.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-lamps-rfc4210bis.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CMP</td>
<td class="right">January 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Brockhaus, et al.</td>
<td class="center">Expires 12 July 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">LAMPS Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-lamps-rfc4210bis-latest</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc4210%209480" class="eref">4210 9480</a> (if approved)</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc5912" class="eref">5912</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-01-09" class="published">9 January 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-07-12">12 July 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Brockhaus</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">D. von Oheimb</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">M. Ounsworth</div>
<div class="org">Entrust</div>
</div>
<div class="author">
      <div class="author-name">J. Gray</div>
<div class="org">Entrust</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Internet X.509 Public Key Infrastructure -- Certificate Management Protocol (CMP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the Internet X.509 Public Key Infrastructure (PKI)
Certificate Management Protocol (CMP).  Protocol messages are defined for
X.509v3 certificate creation and management. CMP provides interactions between
client systems and PKI components such as a Registration Authority (RA) and
a Certification Authority (CA).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document adds support for management of certificates containing a Key Encapsulation Mechanism (KEM) public key and use
EnvelopedData instead of EncryptedValue. This document also includes the
updates specified in Section 2 and Appendix A.2 of RFC 9480.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">The updates maintain backward compatibility with CMP version 2 wherever
possible. Updates to CMP version 2 are improving crypto agility, extending the
polling mechanism, adding new general message types, and adding extended
key usages to identify special CMP server authorizations. CMP version 3 is
introduced for changes to the ASN.1 syntax, which are support of
EnvelopedData, certConf with hashAlg, POPOPrivKey with agreeMAC, and
RootCaKeyUpdateContent in ckuann messages.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">This document obsoletes RFC 4210 and together with I-D.ietf-lamps-rfc6712bis
and it also obsoletes RFC 9480. Appendix F of this document updates the
Section 9 of RFC 5912.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    Limited Additional Mechanisms for PKIX and SMIME Working Group mailing list (spasm@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/spasm/">https://mailarchive.ietf.org/arch/browse/spasm/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/lamps-wg/cmp-updates">https://github.com/lamps-wg/cmp-updates</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 12 July 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-changes-made-by-rfc-4210" class="internal xref">Changes Made by RFC 4210</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-updates-made-by-rfc-9480" class="internal xref">Updates Made by RFC 9480</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-changes-made-by-this-docume" class="internal xref">Changes Made by This Document</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology-and-abbreviatio" class="internal xref">Terminology and Abbreviations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-pki-management-overview" class="internal xref">PKI Management Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-pki-management-model" class="internal xref">PKI Management Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="auto internal xref">3.1.1</a>.  <a href="#name-definitions-of-pki-entities" class="internal xref">Definitions of PKI Entities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1.2.1">
                        <p id="section-toc.1-1.3.2.1.2.1.2.1.1"><a href="#section-3.1.1.1" class="auto internal xref">3.1.1.1</a>.  <a href="#name-subjects-and-end-entities" class="internal xref">Subjects and End Entities</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1.2.2">
                        <p id="section-toc.1-1.3.2.1.2.1.2.2.1"><a href="#section-3.1.1.2" class="auto internal xref">3.1.1.2</a>.  <a href="#name-certification-authority" class="internal xref">Certification Authority</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1.2.3">
                        <p id="section-toc.1-1.3.2.1.2.1.2.3.1"><a href="#section-3.1.1.3" class="auto internal xref">3.1.1.3</a>.  <a href="#name-registration-authority" class="internal xref">Registration Authority</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1.2.4">
                        <p id="section-toc.1-1.3.2.1.2.1.2.4.1"><a href="#section-3.1.1.4" class="auto internal xref">3.1.1.4</a>.  <a href="#name-key-generation-authority" class="internal xref">Key Generation Authority</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="auto internal xref">3.1.2</a>.  <a href="#name-pki-management-requirements" class="internal xref">PKI Management Requirements</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="auto internal xref">3.1.3</a>.  <a href="#name-pki-management-operations" class="internal xref">PKI Management Operations</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-assumptions-and-restriction" class="internal xref">Assumptions and Restrictions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-end-entity-initialization" class="internal xref">End Entity Initialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-initial-registration-certif" class="internal xref">Initial Registration/Certification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-criteria-used" class="internal xref">Criteria Used</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.1">
                        <p id="section-toc.1-1.4.2.2.2.1.2.1.1"><a href="#section-4.2.1.1" class="auto internal xref">4.2.1.1</a>.  <a href="#name-initiation-of-registration-" class="internal xref">Initiation of Registration/Certification</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.2">
                        <p id="section-toc.1-1.4.2.2.2.1.2.2.1"><a href="#section-4.2.1.2" class="auto internal xref">4.2.1.2</a>.  <a href="#name-end-entity-message-origin-a" class="internal xref">End Entity Message Origin Authentication</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.3">
                        <p id="section-toc.1-1.4.2.2.2.1.2.3.1"><a href="#section-4.2.1.3" class="auto internal xref">4.2.1.3</a>.  <a href="#name-location-of-key-generation" class="internal xref">Location of Key Generation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1.2.4">
                        <p id="section-toc.1-1.4.2.2.2.1.2.4.1"><a href="#section-4.2.1.4" class="auto internal xref">4.2.1.4</a>.  <a href="#name-confirmation-of-successful-" class="internal xref">Confirmation of Successful Certification</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-initial-registration-certifi" class="internal xref">Initial Registration/Certification Schemes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2.2.1">
                        <p id="section-toc.1-1.4.2.2.2.2.2.1.1"><a href="#section-4.2.2.1" class="auto internal xref">4.2.2.1</a>.  <a href="#name-centralized-scheme" class="internal xref">Centralized Scheme</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2.2.2">
                        <p id="section-toc.1-1.4.2.2.2.2.2.2.1"><a href="#section-4.2.2.2" class="auto internal xref">4.2.2.2</a>.  <a href="#name-basic-authenticated-scheme" class="internal xref">Basic Authenticated Scheme</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-proof-of-possession-pop-of-" class="internal xref">Proof-of-Possession (POP) of Private Key</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="auto internal xref">4.3.1</a>.  <a href="#name-signature-keys" class="internal xref">Signature Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="auto internal xref">4.3.2</a>.  <a href="#name-encryption-keys" class="internal xref">Encryption Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="auto internal xref">4.3.3</a>.  <a href="#name-key-agreement-keys" class="internal xref">Key Agreement Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.4">
                    <p id="section-toc.1-1.4.2.3.2.4.1"><a href="#section-4.3.4" class="auto internal xref">4.3.4</a>.  <a href="#name-key-encapsulation-mechanism" class="internal xref">Key Encapsulation Mechanism Keys</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-root-ca-key-update" class="internal xref">Root CA Key Update</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-ca-operator-actions" class="internal xref">CA Operator Actions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-verifying-certificates" class="internal xref">Verifying Certificates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2.2.1">
                        <p id="section-toc.1-1.4.2.4.2.2.2.1.1"><a href="#section-4.4.2.1" class="auto internal xref">4.4.2.1</a>.  <a href="#name-verification-in-cases-1-and" class="internal xref">Verification in Cases 1 and 4</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2.2.2">
                        <p id="section-toc.1-1.4.2.4.2.2.2.2.1"><a href="#section-4.4.2.2" class="auto internal xref">4.4.2.2</a>.  <a href="#name-verification-in-case-2" class="internal xref">Verification in Case 2</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2.2.3">
                        <p id="section-toc.1-1.4.2.4.2.2.2.3.1"><a href="#section-4.4.2.3" class="auto internal xref">4.4.2.3</a>.  <a href="#name-verification-in-case-3" class="internal xref">Verification in Case 3</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-revocation-change-of-ca-key" class="internal xref">Revocation - Change of CA Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-extended-key-usage-for-pki-" class="internal xref">Extended Key Usage for PKI Entities</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-data-structures" class="internal xref">Data Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-overall-pki-message" class="internal xref">Overall PKI Message</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-pki-message-header" class="internal xref">PKI Message Header</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1.2.1">
                        <p id="section-toc.1-1.5.2.1.2.1.2.1.1"><a href="#section-5.1.1.1" class="auto internal xref">5.1.1.1</a>.  <a href="#name-implicitconfirm" class="internal xref">ImplicitConfirm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1.2.2">
                        <p id="section-toc.1-1.5.2.1.2.1.2.2.1"><a href="#section-5.1.1.2" class="auto internal xref">5.1.1.2</a>.  <a href="#name-confirmwaittime" class="internal xref">ConfirmWaitTime</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1.2.3">
                        <p id="section-toc.1-1.5.2.1.2.1.2.3.1"><a href="#section-5.1.1.3" class="auto internal xref">5.1.1.3</a>.  <a href="#name-origpkimessage" class="internal xref">OrigPKIMessage</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1.2.4">
                        <p id="section-toc.1-1.5.2.1.2.1.2.4.1"><a href="#section-5.1.1.4" class="auto internal xref">5.1.1.4</a>.  <a href="#name-certprofile" class="internal xref">CertProfile</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1.2.5">
                        <p id="section-toc.1-1.5.2.1.2.1.2.5.1"><a href="#section-5.1.1.5" class="auto internal xref">5.1.1.5</a>.  <a href="#name-kemciphertextinfo" class="internal xref">KemCiphertextInfo</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-pki-message-body" class="internal xref">PKI Message Body</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="auto internal xref">5.1.3</a>.  <a href="#name-pki-message-protection" class="internal xref">PKI Message Protection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3.2.1">
                        <p id="section-toc.1-1.5.2.1.2.3.2.1.1"><a href="#section-5.1.3.1" class="auto internal xref">5.1.3.1</a>.  <a href="#name-shared-secret-information" class="internal xref">Shared Secret Information</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3.2.2">
                        <p id="section-toc.1-1.5.2.1.2.3.2.2.1"><a href="#section-5.1.3.2" class="auto internal xref">5.1.3.2</a>.  <a href="#name-dh-key-pairs" class="internal xref">DH Key Pairs</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3.2.3">
                        <p id="section-toc.1-1.5.2.1.2.3.2.3.1"><a href="#section-5.1.3.3" class="auto internal xref">5.1.3.3</a>.  <a href="#name-signature" class="internal xref">Signature</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3.2.4">
                        <p id="section-toc.1-1.5.2.1.2.3.2.4.1"><a href="#section-5.1.3.4" class="auto internal xref">5.1.3.4</a>.  <a href="#name-key-encapsulation" class="internal xref">Key Encapsulation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3.2.5">
                        <p id="section-toc.1-1.5.2.1.2.3.2.5.1"><a href="#section-5.1.3.5" class="auto internal xref">5.1.3.5</a>.  <a href="#name-multiple-protection" class="internal xref">Multiple Protection</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-common-data-structures" class="internal xref">Common Data Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-requested-certificate-conte" class="internal xref">Requested Certificate Contents</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-encrypted-values" class="internal xref">Encrypted Values</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-status-codes-and-failure-in" class="internal xref">Status Codes and Failure Information for PKI Messages</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-certificate-identification" class="internal xref">Certificate Identification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.5">
                    <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="auto internal xref">5.2.5</a>.  <a href="#name-out-of-band-root-ca-public-" class="internal xref">Out-of-band root CA Public Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.6">
                    <p id="section-toc.1-1.5.2.2.2.6.1"><a href="#section-5.2.6" class="auto internal xref">5.2.6</a>.  <a href="#name-archive-options" class="internal xref">Archive Options</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.7">
                    <p id="section-toc.1-1.5.2.2.2.7.1"><a href="#section-5.2.7" class="auto internal xref">5.2.7</a>.  <a href="#name-publication-information" class="internal xref">Publication Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.8">
                    <p id="section-toc.1-1.5.2.2.2.8.1"><a href="#section-5.2.8" class="auto internal xref">5.2.8</a>.  <a href="#name-proof-of-possession-structu" class="internal xref">Proof-of-Possession Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.8.2.1">
                        <p id="section-toc.1-1.5.2.2.2.8.2.1.1"><a href="#section-5.2.8.1" class="auto internal xref">5.2.8.1</a>.  <a href="#name-raverified" class="internal xref">raVerified</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.8.2.2">
                        <p id="section-toc.1-1.5.2.2.2.8.2.2.1"><a href="#section-5.2.8.2" class="auto internal xref">5.2.8.2</a>.  <a href="#name-poposigningkey-structure" class="internal xref">POPOSigningKey Structure</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.8.2.3">
                        <p id="section-toc.1-1.5.2.2.2.8.2.3.1"><a href="#section-5.2.8.3" class="auto internal xref">5.2.8.3</a>.  <a href="#name-popoprivkey-structure" class="internal xref">POPOPrivKey Structure</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.8.2.4">
                        <p id="section-toc.1-1.5.2.2.2.8.2.4.1"><a href="#section-5.2.8.4" class="auto internal xref">5.2.8.4</a>.  <a href="#name-summary-of-pop-options" class="internal xref">Summary of PoP Options</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.9">
                    <p id="section-toc.1-1.5.2.2.2.9.1"><a href="#section-5.2.9" class="auto internal xref">5.2.9</a>.  <a href="#name-generalizedtime" class="internal xref">GeneralizedTime</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-operation-specific-data-str" class="internal xref">Operation-Specific Data Structures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-initialization-request" class="internal xref">Initialization Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-initialization-response" class="internal xref">Initialization Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="auto internal xref">5.3.3</a>.  <a href="#name-certification-request" class="internal xref">Certification Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a href="#section-5.3.4" class="auto internal xref">5.3.4</a>.  <a href="#name-certification-response" class="internal xref">Certification Response</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5">
                    <p id="section-toc.1-1.5.2.3.2.5.1"><a href="#section-5.3.5" class="auto internal xref">5.3.5</a>.  <a href="#name-key-update-request-content" class="internal xref">Key Update Request Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.6">
                    <p id="section-toc.1-1.5.2.3.2.6.1"><a href="#section-5.3.6" class="auto internal xref">5.3.6</a>.  <a href="#name-key-update-response-content" class="internal xref">Key Update Response Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.7">
                    <p id="section-toc.1-1.5.2.3.2.7.1"><a href="#section-5.3.7" class="auto internal xref">5.3.7</a>.  <a href="#name-key-recovery-request-conten" class="internal xref">Key Recovery Request Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.8">
                    <p id="section-toc.1-1.5.2.3.2.8.1"><a href="#section-5.3.8" class="auto internal xref">5.3.8</a>.  <a href="#name-key-recovery-response-conte" class="internal xref">Key Recovery Response Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.9">
                    <p id="section-toc.1-1.5.2.3.2.9.1"><a href="#section-5.3.9" class="auto internal xref">5.3.9</a>.  <a href="#name-revocation-request-content" class="internal xref">Revocation Request Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.10">
                    <p id="section-toc.1-1.5.2.3.2.10.1"><a href="#section-5.3.10" class="auto internal xref">5.3.10</a>. <a href="#name-revocation-response-content" class="internal xref">Revocation Response Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.11">
                    <p id="section-toc.1-1.5.2.3.2.11.1"><a href="#section-5.3.11" class="auto internal xref">5.3.11</a>. <a href="#name-cross-certification-request" class="internal xref">Cross Certification Request Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.12">
                    <p id="section-toc.1-1.5.2.3.2.12.1"><a href="#section-5.3.12" class="auto internal xref">5.3.12</a>. <a href="#name-cross-certification-respons" class="internal xref">Cross Certification Response Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.13">
                    <p id="section-toc.1-1.5.2.3.2.13.1"><a href="#section-5.3.13" class="auto internal xref">5.3.13</a>. <a href="#name-ca-key-update-announcement-" class="internal xref">CA Key Update Announcement Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.14">
                    <p id="section-toc.1-1.5.2.3.2.14.1"><a href="#section-5.3.14" class="auto internal xref">5.3.14</a>. <a href="#name-certificate-announcement" class="internal xref">Certificate Announcement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.15">
                    <p id="section-toc.1-1.5.2.3.2.15.1"><a href="#section-5.3.15" class="auto internal xref">5.3.15</a>. <a href="#name-revocation-announcement" class="internal xref">Revocation Announcement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.16">
                    <p id="section-toc.1-1.5.2.3.2.16.1"><a href="#section-5.3.16" class="auto internal xref">5.3.16</a>. <a href="#name-crl-announcement" class="internal xref">CRL Announcement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.17">
                    <p id="section-toc.1-1.5.2.3.2.17.1"><a href="#section-5.3.17" class="auto internal xref">5.3.17</a>. <a href="#name-pki-confirmation-content" class="internal xref">PKI Confirmation Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.18">
                    <p id="section-toc.1-1.5.2.3.2.18.1"><a href="#section-5.3.18" class="auto internal xref">5.3.18</a>. <a href="#name-certificate-confirmation-co" class="internal xref">Certificate Confirmation Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19">
                    <p id="section-toc.1-1.5.2.3.2.19.1"><a href="#section-5.3.19" class="auto internal xref">5.3.19</a>. <a href="#name-pki-general-message-content" class="internal xref">PKI General Message Content</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.1">
                        <p id="section-toc.1-1.5.2.3.2.19.2.1.1"><a href="#section-5.3.19.1" class="auto internal xref">5.3.19.1</a>.  <a href="#name-ca-protocol-encryption-cert" class="internal xref">CA Protocol Encryption Certificate</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.2">
                        <p id="section-toc.1-1.5.2.3.2.19.2.2.1"><a href="#section-5.3.19.2" class="auto internal xref">5.3.19.2</a>.  <a href="#name-signing-key-pair-types" class="internal xref">Signing Key Pair Types</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.3">
                        <p id="section-toc.1-1.5.2.3.2.19.2.3.1"><a href="#section-5.3.19.3" class="auto internal xref">5.3.19.3</a>.  <a href="#name-encryption-key-agreement-ke" class="internal xref">Encryption/Key Agreement Key Pair Types</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.4">
                        <p id="section-toc.1-1.5.2.3.2.19.2.4.1"><a href="#section-5.3.19.4" class="auto internal xref">5.3.19.4</a>.  <a href="#name-preferred-symmetric-algorit" class="internal xref">Preferred Symmetric Algorithm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.5">
                        <p id="section-toc.1-1.5.2.3.2.19.2.5.1"><a href="#section-5.3.19.5" class="auto internal xref">5.3.19.5</a>.  <a href="#name-updated-ca-key-pair" class="internal xref">Updated CA Key Pair</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.6">
                        <p id="section-toc.1-1.5.2.3.2.19.2.6.1"><a href="#section-5.3.19.6" class="auto internal xref">5.3.19.6</a>.  <a href="#name-crl" class="internal xref">CRL</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.7">
                        <p id="section-toc.1-1.5.2.3.2.19.2.7.1"><a href="#section-5.3.19.7" class="auto internal xref">5.3.19.7</a>.  <a href="#name-unsupported-object-identifi" class="internal xref">Unsupported Object Identifiers</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.8">
                        <p id="section-toc.1-1.5.2.3.2.19.2.8.1"><a href="#section-5.3.19.8" class="auto internal xref">5.3.19.8</a>.  <a href="#name-key-pair-parameters" class="internal xref">Key Pair Parameters</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.9">
                        <p id="section-toc.1-1.5.2.3.2.19.2.9.1"><a href="#section-5.3.19.9" class="auto internal xref">5.3.19.9</a>.  <a href="#name-revocation-passphrase" class="internal xref">Revocation Passphrase</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.10">
                        <p id="section-toc.1-1.5.2.3.2.19.2.10.1"><a href="#section-5.3.19.10" class="auto internal xref">5.3.19.10</a>. <a href="#name-implicitconfirm-2" class="internal xref">ImplicitConfirm</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.11">
                        <p id="section-toc.1-1.5.2.3.2.19.2.11.1"><a href="#section-5.3.19.11" class="auto internal xref">5.3.19.11</a>. <a href="#name-confirmwaittime-2" class="internal xref">ConfirmWaitTime</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.12">
                        <p id="section-toc.1-1.5.2.3.2.19.2.12.1"><a href="#section-5.3.19.12" class="auto internal xref">5.3.19.12</a>. <a href="#name-original-pkimessage" class="internal xref">Original PKIMessage</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.13">
                        <p id="section-toc.1-1.5.2.3.2.19.2.13.1"><a href="#section-5.3.19.13" class="auto internal xref">5.3.19.13</a>. <a href="#name-supported-language-tags" class="internal xref">Supported Language Tags</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.14">
                        <p id="section-toc.1-1.5.2.3.2.19.2.14.1"><a href="#section-5.3.19.14" class="auto internal xref">5.3.19.14</a>. <a href="#name-ca-certificates" class="internal xref">CA Certificates</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.15">
                        <p id="section-toc.1-1.5.2.3.2.19.2.15.1"><a href="#section-5.3.19.15" class="auto internal xref">5.3.19.15</a>. <a href="#name-root-ca-update" class="internal xref">Root CA Update</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.16">
                        <p id="section-toc.1-1.5.2.3.2.19.2.16.1"><a href="#section-5.3.19.16" class="auto internal xref">5.3.19.16</a>. <a href="#name-certificate-request-templat" class="internal xref">Certificate Request Template</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.17">
                        <p id="section-toc.1-1.5.2.3.2.19.2.17.1"><a href="#section-5.3.19.17" class="auto internal xref">5.3.19.17</a>. <a href="#name-crl-update-retrieval" class="internal xref">CRL Update Retrieval</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.19.2.18">
                        <p id="section-toc.1-1.5.2.3.2.19.2.18.1"><a href="#section-5.3.19.18" class="auto internal xref">5.3.19.18</a>. <a href="#name-kem-ciphertext" class="internal xref">KEM Ciphertext</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.20">
                    <p id="section-toc.1-1.5.2.3.2.20.1"><a href="#section-5.3.20" class="auto internal xref">5.3.20</a>. <a href="#name-pki-general-response-conten" class="internal xref">PKI General Response Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.21">
                    <p id="section-toc.1-1.5.2.3.2.21.1"><a href="#section-5.3.21" class="auto internal xref">5.3.21</a>. <a href="#name-error-message-content" class="internal xref">Error Message Content</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.22">
                    <p id="section-toc.1-1.5.2.3.2.22.1"><a href="#section-5.3.22" class="auto internal xref">5.3.22</a>. <a href="#name-polling-request-and-respons" class="internal xref">Polling Request and Response</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-mandatory-pki-management-fu" class="internal xref">Mandatory PKI Management Functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-root-ca-initialization" class="internal xref">Root CA Initialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-root-ca-key-update-2" class="internal xref">Root CA Key Update</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-subordinate-ca-initializati" class="internal xref">Subordinate CA Initialization</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-crl-production" class="internal xref">CRL production</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-pki-information-request" class="internal xref">PKI Information Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-cross-certification" class="internal xref">Cross Certification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6.2.1">
                    <p id="section-toc.1-1.6.2.6.2.1.1"><a href="#section-6.6.1" class="auto internal xref">6.6.1</a>.  <a href="#name-one-way-request-response-sc" class="internal xref">One-Way Request-Response Scheme:</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-end-entity-initialization-2" class="internal xref">End Entity Initialization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1">
                    <p id="section-toc.1-1.6.2.7.2.1.1"><a href="#section-6.7.1" class="auto internal xref">6.7.1</a>.  <a href="#name-acquisition-of-pki-informat" class="internal xref">Acquisition of PKI Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.2">
                    <p id="section-toc.1-1.6.2.7.2.2.1"><a href="#section-6.7.2" class="auto internal xref">6.7.2</a>.  <a href="#name-out-of-band-verification-of" class="internal xref">Out-of-Band Verification of Root-CA Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-certificate-request" class="internal xref">Certificate Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-key-update" class="internal xref">Key Update</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-version-negotiation" class="internal xref">Version Negotiation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-supporting-rfc-2510-impleme" class="internal xref">Supporting RFC 2510 Implementations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-clients-talking-to-rfc-2510" class="internal xref">Clients Talking to RFC 2510 Servers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-servers-receiving-version-c" class="internal xref">Servers Receiving Version cmp1999 PKIMessages</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-on-the-necessity-of-proof-o" class="internal xref">On the Necessity of Proof-Of-Possession</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-proof-of-possession-with-a-" class="internal xref">Proof-Of-Possession with a Decryption Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-proof-of-possession-by-expo" class="internal xref">Proof-Of-Possession by Exposing the Private Key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-attack-against-diffie-hellm" class="internal xref">Attack Against Diffie-Hellman Key Exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-perfect-forward-secrecy" class="internal xref">Perfect Forward Secrecy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-private-keys-for-certificat" class="internal xref">Private Keys for Certificate Signing and CMP Message Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-entropy-of-random-numbers-k" class="internal xref">Entropy of Random Numbers, Key Pairs, and Shared Secret Information</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="auto internal xref">8.8</a>.  <a href="#name-recurring-usage-of-kem-keys" class="internal xref">Recurring Usage of KEM Keys for Message Protection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.9">
                <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="auto internal xref">8.9</a>.  <a href="#name-trust-anchor-provisioning-u" class="internal xref">Trust Anchor Provisioning Using CMP Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.10">
                <p id="section-toc.1-1.8.2.10.1"><a href="#section-8.10" class="auto internal xref">8.10</a>. <a href="#name-authorizing-requests-for-ce" class="internal xref">Authorizing Requests for Certificates with Specific EKUs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.11">
                <p id="section-toc.1-1.8.2.11.1"><a href="#section-8.11" class="auto internal xref">8.11</a>. <a href="#name-usage-of-certificate-transp" class="internal xref">Usage of Certificate Transparency Logs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-reasons-for-the-presence-of" class="internal xref">Reasons for the Presence of RAs</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-the-use-of-revocation-passp" class="internal xref">The Use of Revocation Passphrase</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-pki-management-message-prof" class="internal xref">PKI Management Message Profiles (REQUIRED)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-general-rules-for-interpret" class="internal xref">General Rules for Interpretation of These Profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-algorithm-use-profile" class="internal xref">Algorithm Use Profile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-proof-of-possession-profile" class="internal xref">Proof-of-Possession Profile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-initial-registration-certific" class="internal xref">Initial Registration/Certification (Basic Authenticated Scheme)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-certificate-request-2" class="internal xref">Certificate Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#appendix-C.6" class="auto internal xref">C.6</a>.  <a href="#name-key-update-request" class="internal xref">Key Update Request</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-pki-management-message-profi" class="internal xref">PKI Management Message Profiles (OPTIONAL)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-general-rules-for-interpreta" class="internal xref">General Rules for Interpretation of These Profiles.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-algorithm-use-profile-2" class="internal xref">Algorithm Use Profile</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#appendix-D.3" class="auto internal xref">D.3</a>.  <a href="#name-self-signed-certificates" class="internal xref">Self-Signed Certificates</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.4">
                <p id="section-toc.1-1.15.2.4.1"><a href="#appendix-D.4" class="auto internal xref">D.4</a>.  <a href="#name-root-ca-key-update-3" class="internal xref">Root CA Key Update</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.5">
                <p id="section-toc.1-1.15.2.5.1"><a href="#appendix-D.5" class="auto internal xref">D.5</a>.  <a href="#name-pki-information-request-res" class="internal xref">PKI Information Request/Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.6">
                <p id="section-toc.1-1.15.2.6.1"><a href="#appendix-D.6" class="auto internal xref">D.6</a>.  <a href="#name-cross-certification-request-" class="internal xref">Cross Certification Request/Response (1-way)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.7">
                <p id="section-toc.1-1.15.2.7.1"><a href="#appendix-D.7" class="auto internal xref">D.7</a>.  <a href="#name-in-band-initialization-usin" class="internal xref">In-Band Initialization Using External Identity Certificate</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-variants-of-using-kem-keys-" class="internal xref">Variants of Using KEM Keys for PKI Message Protection</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-F" class="auto internal xref">Appendix F</a>.  <a href="#name-compilable-asn1-definitions" class="internal xref">Compilable ASN.1 Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-G" class="auto internal xref">Appendix G</a>.  <a href="#name-history-of-changes" class="internal xref">History of Changes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-H" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">[RFC Editor: please delete:<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">During IESG telechat the CMP Updates document was approved on condition that
LAMPS provides a RFC4210bis document.  Version -00 of this document shall
be identical to RFC 4210 and version -01 incorporates the changes specified
in CMP Updates Section 2 and Appendix A.2.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">A history of changes is available in <a href="#sect-g" class="auto internal xref">Appendix G</a> of this document.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The authors of this document wish to thank Carlisle Adams, Stephen Farrell,
Tomi Kause, and Tero Mononen, the original authors of RFC4210, for their
work and invite them, next to further volunteers, to join the -bis activity
as co-authors.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">]<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">[RFC Editor:<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Please perform the following substitution.<a href="#section-1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-8.1">
          <p id="section-1-8.1.1">RFCXXXX --&gt; the assigned numerical RFC value for this draft
]<a href="#section-1-8.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-9">This document describes the Internet X.509 Public Key Infrastructure
(PKI) Certificate Management Protocol (CMP).  Protocol messages are
defined for certificate creation and management.  The term
"certificate" in this document refers to an X.509v3 Certificate as
defined in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-1-9" class="pilcrow">¶</a></p>
<div id="sect-1.1">
<section id="section-1.1">
        <h3 id="name-changes-made-by-rfc-4210">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-changes-made-by-rfc-4210" class="section-name selfRef">Changes Made by RFC 4210</a>
        </h3>
<p id="section-1.1-1"><span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span> differs from <span>[<a href="#RFC2510" class="cite xref">RFC2510</a>]</span> in the following areas:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">
            <p id="section-1.1-2.1.1">The PKI management message profile section is split to two
appendices: the required profile and the optional profile.  Some
of the formerly mandatory functionality is moved to the optional
profile.<a href="#section-1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.2">
            <p id="section-1.1-2.2.1">The message confirmation mechanism has changed substantially.<a href="#section-1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.3">
            <p id="section-1.1-2.3.1">A new polling mechanism is introduced, deprecating the old polling
method at the CMP transport level.<a href="#section-1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.4">
            <p id="section-1.1-2.4.1">The CMP transport protocol issues are handled in a separate
document <span>[<a href="#RFC6712" class="cite xref">RFC6712</a>]</span>, thus the Transports section is removed.<a href="#section-1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.5">
            <p id="section-1.1-2.5.1">A new implicit confirmation method is introduced to reduce the
number of protocol messages exchanged in a transaction.<a href="#section-1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.1-2.6">
            <p id="section-1.1-2.6.1">The new specification contains some less prominent protocol
enhancements and improved explanatory text on several issues.<a href="#section-1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-1.2">
<section id="section-1.2">
        <h3 id="name-updates-made-by-rfc-9480">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-updates-made-by-rfc-9480" class="section-name selfRef">Updates Made by RFC 9480</a>
        </h3>
<p id="section-1.2-1">CMP Updates <span>[<a href="#RFC9480" class="cite xref">RFC9480</a>]</span> and CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span> updated <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span>, supporting the PKI management operations specified in the Lightweight CMP
Profile <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span>, in the following areas:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">
            <p id="section-1.2-2.1.1">Added new extended key usages for various CMP server types, e.g., registration
authority and certification authority, to express the authorization of the
certificate holder that acts as the indicated type of PKI management entity.<a href="#section-1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">Extended the description of multiple protection to cover additional use cases,
e.g., batch processing of messages.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.3">
            <p id="section-1.2-2.3.1">Use the Cryptographic Message Syntax (CMS) <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> type EnvelopedData as the preferred choice instead of
EncryptedValue to better support crypto agility in CMP.<a href="#section-1.2-2.3.1" class="pilcrow">¶</a></p>
<p id="section-1.2-2.3.2">
For reasons of completeness and consistency, the type EncryptedValue has been
exchanged in all occurrences.  This includes the protection of centrally
generated private keys, encryption of certificates, proof-of-possession methods, and protection of revocation
passphrases. To properly differentiate the support of EnvelopedData instead
of EncryptedValue, CMP version 3 is introduced in case a transaction
is supposed to use EnvelopedData.<a href="#section-1.2-2.3.2" class="pilcrow">¶</a></p>
<p id="section-1.2-2.3.3">
Note: According to <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>, Section 2.1, point 9, the use of the EncryptedValue structure has been deprecated
in favor of the EnvelopedData structure. <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> offers the EncryptedKey structure a choice of EncryptedValue and EnvelopedData
for migration to EnvelopedData.<a href="#section-1.2-2.3.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.4">
            <p id="section-1.2-2.4.1">Offer an optional hashAlg field in CertStatus supporting cases that a certificate
needs to be confirmed that has a signature algorithm that does not indicate
a specific hash algorithm to use for computing the certHash.  This is also in
preparation for upcoming post-quantum algorithms.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.5">
            <p id="section-1.2-2.5.1">Added new general message types to request CA certificates, a root CA update,
a certificate request template, or Certificate Revocation List (CRL) updates.<a href="#section-1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.6">
            <p id="section-1.2-2.6.1">Extended the use of polling to p10cr, certConf, rr, genm, and error messages.<a href="#section-1.2-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.7">
            <p id="section-1.2-2.7.1">Deleted the mandatory algorithm profile in <a href="#sect-c.2" class="auto internal xref">Appendix C.2</a> and refer instead to Section 7 of <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>.<a href="#section-1.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.2-2.8">
            <p id="section-1.2-2.8.1">Added security considerations Sections <a href="#sect-8.6" class="auto internal xref">8.6</a>, <a href="#sect-8.7" class="auto internal xref">8.7</a>, <a href="#sect-8.9" class="auto internal xref">8.9</a>, and <a href="#sect-8.10" class="auto internal xref">8.10</a>.<a href="#section-1.2-2.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-1.3">
<section id="section-1.3">
        <h3 id="name-changes-made-by-this-docume">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-changes-made-by-this-docume" class="section-name selfRef">Changes Made by This Document</a>
        </h3>
<p id="section-1.3-1">This document obsoletes <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span> and <span>[<a href="#RFC9480" class="cite xref">RFC9480</a>]</span>. It includes the changes specified by Section 2 and Appendix C.2 of <span>[<a href="#RFC9480" class="cite xref">RFC9480</a>]</span> as described in <a href="#sect-1.2" class="auto internal xref">Section 1.2</a>. Additionally this document updates the content of <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span> in the following areas:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">
            <p id="section-1.3-2.1.1">Added <a href="#sect-3.1.1.4" class="auto internal xref">Section 3.1.1.4</a> introducing the Key Generation Authority.<a href="#section-1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.2">
            <p id="section-1.3-2.2.1">Extended <a href="#sect-3.1.2" class="auto internal xref">Section 3.1.2</a> regarding use of Certificate Transparency logs.<a href="#section-1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.3">
            <p id="section-1.3-2.3.1">Updated <a href="#sect-4.4" class="auto internal xref">Section 4.4</a> introducing RootCaKeyUpdateContent as alternative to using a repository to acquire new root CA certificates.<a href="#section-1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.4">
            <p id="section-1.3-2.4.1">Added <a href="#sect-5.1.1.3" class="auto internal xref">Section 5.1.1.3</a> containing description of origPKIMessage content moved here from <a href="#sect-5.1.3.4" class="auto internal xref">Section 5.1.3.4</a>.<a href="#section-1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.5">
            <p id="section-1.3-2.5.1">Added support for KEM keys for proof-of-possession to <a href="#sect-4.3" class="auto internal xref">Section 4.3</a> and <a href="#sect-5.2.8" class="auto internal xref">Section 5.2.8</a>, for message protection to <a href="#sect-5.1.1" class="auto internal xref">Section 5.1.1</a>, <a href="#sect-5.1.3.4" class="auto internal xref">Section 5.1.3.4</a>, and <a href="#sect-e" class="auto internal xref">Appendix E</a>, and for usage with CMS EnvelopedData to <a href="#sect-5.2.2" class="auto internal xref">Section 5.2.2</a>.<a href="#section-1.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.6">
            <p id="section-1.3-2.6.1">Deprecated CAKeyUpdAnnContent in favor of RootCaKeyUpdateContent.<a href="#section-1.3-2.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.7">
            <p id="section-1.3-2.7.1">Incorporated the request message behavioral clarifications from Appendix
C of <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span> to <a href="#sect-5" class="auto internal xref">Section 5</a>. The definition of altCertTemplate was incorporated into <a href="#sect-5.2.1" class="auto internal xref">Section 5.2.1</a> and the clarification on POPOSigningKey and on POPOPrivKey was incorporated into <a href="#sect-5.2.8" class="auto internal xref">Section 5.2.8</a>.<a href="#section-1.3-2.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.8">
            <p id="section-1.3-2.8.1">Added support for CMS EnvelopedData to different proof-of-possession methods for transferring encrypted private keys, certificates, and challenges to <a href="#sect-5.2.8" class="auto internal xref">Section 5.2.8</a>.<a href="#section-1.3-2.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.9">
            <p id="section-1.3-2.9.1">Added security considerations Sections <a href="#sect-8.1" class="auto internal xref">8.1</a>, <a href="#sect-8.5" class="auto internal xref">8.5</a>, <a href="#sect-8.8" class="auto internal xref">8.8</a>, and <a href="#sect-8.11" class="auto internal xref">8.11</a>.<a href="#section-1.3-2.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sect-2">
<section id="section-2">
      <h2 id="name-terminology-and-abbreviatio">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology-and-abbreviatio" class="section-name selfRef">Terminology and Abbreviations</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document relies on the terminology defined in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
The most important abbreviations are listed below:<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-3.1">
          <p id="section-2-3.1.1">CA: Certification Authority<a href="#section-2-3.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-4.1">
          <p id="section-2-4.1.1">CMP: Certificate Management Protocol<a href="#section-2-4.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-5.1">
          <p id="section-2-5.1.1">CMS: Cryptographic Message Syntax<a href="#section-2-5.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-6.1">
          <p id="section-2-6.1.1">CRL: Certificate Revocation List<a href="#section-2-6.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-7.1">
          <p id="section-2-7.1.1">CRMF: Certificate Request Message Format<a href="#section-2-7.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-8.1">
          <p id="section-2-8.1.1">EE: End Entity<a href="#section-2-8.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-9.1">
          <p id="section-2-9.1.1">KEM: Key Encapsulation Mechanism<a href="#section-2-9.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-10.1">
          <p id="section-2-10.1.1">KGA: Key Generation Authority<a href="#section-2-10.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-11.1">
          <p id="section-2-11.1.1">LRA: Local Registration Authority<a href="#section-2-11.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-12.1">
          <p id="section-2-12.1.1">MAC: Message Authentication Code<a href="#section-2-12.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-13.1">
          <p id="section-2-13.1.1">PKI: Public Key Infrastructure<a href="#section-2-13.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-14.1">
          <p id="section-2-14.1.1">POP: Proof Of Possession<a href="#section-2-14.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-15.1">
          <p id="section-2-15.1.1">RA: Registration Authority<a href="#section-2-15.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-16.1">
          <p id="section-2-16.1.1">TEE: Trusted Execution Environment<a href="#section-2-16.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="sect-3">
<section id="section-3">
      <h2 id="name-pki-management-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-pki-management-overview" class="section-name selfRef">PKI Management Overview</a>
      </h2>
<p id="section-3-1">The PKI must be structured to be consistent with the types of
individuals who must administer it.  Providing such administrators
with unbounded choices not only complicates the software required,
but also increases the chances that a subtle mistake by an
administrator or software developer will result in broader
compromise.  Similarly, restricting administrators with cumbersome
mechanisms will cause them not to use the PKI.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Management protocols are <span class="bcp14">REQUIRED</span> to support on-line interactions
between Public Key Infrastructure (PKI) components.  For example, a
management protocol might be used between a Certification Authority
(CA) and a client system with which a key pair is associated, or
between two CAs that issue cross-certificates for each other.<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="sect-3.1">
<section id="section-3.1">
        <h3 id="name-pki-management-model">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-pki-management-model" class="section-name selfRef">PKI Management Model</a>
        </h3>
<p id="section-3.1-1">Before specifying particular message formats and procedures, we first
define the entities involved in PKI management and their interactions
(in terms of the PKI management functions required).  We then group
these functions in order to accommodate different identifiable types
of end entities.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="sect-3.1.1">
<section id="section-3.1.1">
          <h4 id="name-definitions-of-pki-entities">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-definitions-of-pki-entities" class="section-name selfRef">Definitions of PKI Entities</a>
          </h4>
<p id="section-3.1.1-1">The entities involved in PKI management include the end entity (i.e.,
the entity to whom the certificate is issued) and the certification
authority (i.e., the entity that issues the certificate).  A
registration authority might also be involved in PKI management.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<div id="sect-3.1.1.1">
<section id="section-3.1.1.1">
            <h5 id="name-subjects-and-end-entities">
<a href="#section-3.1.1.1" class="section-number selfRef">3.1.1.1. </a><a href="#name-subjects-and-end-entities" class="section-name selfRef">Subjects and End Entities</a>
            </h5>
<p id="section-3.1.1.1-1">The term "subject" is used here to refer to the entity to whom the
certificate is issued, typically named in the subject or
subjectAltName field of a certificate.  When we wish to distinguish
the tools and/or software used by the subject (e.g., a local
certificate management module), we will use the term "subject equipment".
In general, the term "end entity" (EE), rather than
"subject", is preferred in order to avoid confusion with the field
name.  It is important to note that the end entities here will
include not only human users of applications, but also applications
themselves (e.g., for IKE/IPSEC) or devices (e.g., routers or industrial
control systems).  This factor influences the
protocols that the PKI management operations use; for example,
application software is far more likely to know exactly which
certificate extensions are required than are human users.  PKI
management entities are also end entities in the sense that they are
sometimes named in the subject or subjectAltName field of a
certificate or cross-certificate.  Where appropriate, the term "end entity"
will be used to refer to end entities who are not PKI
management entities.<a href="#section-3.1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1.1-2">All end entities require secure local access to some information --
at a minimum, their own name and private key, the name of a CA that
is directly trusted by this entity, and that CA's public key (or a
fingerprint of the public key where a self-certified version is
available elsewhere).  Implementations <span class="bcp14">MAY</span> use secure local storage
for more than this minimum (e.g., the end entity's own certificates or
application-specific information).  The form of storage will also
vary -- from files to tamper-resistant cryptographic tokens.  The
information stored in such local, trusted storage is referred to here
as the end entity's Trusted Execution Environment (TEE) also known as
Personal Security Environment (PSE).<a href="#section-3.1.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1.1-3">Though TEE formats are beyond the scope of this document (they are
very dependent on equipment, et cetera), a generic interchange format
for TEEs is defined here: a certification response message, see <a href="#sect-5.3.4" class="auto internal xref">Section 5.3.4</a>, <span class="bcp14">MAY</span> be
used.<a href="#section-3.1.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.1.1.2">
<section id="section-3.1.1.2">
            <h5 id="name-certification-authority">
<a href="#section-3.1.1.2" class="section-number selfRef">3.1.1.2. </a><a href="#name-certification-authority" class="section-name selfRef">Certification Authority</a>
            </h5>
<p id="section-3.1.1.2-1">The certification authority (CA) may or may not actually be a real
"third party" from the end entity's point of view.  Quite often, the
CA will actually belong to the same organization as the end entities
it supports.<a href="#section-3.1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1.2-2">Again, we use the term "CA" to refer to the entity named in the
issuer field of a certificate.  When it is necessary to distinguish
the software or hardware tools used by the CA, we use the term "CA equipment".<a href="#section-3.1.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1.2-3">The CA equipment will often include both an "off-line" component and
an "on-line" component, with the CA private key only available to the
"off-line" component.  This is, however, a matter for implementers
(though it is also relevant as a policy issue).<a href="#section-3.1.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1.2-4">We use the term "root CA" to indicate a CA that is directly trusted
by an end entity; that is, securely acquiring the value of a root CA
public key requires some out-of-band step(s). This term is not meant
to imply that a root CA is necessarily at the top of any hierarchy,
simply that the CA in question is trusted directly.<a href="#section-3.1.1.2-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1.2-5">A "subordinate CA" is one that is not a root CA for the end entity in
question.  Often, a subordinate CA will not be a root CA for any
entity, but this is not mandatory.<a href="#section-3.1.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.1.1.3">
<section id="section-3.1.1.3">
            <h5 id="name-registration-authority">
<a href="#section-3.1.1.3" class="section-number selfRef">3.1.1.3. </a><a href="#name-registration-authority" class="section-name selfRef">Registration Authority</a>
            </h5>
<p id="section-3.1.1.3-1">In addition to end-entities and CAs, many environments call for the
existence of a Registration Authority (RA) separate from the
Certification Authority.  The functions that the registration
authority may carry out will vary from case to case but <span class="bcp14">MAY</span> include
identity checking, token distribution, checking certificate requests
and authentication of their origin, revocation reporting,
name assignment, archival of key pairs, et cetera.<a href="#section-3.1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1.3-2">This document views the RA as an <span class="bcp14">OPTIONAL</span> component: when it is not
present, the CA is assumed to be able to carry out the RA's functions
so that the PKI management protocols are the same from the end-entity's
point of view.<a href="#section-3.1.1.3-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1.3-3">Again, we distinguish, where necessary, between the RA and the tools
used (the "RA equipment").<a href="#section-3.1.1.3-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1.3-4">Note that an RA is itself an end entity.  We further assume that all
RAs are in fact certified end entities and that RAs have private keys
that are usable for signing.  How a particular CA equipment
identifies some end entities as RAs is an implementation issue (i.e.,
this document specifies no special RA certification operation).  We
do not mandate that the RA is certified by the CA with which it is
interacting at the moment (so one RA may work with more than one CA
whilst only being certified once).<a href="#section-3.1.1.3-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1.3-5">In some circumstances, end entities will communicate directly with a
CA even where an RA is present.  For example, for initial
registration and/or certification, the end entity may use its RA, but
communicate directly with the CA in order to refresh its certificate.<a href="#section-3.1.1.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-3.1.1.4">
<section id="section-3.1.1.4">
            <h5 id="name-key-generation-authority">
<a href="#section-3.1.1.4" class="section-number selfRef">3.1.1.4. </a><a href="#name-key-generation-authority" class="section-name selfRef">Key Generation Authority</a>
            </h5>
<p id="section-3.1.1.4-1">A Key Generation Authority (KGA) is a PKI management entity generating key
pairs on behalf of an end entity. As the KGA generates the key pair it
knows the public and the private part.<a href="#section-3.1.1.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1.4-2">This document views the KGA as an <span class="bcp14">OPTIONAL</span> component. When it is not present
and central key generation is needed, the CA is assumed to be able to carry
out the KGA's functions so that the PKI management protocol messages are the
same from the end-entity's point of view. If certain tasks of a CA are
delegated to other components, this delegation needs authorization, which can
be indicated by extended key usages (see <a href="#sect-4.5" class="auto internal xref">Section 4.5</a>).<a href="#section-3.1.1.4-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1.4-3">Note: When doing central generation of key pairs, implementers should consider
the implications of server-side retention on the overall security of the
system; in some case retention is good, for example for escrow reasons, but
in other cases the server should clear its copy after delivery to the end
entity.<a href="#section-3.1.1.4-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1.4-4">Note: If the CA delegates key generation to a KGA, the KGA can be collocated
with the RA.<a href="#section-3.1.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-3.1.2">
<section id="section-3.1.2">
          <h4 id="name-pki-management-requirements">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-pki-management-requirements" class="section-name selfRef">PKI Management Requirements</a>
          </h4>
<p id="section-3.1.2-1">The protocols given here meet the following requirements on PKI
management<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.2-2">
<li id="section-3.1.2-2.1">
              <p id="section-3.1.2-2.1.1">PKI management must conform to the ISO/IEC 9594-8/ITU-T X.509
  standards.<a href="#section-3.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.2">
              <p id="section-3.1.2-2.2.1">It must be possible to regularly update any key pair without
  affecting any other key pair.<a href="#section-3.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.3">
              <p id="section-3.1.2-2.3.1">The use of confidentiality in PKI management protocols must be
  kept to a minimum in order to ease acceptance in environments
  where strong confidentiality might cause regulatory problems.<a href="#section-3.1.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.4">
              <p id="section-3.1.2-2.4.1">PKI management protocols must allow the use of different
  industry-standard cryptographic algorithms, see CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>.
  This means that any given
  CA, RA, or end entity may, in principle, use whichever
  algorithms suit it for its own key pair(s).<a href="#section-3.1.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.5">
              <p id="section-3.1.2-2.5.1">PKI management protocols must not preclude the generation of key
  pairs by the end entity concerned, by a KGA or by a CA.  Key
  generation may also occur elsewhere, but for the purposes of PKI
  management we can regard key generation as occurring wherever
  the key is first present at an end entity, KGA, or CA.<a href="#section-3.1.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.6">
              <p id="section-3.1.2-2.6.1">PKI management protocols must support the publication of
  certificates by the end entity concerned, by an RA, or by a CA.
  Different implementations and different environments may choose
  any of the above approaches.<a href="#section-3.1.2-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.7">
              <p id="section-3.1.2-2.7.1">PKI management protocols must support the production of
  Certificate Revocation Lists (CRLs) by allowing certified end
  entities to make requests for the revocation of certificates.
  This must be done in such a way that the denial-of-service
  attacks, which are possible, are not made simpler.<a href="#section-3.1.2-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.8">
              <p id="section-3.1.2-2.8.1">PKI management protocols must be usable over a variety of
  "transport" mechanisms, specifically including mail, Hypertext
  Transfer Protocol (HTTP), Message Queuing Telemetry Transport (MQTT),
  Constrained Application Protocol (CoAP), and off-line file-based.<a href="#section-3.1.2-2.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.9">
              <p id="section-3.1.2-2.9.1">Final authority for certification creation rests with the CA.
  No RA or end entity equipment can assume that any certificate
  issued by a CA will contain what was requested; a CA may alter
  certificate field values or may add, delete, or alter extensions
  according to its operating policy.  In other words, all PKI
  entities (end-entities, RAs, KGAs, and CAs) must be capable of
  handling responses to requests for certificates in which the
  actual certificate issued is different from that requested (for
  example, a CA may shorten the validity period requested).  Note
  that policy may dictate that the CA must not publish or
  otherwise distribute the certificate until the requesting entity
  has reviewed and accepted the newly-created certificate or the
  POP is completed. In case of publication of the certificate
  (when using indirect POP, see <a href="#sect-8.11" class="auto internal xref">Section 8.11</a>) or a precertificate
  in a Certificate Transparency log <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span>, the certificate
  must be revoked if it was not accepted by the EE or the POP could
  not be completed.<a href="#section-3.1.2-2.9.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.10">
              <p id="section-3.1.2-2.10.1">A graceful, scheduled change-over from one non-compromised CA
  key pair to the next (CA key update) must be supported (note
  that if the CA key is compromised, re-initialization must be
  performed for all entities in the domain of that CA).  An end
  entity whose TEE contains the new CA public key (following a CA
  key update) may also need to be able to verify certificates verifiable
  using the old public key.  End entities who directly trust the
  old CA key pair may also need to be able to verify certificates signed
  using the new CA private key (required for situations where the
  old CA public key is "hardwired" into the end entity's
  cryptographic equipment).<a href="#section-3.1.2-2.10.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.11">
              <p id="section-3.1.2-2.11.1">The functions of an RA may, in some implementations or
  environments, be carried out by the CA itself.  The protocols
  must be designed so that end entities will use the same protocol
  regardless of whether the communication is with an RA or CA.
  Naturally, the end entity must use the correct RA or CA public
  key to verify the protection of the communication.<a href="#section-3.1.2-2.11.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.2-2.12">
              <p id="section-3.1.2-2.12.1">Where an end entity requests a certificate containing a given
  public key value, the end entity must be ready to demonstrate
  possession of the corresponding private key value.  This may be
  accomplished in various ways, depending on the type of
  certification request.  See <a href="#sect-4.3" class="auto internal xref">Section 4.3</a> for details of the
  in-band methods defined for the PKIX-CMP (i.e., Certificate
  Management Protocol) messages.<a href="#section-3.1.2-2.12.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="sect-3.1.3">
<section id="section-3.1.3">
          <h4 id="name-pki-management-operations">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-pki-management-operations" class="section-name selfRef">PKI Management Operations</a>
          </h4>
<p id="section-3.1.3-1">The following diagram shows the relationship between the entities
defined above in terms of the PKI management operations.  The letters
in the diagram indicate "protocols" in the sense that a defined set
of PKI management messages can be sent along each of the lettered
lines.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<span id="name-pki-entities"></span><div id="ure-pki-entities">
<figure id="figure-1">
            <div id="section-3.1.3-2.1">
              <div class="alignLeft art-svg artwork" id="section-3.1.3-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="592" width="520" viewBox="0 0 520 592" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 8,32 L 8,448" fill="none" stroke="black"></path>
                  <path d="M 40,32 L 40,448" fill="none" stroke="black"></path>
                  <path d="M 184,272 L 184,320" fill="none" stroke="black"></path>
                  <path d="M 208,208 L 208,264" fill="none" stroke="black"></path>
                  <path d="M 224,216 L 224,264" fill="none" stroke="black"></path>
                  <path d="M 240,272 L 240,320" fill="none" stroke="black"></path>
                  <path d="M 256,32 L 256,64" fill="none" stroke="black"></path>
                  <path d="M 272,72 L 272,200" fill="none" stroke="black"></path>
                  <path d="M 272,368 L 272,400" fill="none" stroke="black"></path>
                  <path d="M 288,72 L 288,208" fill="none" stroke="black"></path>
                  <path d="M 288,304 L 288,360" fill="none" stroke="black"></path>
                  <path d="M 296,528 L 296,560" fill="none" stroke="black"></path>
                  <path d="M 304,288 L 304,360" fill="none" stroke="black"></path>
                  <path d="M 312,408 L 312,520" fill="none" stroke="black"></path>
                  <path d="M 328,408 L 328,520" fill="none" stroke="black"></path>
                  <path d="M 344,208 L 344,360" fill="none" stroke="black"></path>
                  <path d="M 352,528 L 352,560" fill="none" stroke="black"></path>
                  <path d="M 360,32 L 360,64" fill="none" stroke="black"></path>
                  <path d="M 360,216 L 360,360" fill="none" stroke="black"></path>
                  <path d="M 376,368 L 376,400" fill="none" stroke="black"></path>
                  <path d="M 8,32 L 40,32" fill="none" stroke="black"></path>
                  <path d="M 256,32 L 360,32" fill="none" stroke="black"></path>
                  <path d="M 64,48 L 232,48" fill="none" stroke="black"></path>
                  <path d="M 376,48 L 432,48" fill="none" stroke="black"></path>
                  <path d="M 256,64 L 360,64" fill="none" stroke="black"></path>
                  <path d="M 56,208 L 512,208" fill="none" stroke="black"></path>
                  <path d="M 184,272 L 240,272" fill="none" stroke="black"></path>
                  <path d="M 72,288 L 168,288" fill="none" stroke="black"></path>
                  <path d="M 256,288 L 304,288" fill="none" stroke="black"></path>
                  <path d="M 256,304 L 288,304" fill="none" stroke="black"></path>
                  <path d="M 184,320 L 240,320" fill="none" stroke="black"></path>
                  <path d="M 272,368 L 376,368" fill="none" stroke="black"></path>
                  <path d="M 72,384 L 264,384" fill="none" stroke="black"></path>
                  <path d="M 384,384 L 440,384" fill="none" stroke="black"></path>
                  <path d="M 272,400 L 376,400" fill="none" stroke="black"></path>
                  <path d="M 8,448 L 40,448" fill="none" stroke="black"></path>
                  <path d="M 296,528 L 352,528" fill="none" stroke="black"></path>
                  <path d="M 296,560 L 352,560" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="448,384 436,378.4 436,389.6" fill="black" transform="rotate(0,440,384)"></polygon>
                  <polygon class="arrowhead" points="384,48 372,42.4 372,53.6" fill="black" transform="rotate(180,376,48)"></polygon>
                  <polygon class="arrowhead" points="368,216 356,210.4 356,221.6" fill="black" transform="rotate(270,360,216)"></polygon>
                  <polygon class="arrowhead" points="352,360 340,354.4 340,365.6" fill="black" transform="rotate(90,344,360)"></polygon>
                  <polygon class="arrowhead" points="336,408 324,402.4 324,413.6" fill="black" transform="rotate(270,328,408)"></polygon>
                  <polygon class="arrowhead" points="320,520 308,514.4 308,525.6" fill="black" transform="rotate(90,312,520)"></polygon>
                  <polygon class="arrowhead" points="296,360 284,354.4 284,365.6" fill="black" transform="rotate(90,288,360)"></polygon>
                  <polygon class="arrowhead" points="296,72 284,66.4 284,77.6" fill="black" transform="rotate(270,288,72)"></polygon>
                  <polygon class="arrowhead" points="280,200 268,194.4 268,205.6" fill="black" transform="rotate(90,272,200)"></polygon>
                  <polygon class="arrowhead" points="264,288 252,282.4 252,293.6" fill="black" transform="rotate(180,256,288)"></polygon>
                  <polygon class="arrowhead" points="232,216 220,210.4 220,221.6" fill="black" transform="rotate(270,224,216)"></polygon>
                  <polygon class="arrowhead" points="216,264 204,258.4 204,269.6" fill="black" transform="rotate(90,208,264)"></polygon>
                  <polygon class="arrowhead" points="80,384 68,378.4 68,389.6" fill="black" transform="rotate(180,72,384)"></polygon>
                  <polygon class="arrowhead" points="80,288 68,282.4 68,293.6" fill="black" transform="rotate(180,72,288)"></polygon>
                  <polygon class="arrowhead" points="72,48 60,42.4 60,53.6" fill="black" transform="rotate(180,64,48)"></polygon>
                  <g class="text">
                    <text x="104" y="36">cert.</text>
                    <text x="160" y="36">publish</text>
                    <text x="416" y="36">j</text>
                    <text x="280" y="52">End</text>
                    <text x="324" y="52">Entity</text>
                    <text x="24" y="68">C</text>
                    <text x="152" y="68">g</text>
                    <text x="464" y="68">"out-of-band"</text>
                    <text x="24" y="84">e</text>
                    <text x="448" y="84">loading</text>
                    <text x="24" y="100">r</text>
                    <text x="368" y="100">initial</text>
                    <text x="24" y="116">t</text>
                    <text x="256" y="116">a</text>
                    <text x="304" y="116">b</text>
                    <text x="400" y="116">registration/</text>
                    <text x="400" y="132">certification</text>
                    <text x="24" y="148">/</text>
                    <text x="352" y="148">key</text>
                    <text x="388" y="148">pair</text>
                    <text x="444" y="148">recovery</text>
                    <text x="352" y="164">key</text>
                    <text x="388" y="164">pair</text>
                    <text x="436" y="164">update</text>
                    <text x="24" y="180">C</text>
                    <text x="384" y="180">certificate</text>
                    <text x="460" y="180">update</text>
                    <text x="24" y="196">R</text>
                    <text x="72" y="196">PKI</text>
                    <text x="120" y="196">"USERS"</text>
                    <text x="380" y="196">revocation</text>
                    <text x="456" y="196">request</text>
                    <text x="24" y="212">L</text>
                    <text x="72" y="228">PKI</text>
                    <text x="132" y="228">MANAGEMENT</text>
                    <text x="108" y="244">ENTITIES</text>
                    <text x="192" y="244">a</text>
                    <text x="240" y="244">b</text>
                    <text x="328" y="244">a</text>
                    <text x="376" y="244">b</text>
                    <text x="24" y="260">R</text>
                    <text x="24" y="276">e</text>
                    <text x="152" y="276">g</text>
                    <text x="280" y="276">d</text>
                    <text x="24" y="292">p</text>
                    <text x="204" y="292">RA</text>
                    <text x="24" y="308">o</text>
                    <text x="112" y="308">cert.</text>
                    <text x="24" y="324">s</text>
                    <text x="128" y="324">publish</text>
                    <text x="272" y="324">c</text>
                    <text x="24" y="340">i</text>
                    <text x="24" y="356">t</text>
                    <text x="24" y="372">o</text>
                    <text x="128" y="372">g</text>
                    <text x="408" y="372">i</text>
                    <text x="24" y="388">r</text>
                    <text x="324" y="388">CA</text>
                    <text x="24" y="404">y</text>
                    <text x="128" y="404">h</text>
                    <text x="448" y="404">"out-of-band"</text>
                    <text x="112" y="420">cert.</text>
                    <text x="168" y="420">publish</text>
                    <text x="448" y="420">publication</text>
                    <text x="104" y="436">CRL</text>
                    <text x="152" y="436">publish</text>
                    <text x="440" y="452">cross-certification</text>
                    <text x="296" y="468">e</text>
                    <text x="344" y="468">f</text>
                    <text x="432" y="468">cross-certificate</text>
                    <text x="412" y="484">update</text>
                    <text x="324" y="548">CA-2</text>
                  </g>
                </svg><a href="#section-3.1.3-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-pki-entities" class="selfRef">PKI Entities</a>
            </figcaption></figure>
</div>
<p id="section-3.1.3-3">At a high level, the set of operations for which management
messages are defined can be grouped as follows.<a href="#section-3.1.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.3-4">
<li id="section-3.1.3-4.1">
              <p id="section-3.1.3-4.1.1">CA establishment: When establishing a new CA, certain steps are
  required (e.g., production of initial CRLs, export of CA public
  key).<a href="#section-3.1.3-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.3-4.2">
              <p id="section-3.1.3-4.2.1">End entity initialization: This includes importing a root CA
  public key and requesting information about the options supported
  by a PKI management entity.<a href="#section-3.1.3-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.1.3-4.3">
              <p id="section-3.1.3-4.3.1">Certification: Various operations result in the creation of new
  certificates:<a href="#section-3.1.3-4.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.3-4.3.2">
<li id="section-3.1.3-4.3.2.1">
                  <p id="section-3.1.3-4.3.2.1.1">initial registration/certification: This is the process
   whereby an end entity first makes itself known to a CA or RA,
   prior to the CA issuing a certificate or certificates for
   that end entity.  The end result of this process (when it is
   successful) is that a CA issues a certificate for an end
   entity's public key, and returns that certificate to the end
   entity and/or posts that certificate in a repository.
   This process may, and typically will, involve multiple
   "steps", possibly including an initialization of the end
   entity's equipment.  For example, the end entity's equipment
   must be securely initialized with the public key of a CA, e.g.,
   using zero-touch methods like Bootstrapping Remote Secure Key
   Infrastructure (BRSKI) <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> or Secure Zero Touch
   Provisioning (SZTP) <span>[<a href="#RFC8572" class="cite xref">RFC8572</a>]</span>, to
   be used in validating certificate paths.  Furthermore, an end
   entity typically needs to be initialized with its own key
   pair(s).<a href="#section-3.1.3-4.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.3-4.3.2.2">
                  <p id="section-3.1.3-4.3.2.2.1">key pair update: Every key pair needs to be updated regularly
   (i.e., replaced with a new key pair), and a new certificate
   needs to be issued.<a href="#section-3.1.3-4.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.3-4.3.2.3">
                  <p id="section-3.1.3-4.3.2.3.1">certificate update: As certificates expire, they may be
   "refreshed" if nothing relevant in the environment has
   changed.<a href="#section-3.1.3-4.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.3-4.3.2.4">
                  <p id="section-3.1.3-4.3.2.4.1">CA key pair update: As with end entities, CA key pairs need
   to be updated regularly; however, different mechanisms are
   required.<a href="#section-3.1.3-4.3.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.3-4.3.2.5">
                  <p id="section-3.1.3-4.3.2.5.1">cross-certification request: One CA requests issuance of a
   cross-certificate from another CA.  For the purposes of this
   standard, the following terms are defined.  A "cross-certificate" is a certificate
   in which the subject CA and the
   issuer CA are distinct and SubjectPublicKeyInfo contains a
   verification key (i.e., the certificate has been issued for
   the subject CA's signing key pair).  When it is necessary to
   distinguish more finely, the following terms may be used: a
   cross-certificate is called an "inter-domain cross-certificate" if the subject
   and issuer CAs belong to
   different administrative domains; it is called an "intra-domain cross-certificate"
   otherwise.<a href="#section-3.1.3-4.3.2.5.1" class="pilcrow">¶</a></p>
</li>
              </ol>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1.3-4.3.3.1">
                  <p id="section-3.1.3-4.3.3.1.1">Note 1:  The above definition of "cross-certificate"
   aligns with the defined term "CA-certificate" in X.509.
   Note that this term is not to be confused with the X.500
   "cACertificate" attribute type, which is unrelated.<a href="#section-3.1.3-4.3.3.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1.3-4.3.4.1">
                  <p id="section-3.1.3-4.3.4.1.1">Note 2:  In many environments, the term "cross-certificate", unless further
   qualified, will be
   understood to be synonymous with "inter-domain cross-certificate" as defined
   above.<a href="#section-3.1.3-4.3.4.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1.3-4.3.5.1">
                  <p id="section-3.1.3-4.3.5.1.1">Note 3:  Issuance of cross-certificates may be, but is
   not necessarily, mutual; that is, two CAs may issue
   cross-certificates for each other.<a href="#section-3.1.3-4.3.5.1.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<ol start="1" type="1" class="normal type-1" id="section-3.1.3-4.3.6">
<li id="section-3.1.3-4.3.6.1">
                  <p id="section-3.1.3-4.3.6.1.1">[RFC-Editor: Please fix the enumeration and continue with '6'.] cross-certificate update: Similar to a normal certificate
   update, but involving a cross-certificate.<a href="#section-3.1.3-4.3.6.1.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-3.1.3-4.4">
              <p id="section-3.1.3-4.4.1">Certificate/CRL discovery operations: Some PKI management
  operations result in the publication of certificates or CRLs:<a href="#section-3.1.3-4.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.3-4.4.2">
<li id="section-3.1.3-4.4.2.1">
                  <p id="section-3.1.3-4.4.2.1.1">certificate publication: Having gone to the trouble of
   producing a certificate, some means for publishing may be
   needed.  The "means" defined in PKIX <span class="bcp14">MAY</span> involve the messages
   specified in Sections <a href="#sect-5.3.13" class="auto internal xref">5.3.13</a> to <a href="#sect-5.3.16" class="auto internal xref">5.3.16</a>, or <span class="bcp14">MAY</span> involve other
   methods (LDAP, for example) as described in <span>[<a href="#RFC4511" class="cite xref">RFC4511</a>]</span> or <span>[<a href="#RFC2585" class="cite xref">RFC2585</a>]</span>
   (the "Operational Protocols" documents of the PKIX
   series of specifications).<a href="#section-3.1.3-4.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-3.1.3-4.4.2.2">
                  <p id="section-3.1.3-4.4.2.2.1">CRL publication: As for certificate publication.<a href="#section-3.1.3-4.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-3.1.3-4.5">
              <p id="section-3.1.3-4.5.1">Recovery operations: Some PKI management operations are used when
  an end entity has "lost" its TEE:<a href="#section-3.1.3-4.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.3-4.5.2">
<li id="section-3.1.3-4.5.2.1">
                  <p id="section-3.1.3-4.5.2.1.1">key pair recovery: As an option, user client key materials
   (e.g., a user's private key used for decryption purposes) <span class="bcp14">MAY</span>
   be backed up by a CA, an RA, or a key backup system
   associated with a CA or RA.  If an entity needs to recover
   these backed up key materials (e.g., as a result of a
   forgotten password or a lost key chain file), a protocol
   exchange may be needed to support such recovery.<a href="#section-3.1.3-4.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-3.1.3-4.6">
              <p id="section-3.1.3-4.6.1">Revocation operations: Some PKI management operations result in the creation
  of new CRL entries and/or new CRLs:<a href="#section-3.1.3-4.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.1.3-4.6.2">
<li id="section-3.1.3-4.6.2.1">
                  <p id="section-3.1.3-4.6.2.1.1">revocation request: An authorized person advises a CA of an
   abnormal situation requiring certificate revocation.<a href="#section-3.1.3-4.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-3.1.3-4.7">
              <p id="section-3.1.3-4.7.1">TEE operations: Whilst the definition of TEE operations (e.g.,
  moving a TEE, changing a PIN, etc.) are beyond the scope of this
  specification, we do define a PKIMessage (CertRepMessage) that
  can form the basis of such operations.<a href="#section-3.1.3-4.7.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.1.3-5">Note that on-line protocols are not the only way of implementing the
above operations.  For all operations, there are off-line methods of
achieving the same result, and this specification does not mandate
use of on-line protocols.  For example, when hardware tokens are
used, many of the operations <span class="bcp14">MAY</span> be achieved as part of the physical
token delivery.<a href="#section-3.1.3-5" class="pilcrow">¶</a></p>
<p id="section-3.1.3-6">Later sections define a set of standard messages supporting the above
operations.  Transfer protocols for conveying these exchanges in
various environments (e.g., off-line: file-based, on-line: mail,
HTTP <span>[<a href="#I-D.ietf-lamps-rfc6712bis" class="cite xref">I-D.ietf-lamps-rfc6712bis</a>]</span>, MQTT, and CoAP <span>[<a href="#RFC9482" class="cite xref">RFC9482</a>]</span>) are
beyond the scope of this document and must be specified separately.
Appropriate transfer protocols <span class="bcp14">MUST</span> be capable of delivering the CMP
messages reliably.<a href="#section-3.1.3-6" class="pilcrow">¶</a></p>
<p id="section-3.1.3-7">CMP provides inbuilt integrity protection and authentication. The information
communicated unencrypted in CMP messages does not contain sensitive
information endangering the security of the PKI when intercepted. However,
it might be possible for an eavesdropper to utilize the available information to
gather confidential technical or business critical information. Therefore, users
should consider protection of confidentiality on lower levels of the protocol
stack, e.g., by using TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>, DTLS <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>, or IPSEC <span>[<a href="#RFC7296" class="cite xref">RFC7296</a>]</span><span>[<a href="#RFC4303" class="cite xref">RFC4303</a>]</span>.<a href="#section-3.1.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-4">
<section id="section-4">
      <h2 id="name-assumptions-and-restriction">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-assumptions-and-restriction" class="section-name selfRef">Assumptions and Restrictions</a>
      </h2>
<div id="sect-4.1">
<section id="section-4.1">
        <h3 id="name-end-entity-initialization">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-end-entity-initialization" class="section-name selfRef">End Entity Initialization</a>
        </h3>
<p id="section-4.1-1">The first step for an end entity in dealing with PKI management
entities is to request information about the PKI functions supported
and to securely acquire a copy of the relevant root CA public key(s).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.2">
<section id="section-4.2">
        <h3 id="name-initial-registration-certif">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-initial-registration-certif" class="section-name selfRef">Initial Registration/Certification</a>
        </h3>
<p id="section-4.2-1">There are many schemes that can be used to achieve initial
registration and certification of end entities.  No one method is
suitable for all situations due to the range of policies that a CA
may implement and the variation in the types of end entity which can
occur.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">However, we can classify the initial registration/certification
schemes that are supported by this specification.  Note that the word
"initial", above, is crucial: we are dealing with the situation where
the end entity in question has had no previous contact with the PKI,
except having received the root CA certificate of that PKI by some
zero-touch method like BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> and
<span>[<a href="#I-D.ietf-anima-brski-ae" class="cite xref">I-D.ietf-anima-brski-ae</a>]</span> or SZTP <span>[<a href="#RFC8572" class="cite xref">RFC8572</a>]</span>.  In case the end
entity already possesses certified keys, then some
simplifications/alternatives are possible.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Having classified the schemes that are supported by this
specification we can then specify some as mandatory and some as
optional.  The goal is that the mandatory schemes cover a sufficient
number of the cases that will arise in real use, whilst the optional
schemes are available for special cases that arise less frequently.
In this way, we achieve a balance between flexibility and ease of
implementation.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Further classification of mandatory and optional schemes addressing
different environments is available, e.g., in <a href="#sect-c" class="auto internal xref">Appendix C</a> and
<a href="#sect-d" class="auto internal xref">Appendix D</a> of this specification on managing human user certificates
as well as in the Lightweight CMP Profile <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> on fully
automating certificate management in a machine-to-machine and IoT
environment.  Also industry standards like <span>[<a href="#ETSI-3GPP.33.310" class="cite xref">ETSI-3GPP.33.310</a>]</span> for
mobile networks and <span>[<a href="#UNISIG.Subset-137" class="cite xref">UNISIG.Subset-137</a>]</span> for Rail Automation adopted
CMP and have specified a set of mandatory schemes for their use case.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">We will now describe the classification of initial
registration/certification schemes.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<div id="sect-4.2.1">
<section id="section-4.2.1">
          <h4 id="name-criteria-used">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-criteria-used" class="section-name selfRef">Criteria Used</a>
          </h4>
<div id="sect-4.2.1.1">
<section id="section-4.2.1.1">
            <h5 id="name-initiation-of-registration-">
<a href="#section-4.2.1.1" class="section-number selfRef">4.2.1.1. </a><a href="#name-initiation-of-registration-" class="section-name selfRef">Initiation of Registration/Certification</a>
            </h5>
<p id="section-4.2.1.1-1">In terms of the PKI messages that are produced, we can regard the
initiation of the initial registration/certification exchanges as
occurring wherever the first PKI message relating to the end entity
is produced.  Note that the real-world initiation of the
registration/certification procedure may occur elsewhere (e.g., a
personnel department may telephone an RA operator or using zero touch
methods like BRSKI <span>[<a href="#RFC8995" class="cite xref">RFC8995</a>]</span> or SZTP <span>[<a href="#RFC8572" class="cite xref">RFC8572</a>]</span>).<a href="#section-4.2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1.1-2">The possible locations are at the end entity, an RA, or a CA.<a href="#section-4.2.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.2.1.2">
<section id="section-4.2.1.2">
            <h5 id="name-end-entity-message-origin-a">
<a href="#section-4.2.1.2" class="section-number selfRef">4.2.1.2. </a><a href="#name-end-entity-message-origin-a" class="section-name selfRef">End Entity Message Origin Authentication</a>
            </h5>
<p id="section-4.2.1.2-1">The on-line messages produced by the end entity that requires a
certificate may be authenticated or not.  The requirement here is to
authenticate the origin of any messages from the end entity to the
PKI (CA/RA).<a href="#section-4.2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1.2-2">In this specification, such authentication is achieved by two different means:<a href="#section-4.2.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.1.2-3.1">
                <p id="section-4.2.1.2-3.1.1">symmetric: The PKI (CA/RA) issuing the end entity with a secret value (initial
authentication key) and reference value (used to identify the secret value)
via some out-of-band means.  The initial authentication key can then be used
to protect relevant PKI messages.<a href="#section-4.2.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.1.2-3.2">
                <p id="section-4.2.1.2-3.2.1">asymmetric: Using a private key and certificate issued by another PKI trusted
for initial authentication, e.g., an IDevID <span><a href="#IEEE.802.1AR-2018" class="internal xref">IEEE 802.1AR</a> [<a href="#IEEE.802.1AR-2018" class="cite xref">IEEE.802.1AR-2018</a>]</span>.
The trust establishment in this external PKI is out of scope of this document.<a href="#section-4.2.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.1.2-4">Thus, we can classify the initial registration/certification scheme
according to whether or not the on-line 'end entity -&gt; PKI management
entity' messages are authenticated or not.<a href="#section-4.2.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1.2-5">Note 1: We do not discuss the authentication of the 'PKI management
entity -&gt; end entity' messages here, as this is always <span class="bcp14">REQUIRED</span>.  In any case, it can be
achieved simply once the root-CA public key has been installed at the
end entity's equipment or it can be based on the initial
authentication key.<a href="#section-4.2.1.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2.1.2-6">Note 2: An initial registration/certification procedure can be secure
where the messages from the end entity are authenticated via some
out-of-band means (e.g., a subsequent visit).<a href="#section-4.2.1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.2.1.3">
<section id="section-4.2.1.3">
            <h5 id="name-location-of-key-generation">
<a href="#section-4.2.1.3" class="section-number selfRef">4.2.1.3. </a><a href="#name-location-of-key-generation" class="section-name selfRef">Location of Key Generation</a>
            </h5>
<p id="section-4.2.1.3-1">In this specification, "key generation" is regarded as occurring
wherever either the public or private component of a key pair first
occurs in a PKIMessage.  Note that this does not preclude a
centralized key generation service by a KGA; the actual key pair <span class="bcp14">MAY</span> have
been
generated elsewhere and transported to the end entity, RA, or CA
using a (proprietary or standardized) key generation request/response
protocol (outside the scope of this specification).<a href="#section-4.2.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1.3-2">Thus, there are three possibilities for the location of "key generation":
the end entity, a KGA, or a CA.<a href="#section-4.2.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.2.1.4">
<section id="section-4.2.1.4">
            <h5 id="name-confirmation-of-successful-">
<a href="#section-4.2.1.4" class="section-number selfRef">4.2.1.4. </a><a href="#name-confirmation-of-successful-" class="section-name selfRef">Confirmation of Successful Certification</a>
            </h5>
<p id="section-4.2.1.4-1">Following the creation of a certificate for an end entity,
additional assurance can be gained by having the end entity
explicitly confirm successful receipt of the message containing (or
indicating the creation of) the certificate.  Naturally, this
confirmation message must be protected (based on the initial
symmetric or asymmetric authentication key or other means).<a href="#section-4.2.1.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1.4-2">This gives two further possibilities: confirmed or not.<a href="#section-4.2.1.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-4.2.2">
<section id="section-4.2.2">
          <h4 id="name-initial-registration-certifi">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-initial-registration-certifi" class="section-name selfRef">Initial Registration/Certification Schemes</a>
          </h4>
<p id="section-4.2.2-1">The criteria above allow for a large number of initial
registration/certification schemes.  Examples of possible initial
registration/certification schemes can be found in the following
subsections.  An entity may support other schemes specified in
profiles of PKIX-CMP, such as <a href="#sect-c" class="auto internal xref">Appendix C</a> and <a href="#sect-d" class="auto internal xref">Appendix D</a> or <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span>.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<div id="sect-4.2.2.1">
<section id="section-4.2.2.1">
            <h5 id="name-centralized-scheme">
<a href="#section-4.2.2.1" class="section-number selfRef">4.2.2.1. </a><a href="#name-centralized-scheme" class="section-name selfRef">Centralized Scheme</a>
            </h5>
<p id="section-4.2.2.1-1">In terms of the classification above, this scheme is, in some ways,
the simplest possible, where:<a href="#section-4.2.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.1-2.1">
                <p id="section-4.2.2.1-2.1.1">initiation occurs at the certifying CA;<a href="#section-4.2.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.1-2.2">
                <p id="section-4.2.2.1-2.2.1">no on-line message authentication is required;<a href="#section-4.2.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.1-2.3">
                <p id="section-4.2.2.1-2.3.1">"key generation" occurs at the certifying CA (see <a href="#sect-4.2.1.3" class="auto internal xref">Section 4.2.1.3</a>);<a href="#section-4.2.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.1-2.4">
                <p id="section-4.2.2.1-2.4.1">no confirmation message is required.<a href="#section-4.2.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.2.1-3">In terms of message flow, this scheme means that the only message
required is sent from the CA to the end entity.  The message must
contain the entire TEE for the end entity.  Some out-of-band means
must be provided to allow the end entity to authenticate the message
received and to decrypt any encrypted values.<a href="#section-4.2.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.2.2.2">
<section id="section-4.2.2.2">
            <h5 id="name-basic-authenticated-scheme">
<a href="#section-4.2.2.2" class="section-number selfRef">4.2.2.2. </a><a href="#name-basic-authenticated-scheme" class="section-name selfRef">Basic Authenticated Scheme</a>
            </h5>
<p id="section-4.2.2.2-1">In terms of the classification above, this scheme is where:<a href="#section-4.2.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2.2.2-2.1">
                <p id="section-4.2.2.2-2.1.1">initiation occurs at the end entity;<a href="#section-4.2.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.2-2.2">
                <p id="section-4.2.2.2-2.2.1">message authentication is required;<a href="#section-4.2.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.2-2.3">
                <p id="section-4.2.2.2-2.3.1">"key generation" occurs at the end entity (see <a href="#sect-4.2.1.3" class="auto internal xref">Section 4.2.1.3</a>);<a href="#section-4.2.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-4.2.2.2-2.4">
                <p id="section-4.2.2.2-2.4.1">a confirmation message is recommended.<a href="#section-4.2.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-4.2.2.2-3">Note: An Initial Authentication Key (IAK) can be either a symmetric key or
an asymmetric private key with a certificate issued by another PKI trusted
for this purpose.  The establishment of such trust is out of scope of this
document.<a href="#section-4.2.2.2-3" class="pilcrow">¶</a></p>
<div id="section-4.2.2.2-4">
              <div class="alignLeft art-svg artwork" id="section-4.2.2.2-4.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="384" width="552" viewBox="0 0 552 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 24,94 L 96,94" fill="none" stroke="black"></path>
                  <path d="M 24,98 L 96,98" fill="none" stroke="black"></path>
                  <path d="M 408,94 L 504,94" fill="none" stroke="black"></path>
                  <path d="M 408,98 L 504,98" fill="none" stroke="black"></path>
                  <path d="M 136,192 L 176,192" fill="none" stroke="black"></path>
                  <path d="M 368,192 L 408,192" fill="none" stroke="black"></path>
                  <path d="M 136,256 L 176,256" fill="none" stroke="black"></path>
                  <path d="M 376,256 L 416,256" fill="none" stroke="black"></path>
                  <path d="M 136,304 L 176,304" fill="none" stroke="black"></path>
                  <path d="M 376,304 L 416,304" fill="none" stroke="black"></path>
                  <path d="M 136,352 L 176,352" fill="none" stroke="black"></path>
                  <path d="M 376,352 L 416,352" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="424,304 412,298.4 412,309.6" fill="black" transform="rotate(0,416,304)"></polygon>
                  <polygon class="arrowhead" points="416,192 404,186.4 404,197.6" fill="black" transform="rotate(0,408,192)"></polygon>
                  <polygon class="arrowhead" points="384,352 372,346.4 372,357.6" fill="black" transform="rotate(180,376,352)"></polygon>
                  <polygon class="arrowhead" points="384,256 372,250.4 372,261.6" fill="black" transform="rotate(180,376,256)"></polygon>
                  <polygon class="arrowhead" points="184,304 172,298.4 172,309.6" fill="black" transform="rotate(0,176,304)"></polygon>
                  <polygon class="arrowhead" points="184,192 172,186.4 172,197.6" fill="black" transform="rotate(0,176,192)"></polygon>
                  <polygon class="arrowhead" points="144,352 132,346.4 132,357.6" fill="black" transform="rotate(180,136,352)"></polygon>
                  <polygon class="arrowhead" points="144,256 132,250.4 132,261.6" fill="black" transform="rotate(180,136,256)"></polygon>
                  <g class="text">
                    <text x="12" y="36">In</text>
                    <text x="48" y="36">terms</text>
                    <text x="84" y="36">of</text>
                    <text x="128" y="36">message</text>
                    <text x="184" y="36">flow,</text>
                    <text x="224" y="36">the</text>
                    <text x="264" y="36">basic</text>
                    <text x="344" y="36">authenticated</text>
                    <text x="428" y="36">scheme</text>
                    <text x="468" y="36">is</text>
                    <text x="492" y="36">as</text>
                    <text x="36" y="52">follows:</text>
                    <text x="32" y="84">End</text>
                    <text x="76" y="84">entity</text>
                    <text x="456" y="84">RA/CA</text>
                    <text x="104" y="116">out-of-band</text>
                    <text x="204" y="116">distribution</text>
                    <text x="268" y="116">of</text>
                    <text x="312" y="116">Initial</text>
                    <text x="404" y="116">Authentication</text>
                    <text x="72" y="132">Key</text>
                    <text x="112" y="132">(IAK)</text>
                    <text x="152" y="132">and</text>
                    <text x="208" y="132">reference</text>
                    <text x="272" y="132">value</text>
                    <text x="324" y="132">(RA/CA</text>
                    <text x="364" y="132">-&gt;</text>
                    <text x="392" y="132">EE)</text>
                    <text x="32" y="148">Key</text>
                    <text x="92" y="148">generation</text>
                    <text x="52" y="164">Creation</text>
                    <text x="100" y="164">of</text>
                    <text x="168" y="164">certification</text>
                    <text x="256" y="164">request</text>
                    <text x="48" y="180">Protect</text>
                    <text x="112" y="180">request</text>
                    <text x="164" y="180">with</text>
                    <text x="200" y="180">IAK</text>
                    <text x="240" y="196">certification</text>
                    <text x="328" y="196">request</text>
                    <text x="420" y="212">verify</text>
                    <text x="480" y="212">request</text>
                    <text x="424" y="228">process</text>
                    <text x="488" y="228">request</text>
                    <text x="420" y="244">create</text>
                    <text x="484" y="244">response</text>
                    <text x="240" y="260">certification</text>
                    <text x="332" y="260">response</text>
                    <text x="44" y="276">handle</text>
                    <text x="108" y="276">response</text>
                    <text x="44" y="292">create</text>
                    <text x="124" y="292">confirmation</text>
                    <text x="204" y="308">cert</text>
                    <text x="244" y="308">conf</text>
                    <text x="296" y="308">message</text>
                    <text x="420" y="324">verify</text>
                    <text x="500" y="324">confirmation</text>
                    <text x="420" y="340">create</text>
                    <text x="484" y="340">response</text>
                    <text x="204" y="356">conf</text>
                    <text x="240" y="356">ack</text>
                    <text x="300" y="356">(optional)</text>
                    <text x="44" y="372">handle</text>
                    <text x="108" y="372">response</text>
                  </g>
                </svg><a href="#section-4.2.2.2-4.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-4.2.2.2-5">Note: Where verification of the cert confirmation message fails, the RA/CA
<span class="bcp14">MUST</span> revoke the newly issued certificate if it has been published or
otherwise made available.<a href="#section-4.2.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-4.3">
<section id="section-4.3">
        <h3 id="name-proof-of-possession-pop-of-">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-proof-of-possession-pop-of-" class="section-name selfRef">Proof-of-Possession (POP) of Private Key</a>
        </h3>
<p id="section-4.3-1">Proof-of-possession (POP) is where a PKI management entity (CA/RA)
verifies if an end entity has access to the private key
corresponding to a given public key. The question of whether, and in
what circumstances, POPs add value to a PKI is a debate as old as PKI
itself! See <a href="#sect-8.1" class="auto internal xref">Section 8.1</a> for a further discussion on the necessity
of proof-of-possession in PKI.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">The PKI management operations specified here make it possible
for an end entity to prove to a CA/RA that it has possession of (i.e., is able
to use) the private key corresponding to the public key for which a
certificate is requested (see <a href="#sect-5.2.8" class="auto internal xref">Section 5.2.8</a> for different POP methods).  A given CA/RA is free to choose how to
enforce POP (e.g., out-of-band procedural means versus PKIX-CMP
in-band messages) in its certification exchanges (i.e., this may be a
policy issue).  However, it is <span class="bcp14">REQUIRED</span> that CAs/RAs <span class="bcp14">MUST</span> enforce POP
by some means because there are currently many non-PKIX operational
protocols in use (various electronic mail protocols are one example)
that do not explicitly check the binding between the end entity and
the private key.  Until operational protocols that do verify the
binding (for signature, encryption, key agreement, and KEM key pairs)
exist, and are ubiquitous, this binding can only be assumed to have
been verified by the CA/RA.  Therefore, if the binding is not
verified by the CA/RA, certificates in the Internet Public-Key
Infrastructure end up being somewhat less meaningful.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">POP is accomplished in different ways depending upon the type of key
for which a certificate is requested.  If a key can be used for
multiple purposes (e.g., an RSA key) then any appropriate method <span class="bcp14">MAY</span>
be used (e.g., a key that may be used for signing, as well as other
purposes, <span class="bcp14">MUST NOT</span> be sent to the CA/RA in order to prove
possession unless archival of the private key is explicitly desired).<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">This specification explicitly allows for cases where an end entity
supplies the relevant proof to an RA and the RA subsequently attests
to the CA that the required proof has been received (and validated!).
For example, an end entity wishing to have a signing key certified
could send the appropriate signature to the RA, which then simply
notifies the relevant CA that the end entity has supplied the
required proof.  Of course, such a situation may be disallowed by
some policies (e.g., CAs may be the only entities permitted to verify
POP during certification).<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<div id="sect-4.3.1">
<section id="section-4.3.1">
          <h4 id="name-signature-keys">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-signature-keys" class="section-name selfRef">Signature Keys</a>
          </h4>
<p id="section-4.3.1-1">For signature keys, the end entity can sign a value to prove
possession of the private key, see <a href="#sect-5.2.8.2" class="auto internal xref">Section 5.2.8.2</a>.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.3.2">
<section id="section-4.3.2">
          <h4 id="name-encryption-keys">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-encryption-keys" class="section-name selfRef">Encryption Keys</a>
          </h4>
<p id="section-4.3.2-1">For encryption keys, the end entity can provide the private key to
the CA/RA (e.g., for archiving), see <a href="#sect-5.2.8.3.1" class="auto internal xref">Section 5.2.8.3.1</a>, or can be required to decrypt a value in order to prove
possession of the private key.  Decrypting a
value can be achieved either directly (see <a href="#sect-5.2.8.3.3" class="auto internal xref">Section 5.2.8.3.3</a>) or indirectly (see <a href="#sect-5.2.8.3.2" class="auto internal xref">Section 5.2.8.3.2</a>).<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">The direct method is for the RA/CA to issue a random challenge to
which an immediate response by the EE is required.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.2-3">The indirect method is to issue a certificate that is encrypted for
the end entity (and have the end entity demonstrate its ability to
decrypt this certificate in the confirmation message).  This allows a
CA to issue a certificate in a form that can only be used by the
intended end entity.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.3.2-4">This specification encourages use of the indirect method because it
requires no extra messages to be sent (i.e., the proof can be
demonstrated using the {request, response, confirmation} triple of
messages).<a href="#section-4.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.3.3">
<section id="section-4.3.3">
          <h4 id="name-key-agreement-keys">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-key-agreement-keys" class="section-name selfRef">Key Agreement Keys</a>
          </h4>
<p id="section-4.3.3-1">For key agreement keys, the end entity and the PKI management entity
(i.e., CA or RA) must establish a shared secret key in order to prove
that the end entity has possession of the private key.<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3.3-2">Note that this need not impose any restrictions on the keys that can
be certified by a given CA.  In particular, for Diffie-Hellman keys
the end entity may freely choose its algorithm parameters provided
that the CA can generate a short-term (or one-time) key pair with the
appropriate parameters when necessary.<a href="#section-4.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.3.4">
<section id="section-4.3.4">
          <h4 id="name-key-encapsulation-mechanism">
<a href="#section-4.3.4" class="section-number selfRef">4.3.4. </a><a href="#name-key-encapsulation-mechanism" class="section-name selfRef">Key Encapsulation Mechanism Keys</a>
          </h4>
<p id="section-4.3.4-1">For key encapsulation mechanism (KEM) keys, the end entity can provide the private key to
the CA/RA (e.g., for archiving), see <a href="#sect-5.2.8.3.1" class="auto internal xref">Section 5.2.8.3.1</a>, or can be required to decrypt
a value in order to prove possession of the private key.
Decrypting a value can be achieved either directly (see <a href="#sect-5.2.8.3.3" class="auto internal xref">Section 5.2.8.3.3</a>) or indirectly (see <a href="#sect-5.2.8.3.2" class="auto internal xref">Section 5.2.8.3.2</a>).<a href="#section-4.3.4-1" class="pilcrow">¶</a></p>
<p id="section-4.3.4-2">Note: A definition of key encapsulation mechanisms can be found in <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>], <a href="https://rfc-editor.org/rfc/rfc9629#section-1" class="relref">Section 1</a></span>.<a href="#section-4.3.4-2" class="pilcrow">¶</a></p>
<p id="section-4.3.4-3">The direct method is for the RA/CA to issue a random challenge to which an
immediate response by the EE is required.<a href="#section-4.3.4-3" class="pilcrow">¶</a></p>
<p id="section-4.3.4-4">The indirect method is to issue a certificate that is encrypted for the end entity using a shared secret key derived from a key encapsulated using the public key (and have the end entity demonstrate its ability to use its private key for decapsulation of the KEM ciphertext, derive the shared secret key, decrypt this certificate, and provide a hash of the certificate in the confirmation message).  This allows a CA to issue a certificate in a form that can only be used by the intended end entity.<a href="#section-4.3.4-4" class="pilcrow">¶</a></p>
<p id="section-4.3.4-5">This specification encourages use of the indirect method because it requires
no extra messages to be sent (i.e., the proof can be demonstrated using the
{request, response, confirmation} triple of messages).<a href="#section-4.3.4-5" class="pilcrow">¶</a></p>
<p id="section-4.3.4-6">A certification request message for a KEM certificate <span class="bcp14">SHALL</span> use POPOPrivKey by using the keyEncipherment choice of ProofOfPossession, see <a href="#sect-5.2.8" class="auto internal xref">Section 5.2.8</a>, in the popo field of CertReqMsg as long as no KEM-specific choice is available.<a href="#section-4.3.4-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-4.4">
<section id="section-4.4">
        <h3 id="name-root-ca-key-update">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-root-ca-key-update" class="section-name selfRef">Root CA Key Update</a>
        </h3>
<p id="section-4.4-1">This discussion only applies to CAs that are directly trusted by some
end entities.  Recognizing whether a self-signed or non-self-signed
CA is supposed to be directly trusted for some end entities is a
matter of CA policy and end entity configuration. This is thus beyond
the scope of this document.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">The basis of the procedure described here is that the CA protects its
new public key using its previous private key and vice versa. Thus,
when a CA updates its key pair it may generate two link certificates
"old with new" and "new with old".<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">Note: The usage of link certificates has been shown to be very use
case specific and no assumptions are done on this aspect.
RootCaKeyUpdateContent is updated to specify these link certificates
as optional.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">Note: When an LDAP directory is used to publish root CA updates, the
old and new root CA certificates together with the two link
certificates are stored as cACertificate attribute values.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">When a CA changes its key pair, those entities who have acquired the
old CA public key via "out-of-band" means are most affected.  These
end entities need to acquire the new CA public key in a trusted way.
This may be achieved "out-of-band", by using a repository, or by
using online messages also containing the link certificates
"new with old". Once the end entity acquired and properly verified
the new CA public key, it must load the new trust anchor information
into its trusted store.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<p id="section-4.4-6">The data structure used to protect the new and old CA public keys is
typically a standard X.509 v3 self-signed certificate (which may also
contain extensions).  There are no new data structures required.<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<p id="section-4.4-7">Note: Sometimes root CA certificates do not make use of
X.509 v3 extensions and may be X.509 v1 certificates. Therefore, a
root CA key update must be able to work for version 1 certificates.
The use of the X.509 v3 KeyIdentifier extension is recommended for
easier path building.<a href="#section-4.4-7" class="pilcrow">¶</a></p>
<p id="section-4.4-8">Note:  While the scheme could be generalized to cover cases where
the CA updates its key pair more than once during the validity period
of one of its end entities' certificates, this generalization seems
of dubious value.  Not having this generalization simply means that
the validity periods of certificates issued with the old CA key pair
cannot exceed the end of the "old with new" certificate validity
period.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
<p id="section-4.4-9">Note:  This scheme offers a mechanism to ensures that end entities
will acquire the new CA public key, at the latest by the expiry of
the last certificate they owned that was signed with the old CA
private key.  Certificate and/or key update operations occurring at
other times do not necessarily require this (depending on the end
entity's equipment).<a href="#section-4.4-9" class="pilcrow">¶</a></p>
<p id="section-4.4-10">Note:  In practice, a new root CA may have a slightly different subject
DN, e.g., indicating a generation identifier like the year of issuance or
a version number, for instance in an OU element.  How to bridge trust to
the new root CA certificate in a CA DN change or a cross-certificate scenario
is out of scope for this document.<a href="#section-4.4-10" class="pilcrow">¶</a></p>
<div id="sect-4.4.1">
<section id="section-4.4.1">
          <h4 id="name-ca-operator-actions">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-ca-operator-actions" class="section-name selfRef">CA Operator Actions</a>
          </h4>
<p id="section-4.4.1-1">To change the key of the CA, the CA operator does the following:<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4.1-2">
<li id="section-4.4.1-2.1">
              <p id="section-4.4.1-2.1.1">Generate a new key pair.<a href="#section-4.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.4.1-2.2">
              <p id="section-4.4.1-2.2.1">Create a certificate containing the new CA public key signed with
  the new private key (the "new with new" certificate).<a href="#section-4.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.4.1-2.3">
              <p id="section-4.4.1-2.3.1">Optionally: Create a link certificate containing the new CA public
  key signed with the old private key (the "new with old"
  certificate).<a href="#section-4.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.4.1-2.4">
              <p id="section-4.4.1-2.4.1">Optionally: Create a link certificate containing the old CA public
  key signed with the new private key (the "old with new"
  certificate).<a href="#section-4.4.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-4.4.1-2.5">
              <p id="section-4.4.1-2.5.1">Publish these new certificates so that end entities may acquire
  it, e.g., using a repository or RootCaKeyUpdateContent.<a href="#section-4.4.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-4.4.1-3">The old CA private key is then no longer required when the validity
of the "old with old" certificate ended. However, the old
CA public key will remain in use for validating the "new with old"
link certificate until the new CA public key is loaded into the
trusted store. The old CA public key is no longer required (other
than for non-repudiation) when all end entities of this CA have
securely acquired and stored the new CA public key.<a href="#section-4.4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.4.1-4">The "new with new" certificate must have a validity period with a notBefore
time that is before the notAfter time of the "old with old" certificate and
a notAfter time that is after the notBefore time of the next update of this
certificate.<a href="#section-4.4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.4.1-5">The "new with old" certificate must have a validity period with the same
notBefore time as the "new with new" certificate and a notAfter time by which
all end entities of this CA will securely possess the new CA public key (at
the latest, at the notAfter time of the "old with old" certificate).<a href="#section-4.4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.4.1-6">The "old with new" certificate must have a validity period with the same
notBefore and notAfter time as the "old with old" certificate.<a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.4.1-7">Note:  Further operational considerations on transition from one root CA
self-signed certificate to the next is available in <span><a href="#RFC8649" class="internal xref">RFC 8649 Section 5</a> [<a href="#RFC8649" class="cite xref">RFC8649</a>]</span>.<a href="#section-4.4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.4.2">
<section id="section-4.4.2">
          <h4 id="name-verifying-certificates">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-verifying-certificates" class="section-name selfRef">Verifying Certificates</a>
          </h4>
<p id="section-4.4.2-1">Normally when verifying a signature, the verifier verifies (among
other things) the certificate containing the public key of the
signer.  However, once a CA is allowed to update its key there are a
range of new possibilities.  These are shown in the table below.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
            <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1"> </th>
                <th class="text-left" rowspan="1" colspan="1">Verifier's TEE contains NEW public key</th>
                <th class="text-left" rowspan="1" colspan="1">Verifier's TEE contains OLD public key</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Signer's certificate is protected using NEW key pair</td>
                <td class="text-left" rowspan="1" colspan="1">Case 1: The verifier can directly verify the certificate.</td>
                <td class="text-left" rowspan="1" colspan="1">Case 2: The verifier is missing the NEW public key.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Signer's certificate is protected using OLD key pair</td>
                <td class="text-left" rowspan="1" colspan="1">Case 3: The verifier is missing the OLD public key.</td>
                <td class="text-left" rowspan="1" colspan="1">Case 4: The verifier can directly verify the certificate.</td>
              </tr>
            </tbody>
          </table>
<div id="sect-4.4.2.1">
<section id="section-4.4.2.1">
            <h5 id="name-verification-in-cases-1-and">
<a href="#section-4.4.2.1" class="section-number selfRef">4.4.2.1. </a><a href="#name-verification-in-cases-1-and" class="section-name selfRef">Verification in Cases 1 and 4</a>
            </h5>
<p id="section-4.4.2.1-1">In these cases, the verifier has a local copy of the CA public key
that can be used to verify the certificate directly.  This is the
same as the situation where no key change has occurred.<a href="#section-4.4.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-4.4.2.2">
<section id="section-4.4.2.2">
            <h5 id="name-verification-in-case-2">
<a href="#section-4.4.2.2" class="section-number selfRef">4.4.2.2. </a><a href="#name-verification-in-case-2" class="section-name selfRef">Verification in Case 2</a>
            </h5>
<p id="section-4.4.2.2-1">In case 2, the verifier must get access to the new public key of the
CA. Case 2 will arise when the CA operator has issued the verifier's
certificate, then changed the CA's key, and then issued the signer's
certificate; so it is quite a typical case.<a href="#section-4.4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.2-2">The verifier does the following:<a href="#section-4.4.2.2-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4.2.2-3">
<li id="section-4.4.2.2-3.1">
                <p id="section-4.4.2.2-3.1.1">Get the "new with new" and "new with old" certificates. The
  location to retrieve theses certificates from, may be available in
  the authority information access extension of the "old with old"
  certificate, see caIssuers access method in Section 4.2.2.1 of
  <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, or it may be locally configured.<a href="#section-4.4.2.2-3.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4.2.2-3.1.2">
<li id="section-4.4.2.2-3.1.2.1">
                    <p id="section-4.4.2.2-3.1.2.1.1">If a repository is available, look up the certificates in the
   caCertificate attribute.<a href="#section-4.4.2.2-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li id="section-4.4.2.2-3.1.2.2">
                    <p id="section-4.4.2.2-3.1.2.2.1">If a HTTP or FTP server is available, pick the certificates
   from the "certs-only" CMS message.<a href="#section-4.4.2.2-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li id="section-4.4.2.2-3.1.2.3">
                    <p id="section-4.4.2.2-3.1.2.3.1">If a CMP server is available, request the certificates using
   the root CA update general message, see <a href="#sect-5.3.19.15" class="auto internal xref">Section 5.3.19.15</a>.<a href="#section-4.4.2.2-3.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li id="section-4.4.2.2-3.1.2.4">
                    <p id="section-4.4.2.2-3.1.2.4.1">Otherwise, get the certificates "out-of-band" using any
   trustworthy mechanism.<a href="#section-4.4.2.2-3.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ol>
</li>
              <li id="section-4.4.2.2-3.2">
                <p id="section-4.4.2.2-3.2.1">If received the certificates, check that the validity periods
  and the subject and issuer fields match. Verify the signatures
  using the old root CA key (which the verifier has locally).<a href="#section-4.4.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.4.2.2-3.3">
                <p id="section-4.4.2.2-3.3.1">If all checks were successful, securely store the new trust anchor
  information and validate the signer's certificate.<a href="#section-4.4.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
<div id="sect-4.4.2.3">
<section id="section-4.4.2.3">
            <h5 id="name-verification-in-case-3">
<a href="#section-4.4.2.3" class="section-number selfRef">4.4.2.3. </a><a href="#name-verification-in-case-3" class="section-name selfRef">Verification in Case 3</a>
            </h5>
<p id="section-4.4.2.3-1">In case 3, the verifier must get access to the old public key of the
CA. Case 3 will arise when the CA operator has issued the signer's
certificate, then changed the key, and then issued the verifier's
certificate.<a href="#section-4.4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2.3-2">The verifier does the following:<a href="#section-4.4.2.3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4.2.3-3">
<li id="section-4.4.2.3-3.1">
                <p id="section-4.4.2.3-3.1.1">Get the "old with new" certificate. The location to retrieve
  theses certificates from, may be available in the authority
  information access extension of the "new with new" certificate, see
  caIssuers access method in Section 4.2.2.1 of <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, or it
  may be locally configured.<a href="#section-4.4.2.3-3.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.4.2.3-3.1.2">
<li id="section-4.4.2.3-3.1.2.1">
                    <p id="section-4.4.2.3-3.1.2.1.1">If a repository is available, look up the certificate in the
   caCertificate attribute.<a href="#section-4.4.2.3-3.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li id="section-4.4.2.3-3.1.2.2">
                    <p id="section-4.4.2.3-3.1.2.2.1">If a HTTP or FTP server is available, pick the certificate
   from the "certs-only" CMS message.<a href="#section-4.4.2.3-3.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li id="section-4.4.2.3-3.1.2.3">
                    <p id="section-4.4.2.3-3.1.2.3.1">If a CMP server and an untrusted copy of the old root CA
   certificate is available (e.g., the signer provided it in-band
   in the CMP extraCerts filed), request the certificate using the
   root CA update general message, see <a href="#sect-5.3.19.15" class="auto internal xref">Section 5.3.19.15</a>.<a href="#section-4.4.2.3-3.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li id="section-4.4.2.3-3.1.2.4">
                    <p id="section-4.4.2.3-3.1.2.4.1">Otherwise, get the certificate "out-of-band" using any
   trustworthy mechanism.<a href="#section-4.4.2.3-3.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ol>
</li>
              <li id="section-4.4.2.3-3.2">
                <p id="section-4.4.2.3-3.2.1">If received the certificate, check that the validity periods
  and the subject and issuer fields match. Verify the signatures
  using the new root CA key (which the verifier has locally).<a href="#section-4.4.2.3-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-4.4.2.3-3.3">
                <p id="section-4.4.2.3-3.3.1">If all checks were successful, securely store the old trust anchor
  information and validate the signer's certificate.<a href="#section-4.4.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
</section>
</div>
<div id="sect-4.4.3">
<section id="section-4.4.3">
          <h4 id="name-revocation-change-of-ca-key">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-revocation-change-of-ca-key" class="section-name selfRef">Revocation - Change of CA Key</a>
          </h4>
<p id="section-4.4.3-1">As we saw above, the verification of a certificate becomes more
complex once the CA is allowed to change its key.  This is also true
for revocation checks as the CA may have signed the CRL using a newer
private key than the one within the user's TEE.<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.3-2">The analysis of the alternatives is the same as for certificate
verification.<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-4.5">
<section id="section-4.5">
        <h3 id="name-extended-key-usage-for-pki-">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-extended-key-usage-for-pki-" class="section-name selfRef">Extended Key Usage for PKI Entities</a>
        </h3>
<p id="section-4.5-1">The extended key usage (EKU) extension indicates the purposes for which the
certified key pair may be used. Therefore, it restricts the use of a certificate
to specific applications.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">A CA may want to delegate parts of its duties to other PKI management entities.
This section provides a mechanism to both prove this delegation and enable
automated means for checking the authorization of this delegation. Such delegation
may also be expressed by other means, e.g., explicit configuration.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
<p id="section-4.5-3">To offer automatic validation for the delegation of a role by a CA to another
entity, the certificates used for CMP message protection or signed data for
central key generation <span class="bcp14">MUST</span> be issued by the delegating CA and <span class="bcp14">MUST</span> contain
the respective EKUs.  This proves that the delegating CA authorized this entity to act in the given role, as described below.<a href="#section-4.5-3" class="pilcrow">¶</a></p>
<p id="section-4.5-4">The OIDs to be used for these EKUs are:<a href="#section-4.5-4" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-4.5-5">
<pre>
  id-kp-cmcCA OBJECT IDENTIFIER ::= {
     iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) kp(3) 27 }

  id-kp-cmcRA OBJECT IDENTIFIER ::= {
     iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) kp(3) 28 }

  id-kp-cmKGA OBJECT IDENTIFIER ::= {
     iso(1) identified-organization(3) dod(6) internet(1)
     security(5) mechanisms(5) pkix(7) kp(3) 32 }
</pre><a href="#section-4.5-5" class="pilcrow">¶</a>
</div>
<p id="section-4.5-6">Note: Section 2.10 of <span>[<a href="#RFC6402" class="cite xref">RFC6402</a>]</span> specifies OIDs for a
Certificate Management over CMS (CMC) CA and a CMC RA.
As the functionality of a CA and
RA is not specific to any certificate management protocol (such as CMC or CMP),
these EKUs are reused by CMP.<a href="#section-4.5-6" class="pilcrow">¶</a></p>
<p id="section-4.5-7">The meaning of the id-kp-cmKGA EKU is as follows:<a href="#section-4.5-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.5-8">
          <dt id="section-4.5-8.1">CMP KGA:</dt>
          <dd style="margin-left: 4.5em" id="section-4.5-8.2">
            <p id="section-4.5-8.2.1">CMP key generation authorities are CAs or are identified by the id-kp-cmKGA
extended key usage.  The CMP KGA knows the private key it generated on behalf
of the end entity.  This is a very sensitive service and needs specific authorization,
which by default is with the CA certificate itself.  The CA may delegate
its authorization by placing the id-kp-cmKGA extended key usage in the certificate
used to authenticate the origin of the generated private key. The authorization
may also be determined through local configuration of the end entity.<a href="#section-4.5-8.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-5">
      <h2 id="name-data-structures">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-data-structures" class="section-name selfRef">Data Structures</a>
      </h2>
<p id="section-5-1">This section contains descriptions of the data structures required
for PKI management messages. <a href="#sect-6" class="auto internal xref">Section 6</a> describes constraints on
their values and the sequence of events for each of the various PKI
management operations.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="sect-5.1">
<section id="section-5.1">
        <h3 id="name-overall-pki-message">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-overall-pki-message" class="section-name selfRef">Overall PKI Message</a>
        </h3>
<p id="section-5.1-1">All of the messages used in this specification for the purposes of PKI management
use the following structure:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1-2">
<pre>
  PKIMessage ::= SEQUENCE {
     header           PKIHeader,
     body             PKIBody,
     protection   [0] PKIProtection OPTIONAL,
     extraCerts   [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                       OPTIONAL
  }

  PKIMessages ::= SEQUENCE SIZE (1..MAX) OF PKIMessage
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">The PKIHeader contains information that is common to many PKI
messages.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">The PKIBody contains message-specific information.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">The PKIProtection, when used, contains bits that protect the PKI
message.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">The extraCerts field can contain certificates that may be useful to
the recipient.  For example, this can be used by a CA or RA to
present an end entity with certificates that it needs to verify its
own new certificate (if, for example, the CA that issued the end
entity's certificate is not a root CA for the end entity).  Note that
this field does not necessarily contain a certification path; the
recipient may have to sort, select from, or otherwise process the
extra certificates in order to use them.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<div id="sect-5.1.1">
<section id="section-5.1.1">
          <h4 id="name-pki-message-header">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-pki-message-header" class="section-name selfRef">PKI Message Header</a>
          </h4>
<p id="section-5.1.1-1">All PKI messages require some header information for addressing and
transaction identification.  Some of this information will also be
present in a transport-specific envelope.  However, if the PKI
message is protected, then this information is also protected (i.e.,
we make no assumption about secure transport).<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">The following data structure is used to contain this information:<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.1-3">
<pre>
  PKIHeader ::= SEQUENCE {
     pvno                INTEGER     { cmp1999(1), cmp2000(2),
                                       cmp2021(3) },
     sender              GeneralName,
     recipient           GeneralName,
     messageTime     [0] GeneralizedTime         OPTIONAL,
     protectionAlg   [1] AlgorithmIdentifier{ALGORITHM, {...}}
                         OPTIONAL,
     senderKID       [2] KeyIdentifier           OPTIONAL,
     recipKID        [3] KeyIdentifier           OPTIONAL,
     transactionID   [4] OCTET STRING            OPTIONAL,
     senderNonce     [5] OCTET STRING            OPTIONAL,
     recipNonce      [6] OCTET STRING            OPTIONAL,
     freeText        [7] PKIFreeText             OPTIONAL,
     generalInfo     [8] SEQUENCE SIZE (1..MAX) OF
                         InfoTypeAndValue     OPTIONAL
  }

  PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
</pre><a href="#section-5.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1-4">The usage of the protocol version number (pvno) is described in <a href="#sect-7" class="auto internal xref">Section 7</a>.<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.1-5">The sender field contains the name of the sender of the PKIMessage.
This name (in conjunction with senderKID, if supplied) should be
sufficient to indicate the key to use to verify the protection on the
message.  If nothing about the sender is known to the sending entity
(e.g., in the initial request message, where the end entity may not know
its own Distinguished Name (DN), e-mail name, IP address, etc.), then
the "sender" field <span class="bcp14">MUST</span> contain a "NULL-DN" value in the directoryName choice.
A "NULL-DN" is a SEQUENCE OF relative distinguished names of zero length and is encoded as 0x3000.
In such a case, the senderKID field <span class="bcp14">MUST</span> hold an identifier (i.e., a reference
number) that indicates to the receiver the appropriate shared secret
information to use to verify the message.<a href="#section-5.1.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1.1-6">The recipient field contains the name of the recipient of the
PKIMessage.  This name (in conjunction with recipKID, if supplied)
should be usable to verify the protection on the message.<a href="#section-5.1.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1.1-7">The protectionAlg field specifies the algorithm used to protect the
message.  If no protection bits are supplied (note that PKIProtection
is <span class="bcp14">OPTIONAL</span>) then this field <span class="bcp14">MUST</span> be omitted; if protection bits are
supplied, then this field <span class="bcp14">MUST</span> be supplied.<a href="#section-5.1.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1.1-8">senderKID and recipKID are usable to indicate which keys have been
used to protect the message (recipKID will normally only be required
where protection of the message uses Diffie-Hellman (DH) or elliptic curve Diffie-Hellman (ECDH) keys).
These fields <span class="bcp14">MUST</span> be used if required to uniquely identify a key
(e.g., if more than one key is associated with a given sender name).
The senderKID <span class="bcp14">SHOULD</span> be used in any case.<a href="#section-5.1.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1.1-9">Note: The recommendation of using senderKID is changed since <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span>,
where it was recommended to be omitted if not needed to identify the protection
key.<a href="#section-5.1.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1.1-10">The transactionID field within the message header is to be used to
allow the recipient of a message to correlate this with an ongoing
transaction.  This is needed for all transactions that consist of
more than just a single request/response pair.  For transactions that
consist of a single request/response pair, the rules are as follows.
A client <span class="bcp14">MUST</span> populate the transactionID field if the message
contains an infoValue of type KemCiphertextInfo, see <a href="#sect-5.1.3.4" class="auto internal xref">Section 5.1.3.4</a>. In all other cases
the client <span class="bcp14">MAY</span> populate the transactionID field of the request.  If a
server receives such a request that has the transactionID field set,
then it <span class="bcp14">MUST</span> set the transactionID field of the response to the same
value.  If a server receives such request with a missing
transactionID field, then it <span class="bcp14">MUST</span> populate the transactionID field if
the message contains a KemCiphertextInfo field. In all other cases
the server <span class="bcp14">MAY</span> set transactionID field of the response.<a href="#section-5.1.1-10" class="pilcrow">¶</a></p>
<p id="section-5.1.1-11">For transactions that consist of more than just a single
request/response pair, the rules are as follows.  If the message
contains an infoValue of type KemCiphertextInfo, the client
<span class="bcp14">MUST</span> generate a transactionID, otherwise the client <span class="bcp14">SHOULD</span>
generate a transactionID for the first request.  If a server receives
such a request that has the transactionID field set, then it <span class="bcp14">MUST</span> set
the transactionID field of the response to the same value.  If a
server receives such request with a missing transactionID field, then
it <span class="bcp14">MUST</span> populate the transactionID field of the response with a
server-generated ID.  Subsequent requests and responses <span class="bcp14">MUST</span> all set
the transactionID field to the thus established value.  In all cases
where a transactionID is being used, a given client <span class="bcp14">MUST NOT</span> have
more than one transaction with the same transactionID in progress at
any time (to a given server).  Servers are free to require uniqueness
of the transactionID or not, as long as they are able to correctly
associate messages with the corresponding transaction.  Typically,
this means that a server will require the {client, transactionID}
tuple to be unique, or even the transactionID alone to be unique, if
it cannot distinguish clients based on any transport-level information.
A server receiving the first message of a transaction (which requires
more than a single request/response pair) that contains a
transactionID that does not allow it to meet the above constraints
(typically because the transactionID is already in use) <span class="bcp14">MUST</span> send
back an ErrorMsgContent with a PKIFailureInfo of transactionIdInUse.
It is <span class="bcp14">RECOMMENDED</span> that the clients fill the transactionID field with
128 bits of (pseudo-) random data for the start of a transaction to
reduce the probability of having the transactionID in use at the
server.<a href="#section-5.1.1-11" class="pilcrow">¶</a></p>
<p id="section-5.1.1-12">The senderNonce and recipNonce fields protect the PKIMessage against
replay attacks.  The senderNonce will typically be 128 bits of
(pseudo-) random data generated by the sender, whereas the recipNonce
is copied from the senderNonce field of the previous message in the
transaction.<a href="#section-5.1.1-12" class="pilcrow">¶</a></p>
<p id="section-5.1.1-13">The messageTime field contains the time at which the sender created
the message.  This may be useful to allow end entities to
correct/check their local time for consistency with the time on a
central system.<a href="#section-5.1.1-13" class="pilcrow">¶</a></p>
<p id="section-5.1.1-14">The freeText field may be used to send a human-readable message to
the recipient (in any number of languages).  Each UTF8String <span class="bcp14">MAY</span>
include an <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span> language tag to indicate the language of the
contained text. The first language used in this sequence indicates
the desired language for replies.<a href="#section-5.1.1-14" class="pilcrow">¶</a></p>
<p id="section-5.1.1-15">The generalInfo field may be used to send machine-processable
additional data to the recipient.  The following generalInfo
extensions are defined and <span class="bcp14">MAY</span> be supported.<a href="#section-5.1.1-15" class="pilcrow">¶</a></p>
<div id="sect-5.1.1.1">
<section id="section-5.1.1.1">
            <h5 id="name-implicitconfirm">
<a href="#section-5.1.1.1" class="section-number selfRef">5.1.1.1. </a><a href="#name-implicitconfirm" class="section-name selfRef">ImplicitConfirm</a>
            </h5>
<p id="section-5.1.1.1-1">This is used by the EE to inform the CA or RA that it does not wish to send
a certificate confirmation for issued certificates.<a href="#section-5.1.1.1-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.1.1-2">
<pre>
  id-it-implicitConfirm OBJECT IDENTIFIER ::= {id-it 13}
  ImplicitConfirmValue ::= NULL
</pre><a href="#section-5.1.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1.1-3">If the CA grants the request to the EE, it <span class="bcp14">MUST</span> put the same
extension in the PKIHeader of the response.  If the EE does not find
the extension in the response, it <span class="bcp14">MUST</span> send the certificate
confirmation.<a href="#section-5.1.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.1.2">
<section id="section-5.1.1.2">
            <h5 id="name-confirmwaittime">
<a href="#section-5.1.1.2" class="section-number selfRef">5.1.1.2. </a><a href="#name-confirmwaittime" class="section-name selfRef">ConfirmWaitTime</a>
            </h5>
<p id="section-5.1.1.2-1">This is used by the CA or RA to inform the EE how long it intends to wait
for the certificate confirmation before revoking the certificate and
deleting the transaction.<a href="#section-5.1.1.2-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.1.2-2">
<pre>
  id-it-confirmWaitTime OBJECT IDENTIFIER ::= {id-it 14}
  ConfirmWaitTimeValue ::= GeneralizedTime
</pre><a href="#section-5.1.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.1.1.3">
<section id="section-5.1.1.3">
            <h5 id="name-origpkimessage">
<a href="#section-5.1.1.3" class="section-number selfRef">5.1.1.3. </a><a href="#name-origpkimessage" class="section-name selfRef">OrigPKIMessage</a>
            </h5>
<p id="section-5.1.1.3-1">An RA <span class="bcp14">MAY</span> include the original PKIMessage from the EE in the generalInfo
field of the PKIHeader of a PKIMessage.  This is used by the RA to inform
the CA of the original PKIMessage that it received from the EE and modified
in some way (e.g., added or modified particular field values or added new
extensions) before forwarding the new PKIMessage.  This
accommodates, for example, cases in which the CA wishes to check the message origin, the POP, or other
information on the original EE message.<a href="#section-5.1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1.3-2">Note: If the changes made by
the RA to the original PKIMessage break the POP of a certificate request,
the RA can set the popo field of the new PKIMessage to raVerified, see <a href="#sect-5.2.8.4" class="auto internal xref">Section 5.2.8.4</a>.<a href="#section-5.1.1.3-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1.3-3">Unless the OrigPKIMessage infoValue is in the header of a nested message, it <span class="bcp14">MUST</span> contain exactly one PKIMessage. The contents of OrigPKIMessage infoValue in the header of a nested message <span class="bcp14">MAY</span> contain multiple PKIMessage structures, which <span class="bcp14">MUST</span> be in the same order as the PKIMessage structures in PKIBody.<a href="#section-5.1.1.3-3" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.1.3-4">
<pre>
  id-it-origPKIMessage OBJECT IDENTIFIER ::= {id-it 15}
  OrigPKIMessageValue ::= PKIMessages
</pre><a href="#section-5.1.1.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.1.1.4">
<section id="section-5.1.1.4">
            <h5 id="name-certprofile">
<a href="#section-5.1.1.4" class="section-number selfRef">5.1.1.4. </a><a href="#name-certprofile" class="section-name selfRef">CertProfile</a>
            </h5>
<p id="section-5.1.1.4-1">This is used by the EE to indicate specific certificate profiles, e.g., when
requesting a new certificate or a certificate request template; see <a href="#sect-5.3.19.16" class="auto internal xref">Section 5.3.19.16</a>.<a href="#section-5.1.1.4-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.1.4-2">
<pre>
  id-it-certProfile OBJECT IDENTIFIER ::= {id-it 21}
  CertProfileValue ::= SEQUENCE SIZE (1..MAX) OF UTF8String
</pre><a href="#section-5.1.1.4-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1.4-3">When used in a p10cr message, the CertProfileValue sequence <span class="bcp14">MUST NOT</span> contain multiple certificate profile names. When used in an ir/cr/kur/genm message, the CertProfileValue sequence <span class="bcp14">MUST NOT</span> contain more certificate profile names than the number of CertReqMsg or GenMsgContent InfoTypeAndValue elements contained in the message body.<a href="#section-5.1.1.4-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1.4-4">The certificate profile names in the CertProfileValue sequence relate to the CertReqMsg or GenMsgContent InfoTypeAndValue elements in the given order. An empty string means no certificate profile name is associated with the respective CertReqMsg or GenMsgContent InfoTypeAndValue element. If the CertProfileValue sequence contains less certificate profile entries than CertReqMsg or GenMsgContent InfoTypeAndValue elements, the remaining CertReqMsg or GenMsgContent InfoTypeAndValue elements have no profile name associated with them.<a href="#section-5.1.1.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.1.5">
<section id="section-5.1.1.5">
            <h5 id="name-kemciphertextinfo">
<a href="#section-5.1.1.5" class="section-number selfRef">5.1.1.5. </a><a href="#name-kemciphertextinfo" class="section-name selfRef">KemCiphertextInfo</a>
            </h5>
<p id="section-5.1.1.5-1">A PKI entity <span class="bcp14">MAY</span> provide the KEM ciphertext for MAC-based message protection using KEM (see Section 5.1.3.4) in the generalInfo field of a request message to a PKI management entity if it knows that the PKI management entity uses a KEM key pair and has its public key.<a href="#section-5.1.1.5-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.1.5-2">
<pre>
  id-it-KemCiphertextInfo OBJECT IDENTIFIER ::= { id-it TBD1 }
  KemCiphertextInfoValue ::= KemCiphertextInfo
</pre><a href="#section-5.1.1.5-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.1.5-3">For more details of KEM-based message protection see <a href="#sect-5.1.3.4" class="auto internal xref">Section 5.1.3.4</a>. See <a href="#sect-5.3.19.18" class="auto internal xref">Section 5.3.19.18</a> for the definition of {id-it TBD1}.<a href="#section-5.1.1.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5.1.2">
<section id="section-5.1.2">
          <h4 id="name-pki-message-body">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-pki-message-body" class="section-name selfRef">PKI Message Body</a>
          </h4>
<div class="lang-asn.1 sourcecode" id="section-5.1.2-1">
<pre>
  PKIBody ::= CHOICE {
     ir       [0]  CertReqMessages,        --Initialization Req
     ip       [1]  CertRepMessage,         --Initialization Resp
     cr       [2]  CertReqMessages,        --Certification Req
     cp       [3]  CertRepMessage,         --Certification Resp
     p10cr    [4]  CertificationRequest,   --PKCS #10 Cert.  Req.
     popdecc  [5]  POPODecKeyChallContent, --pop Challenge
     popdecr  [6]  POPODecKeyRespContent,  --pop Response
     kur      [7]  CertReqMessages,        --Key Update Request
     kup      [8]  CertRepMessage,         --Key Update Response
     krr      [9]  CertReqMessages,        --Key Recovery Req
     krp      [10] KeyRecRepContent,       --Key Recovery Resp
     rr       [11] RevReqContent,          --Revocation Request
     rp       [12] RevRepContent,          --Revocation Response
     ccr      [13] CertReqMessages,        --Cross-Cert.  Request
     ccp      [14] CertRepMessage,         --Cross-Cert.  Resp
     ckuann   [15] CAKeyUpdContent,        --CA Key Update Ann.
     cann     [16] CertAnnContent,         --Certificate Ann.
     rann     [17] RevAnnContent,          --Revocation Ann.
     crlann   [18] CRLAnnContent,          --CRL Announcement
     pkiconf  [19] PKIConfirmContent,      --Confirmation
     nested   [20] NestedMessageContent,   --Nested Message
     genm     [21] GenMsgContent,          --General Message
     genp     [22] GenRepContent,          --General Response
     error    [23] ErrorMsgContent,        --Error Message
     certConf [24] CertConfirmContent,     --Certificate Confirm
     pollReq  [25] PollReqContent,         --Polling Request
     pollRep  [26] PollRepContent          --Polling Response
  }
</pre><a href="#section-5.1.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1.2-2">The specific types are described in <a href="#sect-5.3" class="auto internal xref">Section 5.3</a> below.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.3">
<section id="section-5.1.3">
          <h4 id="name-pki-message-protection">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-pki-message-protection" class="section-name selfRef">PKI Message Protection</a>
          </h4>
<p id="section-5.1.3-1">Some PKI messages will be protected for integrity.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3-2">Note: If an asymmetric algorithm is used to protect a message and the relevant
public component has been certified already, then the origin of the
message can also be authenticated.  On the other hand, if the public
component is uncertified, then the message origin cannot be
automatically authenticated, but may be authenticated via out-of-band
means.<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
<p id="section-5.1.3-3">When protection is applied, the following structure is used:<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3-4">
<pre>
  PKIProtection ::= BIT STRING
</pre><a href="#section-5.1.3-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3-5">The input to the calculation of PKIProtection is the DER encoding of
the following data structure:<a href="#section-5.1.3-5" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3-6">
<pre>
  ProtectedPart ::= SEQUENCE {
     header    PKIHeader,
     body      PKIBody
  }
</pre><a href="#section-5.1.3-6" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3-7">There <span class="bcp14">MAY</span> be cases in which the PKIProtection BIT STRING is
deliberately not used to protect a message (i.e., this <span class="bcp14">OPTIONAL</span> field
is omitted) because other protection, external to PKIX, will be
applied instead.  Such a choice is explicitly allowed in this
specification.  Examples of such external protection include CMS <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> and Security Multiparts <span>[<a href="#RFC1847" class="cite xref">RFC1847</a>]</span> encapsulation of the
PKIMessage (or simply the PKIBody (omitting the CHOICE tag), if the
relevant PKIHeader information is securely carried in the external
mechanism).  It is noted, however, that many such external mechanisms
require that the end entity already possesses a public-key
certificate, and/or a unique Distinguished Name, and/or other such
infrastructure-related information.  Thus, they may not be
appropriate for initial registration, key-recovery, or any other
process with "boot-strapping" characteristics.  For those cases it
may be necessary that the PKIProtection parameter be used.  In the
future, if/when external mechanisms are modified to accommodate
boot-strapping scenarios, the use of PKIProtection may become rare or
non-existent.<a href="#section-5.1.3-7" class="pilcrow">¶</a></p>
<p id="section-5.1.3-8">Depending on the circumstances, the PKIProtection bits may contain a
Message Authentication Code (MAC) or signature.  Only the following
cases can occur:<a href="#section-5.1.3-8" class="pilcrow">¶</a></p>
<div id="sect-5.1.3.1">
<section id="section-5.1.3.1">
            <h5 id="name-shared-secret-information">
<a href="#section-5.1.3.1" class="section-number selfRef">5.1.3.1. </a><a href="#name-shared-secret-information" class="section-name selfRef">Shared Secret Information</a>
            </h5>
<p id="section-5.1.3.1-1">In this case, the sender and recipient share secret information with sufficient
entropy (established via out-of-band means). PKIProtection will contain a
MAC value and the protectionAlg <span class="bcp14">MAY</span> be one of the options described in CMP
Algorithms Section 6.1 <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>.<a href="#section-5.1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3.1-2">The algorithm identifier id-PasswordBasedMac is defined in Section 4.4 of <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> and updated by <span>[<a href="#RFC9045" class="cite xref">RFC9045</a>]</span>. It is mentioned in Section 6.1.1 of <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span> for backward compatibility. More modern alternatives are listed in Section 6.1 of <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>.<a href="#section-5.1.3.1-2" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.1-3">
<pre>
  id-PasswordBasedMac OBJECT IDENTIFIER ::= {1 2 840 113533 7 66 13}
  PBMParameter ::= SEQUENCE {
     salt                OCTET STRING,
     owf                 AlgorithmIdentifier,
     iterationCount      INTEGER,
     mac                 AlgorithmIdentifier
  }
</pre><a href="#section-5.1.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3.1-4">The following text gives a method of key expansion to be used when the MAC-algorithm requires an input length that is larger than the size of the one-way-function.<a href="#section-5.1.3.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1.3.1-5">Note: Section 4.4 of <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> and <span>[<a href="#RFC9045" class="cite xref">RFC9045</a>]</span> do not mention this key expansion method and gives an example using HMAC algorithms where key expansion is not needed. It is recognized that this omission in <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> can lead to confusion and possible incompatibility if <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span> key expansion is not used when needed. Therefore, when key expansion is required (when K &gt; H) the key expansion defined in the following text <span class="bcp14">MUST</span> be used.<a href="#section-5.1.3.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1.3.1-6">In the above protectionAlg, the salt value is appended to the shared
secret input. The OWF is then applied iterationCount times, where the
salted secret is the input to the first iteration and, for each
successive iteration, the input is set to be the output of the
previous iteration. The output of the final iteration (called
"BASEKEY" for ease of reference, with a size of "H") is what is used
to form the symmetric key. If the MAC algorithm requires a K-bit key
and K &lt;= H, then the most significant K bits of BASEKEY are used. If
K &gt; H, then all of BASEKEY is used for the most significant H bits of
the key, OWF("1" || BASEKEY) is used for the next most significant H
bits of the key, OWF("2" || BASEKEY) is used for the next most
significant H bits of the key, and so on, until all K bits have been
derived. [Here "N" is the ASCII byte encoding the number N and "||"
represents concatenation.]<a href="#section-5.1.3.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1.3.1-7">Note: It is <span class="bcp14">RECOMMENDED</span> that the fields of PBMParameter remain
constant throughout the messages of a single transaction (e.g.,
ir/ip/certConf/pkiConf) to reduce the overhead associated with
PasswordBasedMac computation.<a href="#section-5.1.3.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.3.2">
<section id="section-5.1.3.2">
            <h5 id="name-dh-key-pairs">
<a href="#section-5.1.3.2" class="section-number selfRef">5.1.3.2. </a><a href="#name-dh-key-pairs" class="section-name selfRef">DH Key Pairs</a>
            </h5>
<p id="section-5.1.3.2-1">Where the sender and receiver possess finite-field or elliptic-curve-based
Diffie-Hellman certificates
with compatible DH parameters, in order to protect the message the
end entity must generate a symmetric key based on its private DH key
value and the DH public key of the recipient of the PKI message.
PKIProtection will contain a MAC value keyed with this derived
symmetric key and the protectionAlg will be the following:<a href="#section-5.1.3.2-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.2-2">
<pre>
  id-DHBasedMac OBJECT IDENTIFIER ::= {1 2 840 113533 7 66 30}

  DHBMParameter ::= SEQUENCE {
     owf                 AlgorithmIdentifier,
     -- AlgId for a One-Way Function
     mac                 AlgorithmIdentifier
     -- the MAC AlgId
  }
</pre><a href="#section-5.1.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3.2-3">In the above protectionAlg, OWF is applied to the result of the
Diffie-Hellman computation.  The OWF output (called "BASEKEY" for
ease of reference, with a size of "H") is what is used to form the
symmetric key.  If the MAC algorithm requires a K-bit key and K &lt;= H, then
the most significant K bits of BASEKEY are used.  If K &gt; H, then
all of BASEKEY is used for the most significant H bits of the key,
OWF("1" || BASEKEY) is used for the next most significant H bits of
the key, OWF("2" || BASEKEY) is used for the next most significant H
bits of the key, and so on, until all K bits have been derived.
[Here "N" is the ASCII byte encoding the number N and "||" represents concatenation.]<a href="#section-5.1.3.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.3.2-4">Note: Hash algorithms that can be used as one-way functions are listed in
CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span> Section 2.<a href="#section-5.1.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.3.3">
<section id="section-5.1.3.3">
            <h5 id="name-signature">
<a href="#section-5.1.3.3" class="section-number selfRef">5.1.3.3. </a><a href="#name-signature" class="section-name selfRef">Signature</a>
            </h5>
<p id="section-5.1.3.3-1">In this case, the sender possesses a signature key pair and simply
signs the PKI message.  PKIProtection will contain the signature
value and the protectionAlg will be an AlgorithmIdentifier for a
digital signature <span class="bcp14">MAY</span> be one of the options described in CMP Algorithms Section
3 <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>.<a href="#section-5.1.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.3.4">
<section id="section-5.1.3.4">
            <h5 id="name-key-encapsulation">
<a href="#section-5.1.3.4" class="section-number selfRef">5.1.3.4. </a><a href="#name-key-encapsulation" class="section-name selfRef">Key Encapsulation</a>
            </h5>
<p id="section-5.1.3.4-1">In case the sender of a message has a Key Encapsulation Mechanism (KEM) key pair, it can be used to establish a shared secret key for MAC-based message protection. This can be used for message authentication.<a href="#section-5.1.3.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-2">This approach uses the definition of Key Encapsulation Mechanism (KEM) algorithm functions in Section 1 of <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span> as follows:<a href="#section-5.1.3.4-2" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-3">A KEM algorithm provides three functions:<a href="#section-5.1.3.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3.4-4.1">
                <p id="section-5.1.3.4-4.1.1">KeyGen() -&gt; (pk, sk):<a href="#section-5.1.3.4-4.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1.3.4-5.1">
                <p id="section-5.1.3.4-5.1.1">Generate a public key (pk) and a private (secret) key (sk).<a href="#section-5.1.3.4-5.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal">
<li class="normal" id="section-5.1.3.4-6.1">
                <p id="section-5.1.3.4-6.1.1">Encapsulate(pk) -&gt; (ct, ss):<a href="#section-5.1.3.4-6.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1.3.4-7.1">
                <p id="section-5.1.3.4-7.1.1">Given the public key (pk), produce a ciphertext (ct) and a
shared secret (ss).<a href="#section-5.1.3.4-7.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal">
<li class="normal" id="section-5.1.3.4-8.1">
                <p id="section-5.1.3.4-8.1.1">Decapsulate(sk, ct) -&gt; (ss):<a href="#section-5.1.3.4-8.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1.3.4-9.1">
                <p id="section-5.1.3.4-9.1.1">Given the private key (sk) and the ciphertext (ct), produce the
shared secret (ss).<a href="#section-5.1.3.4-9.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.1.3.4-10">To support a particular KEM algorithm, the PKI entity that possesses a KEM key pair and wishes to use it for MAC-based message protection <span class="bcp14">MUST</span> support the KEM Decapsulate() function. The PKI entity that wishes to verify the MAC-based message protection <span class="bcp14">MUST</span> support the KEM Encapsulate() function. The respective public KEM key is usually carried in a certificate <span>[<a href="#I-D.ietf-lamps-kyber-certificates" class="cite xref">I-D.ietf-lamps-kyber-certificates</a>]</span>.<a href="#section-5.1.3.4-10" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-11">Note: Both PKI entities send and receive messages in a PKI management operation. Both PKI entities may independently wish to protect messages using their KEM key pairs. For ease of explanation we use the term "Alice" to denote the PKI entity possessing the KEM key pair and who wishes to provide MAC-based message protection, and "Bob" to denote the PKI entity having Alice’s authentic public KEM key and who needs to verify the MAC-based protection provided by Alice.<a href="#section-5.1.3.4-11" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-12">Assuming Bob has Alice's KEM public key, he generates the ciphertext using KEM encapsulation and transfers it to Alice in an InfoTypeAndValue structure. Alice then retrieves the KEM shared secret from the ciphertext using KEM decapsulation and the associated KEM private key. Using a key derivation function (KDF), she derives a shared secret key from the KEM shared secret and other data sent by Bob. PKIProtection will contain a MAC value calculated using that shared secret key, and the protectionAlg will be the following:<a href="#section-5.1.3.4-12" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.4-13">
<pre>
  id-KemBasedMac OBJECT IDENTIFIER ::= {1 2 840 113533 7 66 16}

  KemBMParameter ::= SEQUENCE {
    kdf              AlgorithmIdentifier{KEY-DERIVATION, {...}},
    kemContext   [0] OCTET STRING OPTIONAL,
    len              INTEGER (1..MAX),
    mac              AlgorithmIdentifier{MAC-ALGORITHM, {...}}
  }
</pre><a href="#section-5.1.3.4-13" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3.4-14">Note: The OID for id-KemBasedMac was assigned on the private-use arc { iso(1) member-body(2) us(840) nortelnetworks(113533) entrust(7) }, and not assigned on an IANA-owned arc because the authors wished to placed it on the same branch as the existing OIDs for id-PasswordBasedMac and id-DHBasedMac.<a href="#section-5.1.3.4-14" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-15">kdf is the algorithm identifier of the chosen KDF, and any associated parameters, used to derive the shared secret key.<a href="#section-5.1.3.4-15" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-16">kemContext <span class="bcp14">MAY</span> be used to transfer additional algorithm specific context information, see also the definition of ukm in <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>, Section 3.<a href="#section-5.1.3.4-16" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-17">len is the output length of the KDF and <span class="bcp14">MUST</span> be the desired size of the key to be used for MAC-based message protection.<a href="#section-5.1.3.4-17" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-18">mac is the algorithm identifier of the chosen MAC algorithm, and any associated parameters, used to calculate the MAC value.<a href="#section-5.1.3.4-18" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-19">The KDF and MAC algorithms <span class="bcp14">MAY</span> be chosen from the options in CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>.<a href="#section-5.1.3.4-19" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-20">The InfoTypeAndValue transferring the KEM ciphertext uses OID id-it-KemCiphertextInfo. It contains a KemCiphertextInfo structure as defined in <a href="#sect-5.3.19.18" class="auto internal xref">Section 5.3.19.18</a>.<a href="#section-5.1.3.4-20" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-21">Note: This InfoTypeAndValue can be carried in a genm/genp message body as specified in <a href="#sect-5.3.19.18" class="auto internal xref">Section 5.3.19.18</a> or in the generalInfo field of PKIHeader in messages of other types, see <a href="#sect-5.1.1.5" class="auto internal xref">Section 5.1.1.5</a>.<a href="#section-5.1.3.4-21" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-22">In the following, a generic message flow for MAC-based protection using KEM is specified in more detail. It is assumed that Bob possesses the public KEM key of Alice. Alice can be the initiator of a PKI management operation or the responder. For more detailed figures see <a href="#sect-e" class="auto internal xref">Appendix E</a>.<a href="#section-5.1.3.4-22" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-23">Generic Message Flow:<a href="#section-5.1.3.4-23" class="pilcrow">¶</a></p>
<span id="name-generic-message-flow-when-a"></span><div id="KEM">
<figure id="figure-2">
              <div id="section-5.1.3.4-24.1">
                <div class="alignLeft art-svg artwork" id="section-5.1.3.4-24.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="240" width="560" viewBox="0 0 560 240" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 8,48 L 552,48" fill="none" stroke="black"></path>
                    <path d="M 8,224 L 152,224" fill="none" stroke="black"></path>
                    <path d="M 400,224 L 552,224" fill="none" stroke="black"></path>
                    <g class="text">
                      <text x="24" y="36">Step#</text>
                      <text x="72" y="36">Alice</text>
                      <text x="360" y="36">Bob</text>
                      <text x="24" y="68">1</text>
                      <text x="376" y="68">perform</text>
                      <text x="424" y="68">KEM</text>
                      <text x="488" y="68">Encapsulate</text>
                      <text x="196" y="84">&lt;-</text>
                      <text x="224" y="84">KEM</text>
                      <text x="284" y="84">Ciphertext</text>
                      <text x="340" y="84">&lt;-</text>
                      <text x="24" y="100">2</text>
                      <text x="80" y="100">perform</text>
                      <text x="128" y="100">KEM</text>
                      <text x="196" y="100">Decapsulate,</text>
                      <text x="96" y="116">perform</text>
                      <text x="144" y="116">key</text>
                      <text x="208" y="116">derivation,</text>
                      <text x="92" y="132">format</text>
                      <text x="152" y="132">message</text>
                      <text x="204" y="132">with</text>
                      <text x="104" y="148">MAC-based</text>
                      <text x="188" y="148">protection</text>
                      <text x="196" y="164">-&gt;</text>
                      <text x="264" y="164">message</text>
                      <text x="340" y="164">-&gt;</text>
                      <text x="24" y="180">3</text>
                      <text x="376" y="180">perform</text>
                      <text x="424" y="180">key</text>
                      <text x="488" y="180">derivation,</text>
                      <text x="388" y="196">verify</text>
                      <text x="456" y="196">MAC-based</text>
                      <text x="404" y="212">protection</text>
                      <text x="192" y="228">Alice</text>
                      <text x="272" y="228">authenticated</text>
                      <text x="340" y="228">by</text>
                      <text x="368" y="228">Bob</text>
                    </g>
                  </svg><a href="#section-5.1.3.4-24.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-generic-message-flow-when-a" class="selfRef">Generic Message Flow when Alice has a KEM key pair</a>
              </figcaption></figure>
</div>
<ol start="1" type="1" class="normal type-1" id="section-5.1.3.4-25">
<li id="section-5.1.3.4-25.1">
                <p id="section-5.1.3.4-25.1.1">Bob needs to possess the authentic public KEM key pk of Alice, for instance contained in a KEM certificate that was received and successfully validated by Bob beforehand.<a href="#section-5.1.3.4-25.1.1" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-25.1.2">
Bob generates a shared secret ss and the associated ciphertext ct using the KEM Encapsulate function with Alice's public KEM key pk. Bob <span class="bcp14">MUST NOT</span> reuse the ss and ct for other PKI management operations. From this data, Bob produces a KemCiphertextInfo structure including the KEM algorithm identifier and the ciphertext ct and sends it to Alice in an InfoTypeAndValue structure as defined in <a href="#sect-5.3.19.18" class="auto internal xref">Section 5.3.19.18</a>.<a href="#section-5.1.3.4-25.1.2" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.4-25.1.3">
<pre>
   Encapsulate(pk) -&gt; (ct, ss)
</pre><a href="#section-5.1.3.4-25.1.3" class="pilcrow">¶</a>
</div>
</li>
              <li id="section-5.1.3.4-25.2">
                <p id="section-5.1.3.4-25.2.1">Alice decapsulates the shared secret ss from the ciphertext ct using the KEM Decapsulate function and its private KEM key sk.<a href="#section-5.1.3.4-25.2.1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.4-25.2.2">
<pre>
   Decapsulate(ct, sk) -&gt; (ss)
</pre><a href="#section-5.1.3.4-25.2.2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3.4-25.2.3">
If the decapsulation operation outputs an error, any failInfo field in an error response message  <span class="bcp14">SHALL</span> contain the value badMessageCheck and the PKI management operation <span class="bcp14">SHALL</span> be terminated.<a href="#section-5.1.3.4-25.2.3" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-25.2.4">
Alice derives the shared secret key ssk using a KDF. The shared secret ss is used as input key material for the KDF, the value len is the desired output length of the KDF as required by the MAC algorithm to be used for message protection. KDF, len, and MAC will be transferred to Bob in the protectionAlg KemBMParameter. The DER-encoded KemOtherInfo structure, as defined below, is used as context for the KDF.<a href="#section-5.1.3.4-25.2.4" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.4-25.2.5">
<pre>
   KDF(ss, len, context)-&gt;(ssk)
</pre><a href="#section-5.1.3.4-25.2.5" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3.4-25.2.6">
The shared secret key ssk is used for MAC-based protection by Alice.<a href="#section-5.1.3.4-25.2.6" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.1.3.4-25.3">
                <p id="section-5.1.3.4-25.3.1">Bob derives the same shared secret key ssk using the KDF. Also here the shared secret ss is used as input key material for the KDF, the value len is the desired output length for the KDF, and the DER-encoded KemOtherInfo structure constructed in the same way as on Alice's side is used as context for the KDF.<a href="#section-5.1.3.4-25.3.1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.4-25.3.2">
<pre>
   KDF(ss, len, context)-&gt;(ssk)
</pre><a href="#section-5.1.3.4-25.3.2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3.4-25.3.3">
Bob uses the shared secret key ssk for verifying the MAC-based protection of the message received and in this way authenticates Alice.<a href="#section-5.1.3.4-25.3.3" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-5.1.3.4-26">This shared secret key ssk can be reused by Alice for MAC-based protection of further messages sent to Bob within the current PKI management operation.<a href="#section-5.1.3.4-26" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-27">This approach employs the notation of KDF(IKM, L, info) as described in <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>], <a href="https://rfc-editor.org/rfc/rfc9629#section-5" class="relref">Section 5</a></span> with the following changes:<a href="#section-5.1.3.4-27" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3.4-28.1">
                <p id="section-5.1.3.4-28.1.1">IKM is the input key material. It is the symmetric secret called ss resulting from the key encapsulation mechanism.<a href="#section-5.1.3.4-28.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.3.4-28.2">
                <p id="section-5.1.3.4-28.2.1">L is dependent of the MAC algorithm that is used with the shared secret key for CMP message protection and is called len in this document.<a href="#section-5.1.3.4-28.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.3.4-28.3">
                <p id="section-5.1.3.4-28.3.1">info is an additional input to the KDF, is called context in this document, and contains the DER-encoded KemOtherInfo structure defined as:<a href="#section-5.1.3.4-28.3.1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.4-28.3.2">
<pre>
  KemOtherInfo ::= SEQUENCE {
    staticString      PKIFreeText,
    transactionID     OCTET STRING,
    kemContext    [0] OCTET STRING OPTIONAL
  }
</pre><a href="#section-5.1.3.4-28.3.2" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3.4-28.3.3">
staticString <span class="bcp14">MUST</span> be "CMP-KEM".<a href="#section-5.1.3.4-28.3.3" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-28.3.4">
transactionID <span class="bcp14">MUST</span> be the value from the message containing the ciphertext ct in KemCiphertextInfo.<a href="#section-5.1.3.4-28.3.4" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-28.3.5">
Note: The transactionID is used to ensure domain separation of the derived shared secret key between different PKI management operations. For all PKI management operations with more than one exchange the transactionID <span class="bcp14">MUST</span> be set anyway, see <a href="#sect-5.1.1" class="auto internal xref">Section 5.1.1</a>. In case Bob provided a infoValue of type KemCiphertextInfo to Alice in the initial request message, see <a href="#KEM-Flow2" class="auto internal xref">Figure 4</a> of <a href="#sect-e" class="auto internal xref">Appendix E</a>, the transactionID <span class="bcp14">MUST</span> be set by Bob.<a href="#section-5.1.3.4-28.3.5" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-28.3.6">
kemContext <span class="bcp14">MAY</span> contain additional algorithm specific context information.<a href="#section-5.1.3.4-28.3.6" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.3.4-28.4">
                <p id="section-5.1.3.4-28.4.1">OKM is the output keying material of the KDF used for MAC-based message protection of length len and is called ssk in this document.<a href="#section-5.1.3.4-28.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.1.3.4-29">There are various ways how Alice can request, and Bob can provide the KEM ciphertext, see <a href="#sect-e" class="auto internal xref">Appendix E</a> for details. The KemCiphertextInfo can be requested using PKI general messages as described in <a href="#sect-5.3.19.18" class="auto internal xref">Section 5.3.19.18</a>. Alternatively, the generalInfo field of the PKIHeader can be used to convey the same request and response InfoTypeAndValue structures as described in <a href="#sect-5.1.1.5" class="auto internal xref">Section 5.1.1.5</a>. The procedure works also without Alice explicitly requesting the KEM ciphertext in case Bob knows a KEM key of Alice beforehand and can expect that she is ready to use it.<a href="#section-5.1.3.4-29" class="pilcrow">¶</a></p>
<p id="section-5.1.3.4-30">If both the initiator and responder in a PKI management operation have KEM key pairs, this procedure can be applied by both entities independently, establishing and using different shared secret keys for either direction.<a href="#section-5.1.3.4-30" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.1.3.5">
<section id="section-5.1.3.5">
            <h5 id="name-multiple-protection">
<a href="#section-5.1.3.5" class="section-number selfRef">5.1.3.5. </a><a href="#name-multiple-protection" class="section-name selfRef">Multiple Protection</a>
            </h5>
<p id="section-5.1.3.5-1">When receiving a protected PKI message, a PKI management entity, such as an
RA, <span class="bcp14">MAY</span> forward that message adding its own protection.  Additionally, multiple
PKI messages <span class="bcp14">MAY</span> be aggregated.  There are several use cases for such messages.<a href="#section-5.1.3.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1.3.5-2.1">
                <p id="section-5.1.3.5-2.1.1">The RA confirms having validated and authorized a message and forwards the
original message unchanged.<a href="#section-5.1.3.5-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-5.1.3.5-2.2">
                <p id="section-5.1.3.5-2.2.1">A PKI management entity collects several messages that are to be forwarded
in the same direction and forwards them in a batch. Request messages can
be transferred as batch upstream (towards the CA); response or announce messages
can be transferred as batch downstream (towards an RA but not to the EE).
For instance, this can be used when bridging an off-line connection between
two PKI management entities.<a href="#section-5.1.3.5-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-5.1.3.5-3">These use cases are accomplished by nesting the messages within a new PKI
message.  The structure used is as follows:<a href="#section-5.1.3.5-3" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.1.3.5-4">
<pre>
  NestedMessageContent ::= PKIMessages
</pre><a href="#section-5.1.3.5-4" class="pilcrow">¶</a>
</div>
<p id="section-5.1.3.5-5">In case an RA needs to modify a request message, it <span class="bcp14">MAY</span> include the original
PKIMessage in the generalInfo field of the modified message as described in
<a href="#sect-5.1.1.3" class="auto internal xref">Section 5.1.1.3</a>.<a href="#section-5.1.3.5-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-5.2">
<section id="section-5.2">
        <h3 id="name-common-data-structures">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-common-data-structures" class="section-name selfRef">Common Data Structures</a>
        </h3>
<p id="section-5.2-1">Before specifying the specific types that may be placed in a PKIBody,
we define some data structures that are used in more than one case.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="sect-5.2.1">
<section id="section-5.2.1">
          <h4 id="name-requested-certificate-conte">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-requested-certificate-conte" class="section-name selfRef">Requested Certificate Contents</a>
          </h4>
<p id="section-5.2.1-1">Various PKI management messages require that the originator of the
message indicate some of the fields that are required to be present
in a certificate.  The CertTemplate structure allows an end entity or
RA to specify as much as it wishes about the certificate it requires.
CertTemplate is identical to a Certificate, but with all fields
optional.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">Note: Even if the originator completely specifies the contents of
a certificate it requires, a CA is free to modify fields within the
certificate actually issued.  If the modified certificate is
unacceptable to the requester, the requester <span class="bcp14">MUST</span> send back a
certConf message that either does not include this certificate (via a
CertHash), or does include this certificate (via a CertHash) along
with a status of "rejected".  See <a href="#sect-5.3.18" class="auto internal xref">Section 5.3.18</a> for the definition
and use of CertHash and the certConf message.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.1-3">Note: Before requesting a new certificate, an end entity can request a certTemplate
structure as a kind of certificate request blueprint, in order to learn which
data the CA expects to be present in the certificate request, see <a href="#sect-5.3.19.16" class="auto internal xref">Section 5.3.19.16</a>.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">See <span><a href="#RFC4211" class="internal xref">CRMF</a> [<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for CertTemplate syntax.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1-5">If certTemplate is an empty SEQUENCE (i.e., all fields omitted), then the
controls field in the CertRequest structure <span class="bcp14">MAY</span> contain the id-regCtrl-altCertTemplate
control, specifying a template for a certificate other than an X.509v3 public-key
certificate.  Conversely, if certTemplate is not empty (i.e., at least one
field is present), then controls <span class="bcp14">MUST NOT</span> contain id-regCtrl-altCertTemplate.
The new control is defined as follows:<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.1-6">
<pre>
  id-regCtrl-altCertTemplate OBJECT IDENTIFIER ::= { iso(1)
     identified-organization(3) dod(6) internet(1) security(5)
     mechanisms(5) pkix(7) pkip(5) regCtrl(1) 7}

  AltCertTemplate ::= AttributeTypeAndValue
</pre><a href="#section-5.2.1-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2.1-7">See also <span>[<a href="#RFC4212" class="cite xref">RFC4212</a>]</span> for more details on how to manage certificates in alternative formats using CRMF <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> syntax.<a href="#section-5.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.2">
<section id="section-5.2.2">
          <h4 id="name-encrypted-values">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-encrypted-values" class="section-name selfRef">Encrypted Values</a>
          </h4>
<p id="section-5.2.2-1">When encrypted data like a private key, certificate, POP challenge, or revocation passphrase is sent in PKI messages it is <span class="bcp14">RECOMMENDED</span> to use the EnvelopedData structure.  In some cases this is accomplished by using the EncryptedKey data structure instead of EncryptedValue.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.2-2">
<pre>
  EncryptedKey ::= CHOICE {
     encryptedValue       EncryptedValue, -- deprecated
     envelopedData    [0] EnvelopedData }
</pre><a href="#section-5.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.2-3">See Certificate Request Message Format (CRMF) <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for EncryptedKey and EncryptedValue syntax and Cryptographic Message
   Syntax (CMS) <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> for EnvelopedData syntax. Using the EncryptedKey data structure offers the
choice to either use EncryptedValue (for backward compatibility only) or
EnvelopedData.  The use of the EncryptedValue structure has been deprecated
in favor of the EnvelopedData structure.  Therefore, it is <span class="bcp14">RECOMMENDED</span> to
use EnvelopedData.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2-4">Note: The EncryptedKey structure defined in <span><a href="#RFC4211" class="internal xref">CRMF</a> [<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> is used here, which makes the update backward compatible. Using the new syntax
with the untagged default choice EncryptedValue is bits-on-the-wire compatible
with the old syntax.<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.2-5">To indicate support for EnvelopedData, the pvno cmp2021 has been introduced.
Details on the usage of the protocol version number (pvno) are described in <a href="#sect-7" class="auto internal xref">Section 7</a>.<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2.2-6">The EnvelopedData structure is <span class="bcp14">RECOMMENDED</span> to use in CMP to transport a private key,
certificate, POP challenge, or revocation passphrase in encrypted form as follows:<a href="#section-5.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-7.1">
              <p id="section-5.2.2-7.1.1">It contains only one RecipientInfo structure because the content is encrypted
only for one recipient.<a href="#section-5.2.2-7.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-7.2">
              <p id="section-5.2.2-7.2.1">It may contain a private key in the AsymmetricKeyPackage structure (which is placed in the encryptedContentInfo field), as defined
in <span>[<a href="#RFC5958" class="cite xref">RFC5958</a>]</span>, that is wrapped in a SignedData structure, as specified in
Section 5 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> and <span>[<a href="#RFC8933" class="cite xref">RFC8933</a>]</span>, signed by the Key Generation Authority or CA.<a href="#section-5.2.2-7.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-7.3">
              <p id="section-5.2.2-7.3.1">It may contain a certificate, POP challenge, or revocation passphrase directly in the encryptedContent
field.<a href="#section-5.2.2-7.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.2.2-8">The content of the EnvelopedData structure, as specified in Section 6 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>,
<span class="bcp14">MUST</span> be encrypted using a newly generated symmetric content-encryption
key. This content-encryption key <span class="bcp14">MUST</span> be securely provided to the recipient
using one of four key management techniques.<a href="#section-5.2.2-8" class="pilcrow">¶</a></p>
<p id="section-5.2.2-9">The choice of the key management technique to be used by the sender depends
on the credential available at the recipient:<a href="#section-5.2.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-10.1">
              <p id="section-5.2.2-10.1.1">recipient's certificate with an algorithm identifier and a public key that supports key transport and where any given key usage extension allows keyEncipherment:
The content-encryption key will be protected using the key transport key management technique, as specified in Section 6.2.1 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>.<a href="#section-5.2.2-10.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-10.2">
              <p id="section-5.2.2-10.2.1">recipient's certificate with an algorithm identifier and a public key that supports key agreement and where any given key usage extension allows keyAgreement:
The content-encryption key will be protected using the key agreement key management technique, as specified in Section 6.2.2 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>.<a href="#section-5.2.2-10.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-10.3">
              <p id="section-5.2.2-10.3.1">a password or shared secret: The content-encryption key will be protected
using the password-based key management technique, as specified in
Section 6.2.4 of <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>.<a href="#section-5.2.2-10.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.2-10.4">
              <p id="section-5.2.2-10.4.1">recipient's certificate with an algorithm identifier and a public key that supports key encapsulation mechanism and where any given key usage extension allows keyEncipherment: The content-encryption key will be protected using the key management technique for KEM keys, as specified in <span>[<a href="#RFC9629" class="cite xref">RFC9629</a>]</span>.<a href="#section-5.2.2-10.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.2.2-11">Note: There are cases where the algorithm identifier, the type of the public key,
and the key usage extension will not be sufficient to decide on the key management
technique to use, e.g., when rsaEncryption is the algorithm identifier. In
such cases it is a matter of local policy to decide.<a href="#section-5.2.2-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.3">
<section id="section-5.2.3">
          <h4 id="name-status-codes-and-failure-in">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-status-codes-and-failure-in" class="section-name selfRef">Status Codes and Failure Information for PKI Messages</a>
          </h4>
<p id="section-5.2.3-1">All response messages will include some status information.  The
following values are defined.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.3-2">
<pre>
  PKIStatus ::= INTEGER {
     accepted               (0),
     grantedWithMods        (1),
     rejection              (2),
     waiting                (3),
     revocationWarning      (4),
     revocationNotification (5),
     keyUpdateWarning       (6)
  }
</pre><a href="#section-5.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.3-3">Responders may use the following syntax to provide more information
about failure cases.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.3-4">
<pre>
  PKIFailureInfo ::= BIT STRING {
     badAlg                 (0),
     badMessageCheck        (1),
     badRequest             (2),
     badTime                (3),
     badCertId              (4),
     badDataFormat          (5),
     wrongAuthority         (6),
     incorrectData          (7),
     missingTimeStamp       (8),
     badPOP                 (9),
     certRevoked            (10),
     certConfirmed          (11),
     wrongIntegrity         (12),
     badRecipientNonce      (13),
     timeNotAvailable       (14),
     unacceptedPolicy       (15),
     unacceptedExtension    (16),
     addInfoNotAvailable    (17),
     badSenderNonce         (18),
     badCertTemplate        (19),
     signerNotTrusted       (20),
     transactionIdInUse     (21),
     unsupportedVersion     (22),
     notAuthorized          (23),
     systemUnavail          (24),
     systemFailure          (25),
     duplicateCertReq       (26)
  }

  PKIStatusInfo ::= SEQUENCE {
     status        PKIStatus,
     statusString  PKIFreeText     OPTIONAL,
     failInfo      PKIFailureInfo  OPTIONAL
  }
</pre><a href="#section-5.2.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.2.4">
<section id="section-5.2.4">
          <h4 id="name-certificate-identification">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-certificate-identification" class="section-name selfRef">Certificate Identification</a>
          </h4>
<p id="section-5.2.4-1">In order to identify particular certificates, the CertId data
structure is used.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">See <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for CertId syntax.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.5">
<section id="section-5.2.5">
          <h4 id="name-out-of-band-root-ca-public-">
<a href="#section-5.2.5" class="section-number selfRef">5.2.5. </a><a href="#name-out-of-band-root-ca-public-" class="section-name selfRef">Out-of-band root CA Public Key</a>
          </h4>
<p id="section-5.2.5-1">Each root CA must be able to publish its current public key via some
"out-of-band" means or together with the respective link certificate using an online mechanism.  While such mechanisms are beyond the scope of
this document, we define data structures that can support such
mechanisms.<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
<p id="section-5.2.5-2">There are generally two methods available: Either the CA directly
publishes its self-signed certificate, or this information is
available via the directory (or equivalent) and the CA publishes a
hash of this value to allow verification of its integrity before use.<a href="#section-5.2.5-2" class="pilcrow">¶</a></p>
<p id="section-5.2.5-3">Note: As an alternative to out-of-band distribution of root CA public keys, the CA can provide the self-signed certificate together with link certificates, e.g., using RootCaKeyUpdateContent (<a href="#sect-5.3.19.15" class="auto internal xref">Section 5.3.19.15</a>).<a href="#section-5.2.5-3" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.5-4">
<pre>
  OOBCert ::= Certificate
</pre><a href="#section-5.2.5-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2.5-5">The fields within this certificate are restricted as follows:<a href="#section-5.2.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.5-6.1">
              <p id="section-5.2.5-6.1.1">The certificate <span class="bcp14">MUST</span> be self-signed (i.e., the signature must be
verifiable using the SubjectPublicKeyInfo field);<a href="#section-5.2.5-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-6.2">
              <p id="section-5.2.5-6.2.1">The subject and issuer fields <span class="bcp14">MUST</span> be identical;<a href="#section-5.2.5-6.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-6.3">
              <p id="section-5.2.5-6.3.1">If the subject field contains a "NULL-DN", then both subjectAltNames and
issuerAltNames extensions <span class="bcp14">MUST</span> be present and have exactly the
same value;<a href="#section-5.2.5-6.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.2.5-6.4">
              <p id="section-5.2.5-6.4.1">The values of all other extensions must be suitable for a self-signed
certificate (e.g., key identifiers for subject and issuer must be the
same).<a href="#section-5.2.5-6.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<div class="lang-asn.1 sourcecode" id="section-5.2.5-7">
<pre>
  OOBCertHash ::= SEQUENCE {
     hashAlg     [0] AlgorithmIdentifier     OPTIONAL,
     certId      [1] CertId                  OPTIONAL,
     hashVal         BIT STRING
  }
</pre><a href="#section-5.2.5-7" class="pilcrow">¶</a>
</div>
<p id="section-5.2.5-8">The intention of the hash value is that anyone who has securely
received the hash value (via the out-of-band means) can verify a
self-signed certificate for that CA.<a href="#section-5.2.5-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.6">
<section id="section-5.2.6">
          <h4 id="name-archive-options">
<a href="#section-5.2.6" class="section-number selfRef">5.2.6. </a><a href="#name-archive-options" class="section-name selfRef">Archive Options</a>
          </h4>
<p id="section-5.2.6-1">Requesters may indicate that they wish the PKI to archive a private
key value using the PKIArchiveOptions structure.<a href="#section-5.2.6-1" class="pilcrow">¶</a></p>
<p id="section-5.2.6-2">See <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for PKIArchiveOptions syntax.<a href="#section-5.2.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.7">
<section id="section-5.2.7">
          <h4 id="name-publication-information">
<a href="#section-5.2.7" class="section-number selfRef">5.2.7. </a><a href="#name-publication-information" class="section-name selfRef">Publication Information</a>
          </h4>
<p id="section-5.2.7-1">Requesters may indicate that they wish the PKI to publish a
certificate using the PKIPublicationInfo structure.<a href="#section-5.2.7-1" class="pilcrow">¶</a></p>
<p id="section-5.2.7-2">See <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for PKIPublicationInfo syntax.<a href="#section-5.2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.8">
<section id="section-5.2.8">
          <h4 id="name-proof-of-possession-structu">
<a href="#section-5.2.8" class="section-number selfRef">5.2.8. </a><a href="#name-proof-of-possession-structu" class="section-name selfRef">Proof-of-Possession Structures</a>
          </h4>
<p id="section-5.2.8-1">The proof-of-possession structure used is indicated in the popo field
of type ProofOfPossession in the CertReqMsg sequence, see Section 4 of <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>.<a href="#section-5.2.8-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.8-2">
<pre>
   ProofOfPossession ::= CHOICE {
      raVerified      [0] NULL,
      signature       [1] POPOSigningKey,
      keyEncipherment [2] POPOPrivKey,
      keyAgreement    [3] POPOPrivKey
   }
</pre><a href="#section-5.2.8-2" class="pilcrow">¶</a>
</div>
<div id="sect-5.2.8.1">
<section id="section-5.2.8.1">
            <h5 id="name-raverified">
<a href="#section-5.2.8.1" class="section-number selfRef">5.2.8.1. </a><a href="#name-raverified" class="section-name selfRef">raVerified</a>
            </h5>
<p id="section-5.2.8.1-1">An EE <span class="bcp14">MUST NOT</span> use raVerified. If an RA performs changes to a certification request breaking the provided proof-of-possession (POP), or if the RA requests a certificate on behalf of an EE and cannot provide the POP itself, the RA <span class="bcp14">MUST</span> use raVerified. Otherwise, it <span class="bcp14">SHOULD NOT</span> use raVerified.<a href="#section-5.2.8.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.8.1-2">When introducing raVerified, the RA <span class="bcp14">MUST</span> check the existing POP, or it <span class="bcp14">MUST</span> ensure by other means that the EE is the holder of the private key. The RA <span class="bcp14">MAY</span> provide the original message containing the POP in the generalInfo field using the id-it-origPKIMessage, see <a href="#sect-5.1.1.3" class="auto internal xref">Section 5.1.1.3</a>, enabling the CA to verify it.<a href="#section-5.2.8.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.8.2">
<section id="section-5.2.8.2">
            <h5 id="name-poposigningkey-structure">
<a href="#section-5.2.8.2" class="section-number selfRef">5.2.8.2. </a><a href="#name-poposigningkey-structure" class="section-name selfRef">POPOSigningKey Structure</a>
            </h5>
<p id="section-5.2.8.2-1">If the certification request is for a key pair that supports signing (i.e., a request for a verification certificate), then the proof-of-possession of the private key is demonstrated through use of the POPOSigningKey structure, for details see Section 4.1 of <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>.<a href="#section-5.2.8.2-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.8.2-2">
<pre>
   POPOSigningKey ::= SEQUENCE {
      poposkInput [0] POPOSigningKeyInput OPTIONAL,
      algorithmIdentifier AlgorithmIdentifier,
      signature BIT STRING
   }

   POPOSigningKeyInput ::= SEQUENCE {
      authInfo CHOICE {
         sender [0] GeneralName,
         publicKeyMAC PKMACValue
      },
      publicKey SubjectPublicKeyInfo
   }

   PKMACValue ::= SEQUENCE {
      algId AlgorithmIdentifier,
      value BIT STRING
   }
</pre><a href="#section-5.2.8.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.8.2-3">Note: For the purposes of this specification, the ASN.1 comment given in Appendix C of <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> pertains not only to certTemplate, but also to the altCertTemplate control as defined in <a href="#sect-5.2.1" class="auto internal xref">Section 5.2.1</a>.<a href="#section-5.2.8.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.8.2-4">If certTemplate (or the altCertTemplate control) contains the subject and publicKey values, then poposkInput <span class="bcp14">MUST</span> be omitted and the signature <span class="bcp14">MUST</span> be computed on the DER-encoded value of certReq field of the CertReqMsg (or the DER-encoded value of AltCertTemplate). If certTemplate/altCertTemplate does not contain both the subject and public key values (i.e., if it contains only one of these, or neither), then poposkInput <span class="bcp14">MUST</span> be present and the signature <span class="bcp14">MUST</span> be computed on the DER-encoded value of poposkInput (i.e., the "value" OCTETs of the POPOSigningKeyInput DER).<a href="#section-5.2.8.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2.8.2-5">In the special case that the CA/RA has a DH certificate that is known to the EE and the certification request is for a key agreement key pair, the EE can also use the POPOSigningKey structure (where the algorithmIdentifier field is DHBasedMAC and the signature field is the MAC) for demonstrating POP.<a href="#section-5.2.8.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.8.3">
<section id="section-5.2.8.3">
            <h5 id="name-popoprivkey-structure">
<a href="#section-5.2.8.3" class="section-number selfRef">5.2.8.3. </a><a href="#name-popoprivkey-structure" class="section-name selfRef">POPOPrivKey Structure</a>
            </h5>
<p id="section-5.2.8.3-1">If the certification request is for a key pair that does not support signing (i.e., a request for an encryption or key agreement certificate), then the proof-of-possession of the private key is demonstrated through use of the POPOPrivKey structure in one of the following three ways, for details see Section 4.2 and 4.3 of <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>.<a href="#section-5.2.8.3-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.8.3-2">
<pre>
   POPOPrivKey ::= CHOICE {
      thisMessage [0] BIT STRING, -- deprecated
      subsequentMessage [1] SubsequentMessage,
      dhMAC [2] BIT STRING, -- deprecated
      agreeMAC [3] PKMACValue,
      encryptedKey [4] EnvelopedData
   }

   SubsequentMessage ::= INTEGER {
      encrCert (0),
      challengeResp (1)
   }
</pre><a href="#section-5.2.8.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.8.3-3">When using agreeMAC or encryptedKey choices, the pvno cmp2021(3) <span class="bcp14">MUST</span> be used. Details on the usage of the protocol version number (pvno) are described in <a href="#sect-7" class="auto internal xref">Section 7</a>.<a href="#section-5.2.8.3-3" class="pilcrow">¶</a></p>
<div id="sect-5.2.8.3.1">
<section id="section-5.2.8.3.1">
              <h6 id="name-inclusion-of-the-private-ke">
<a href="#section-5.2.8.3.1" class="section-number selfRef">5.2.8.3.1. </a><a href="#name-inclusion-of-the-private-ke" class="section-name selfRef">Inclusion of the Private Key</a>
              </h6>
<p id="section-5.2.8.3.1-1">This method mentioned previously in <a href="#sect-4.3" class="auto internal xref">Section 4.3</a> demonstrates proof-of-possession of the private key by including the encrypted private key in the CertRequest in the POPOPrivKey structure or in the PKIArchiveOptions control structure. This method <span class="bcp14">SHALL</span> only be used if archival of the private key is desired.<a href="#section-5.2.8.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.8.3.1-2">For a certification request message indicating cmp2021(3) in the pvno field of the PKIHeader, the encrypted private key <span class="bcp14">MUST</span> be transferred in the encryptedKey choice of POPOPrivKey (or within the PKIArchiveOptions control) in a CMS EnvelopedData structure as defined in <a href="#sect-5.2.2" class="auto internal xref">Section 5.2.2</a>.<a href="#section-5.2.8.3.1-2" class="pilcrow">¶</a></p>
<p id="section-5.2.8.3.1-3">Note: The thisMessage choice has been deprecated in favor of encryptedKey.  When using cmp2000(2) in the certification request message header for backward compatibility, the thisMessage choice of POPOPrivKey is used containing the encrypted private key in an EncryptedValue structure wrapped in a BIT STRING.  This allows the necessary conveyance and protection of the private key while maintaining bits-on-the-wire compatibility with <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>.<a href="#section-5.2.8.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.8.3.2">
<section id="section-5.2.8.3.2">
              <h6 id="name-indirect-method-encrypted-c">
<a href="#section-5.2.8.3.2" class="section-number selfRef">5.2.8.3.2. </a><a href="#name-indirect-method-encrypted-c" class="section-name selfRef">Indirect Method - Encrypted Certificate</a>
              </h6>
<p id="section-5.2.8.3.2-1">The indirect method mentioned previously in <a href="#sect-4.3" class="auto internal xref">Section 4.3</a> demonstrates proof-of-possession of the private key by having the CA return the requested certificate in encrypted form, see <a href="#sect-5.2.2" class="auto internal xref">Section 5.2.2</a>.  This method is indicated in the CertRequest by requesting the encrCert option in the subsequentMessage choice of POPOPrivKey.<a href="#section-5.2.8.3.2-1" class="pilcrow">¶</a></p>
<div id="section-5.2.8.3.2-2">
                <div class="alignLeft art-svg artwork" id="section-5.2.8.3.2-2.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="128" width="264" viewBox="0 0 264 128" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 16,48 L 40,48" fill="none" stroke="black"></path>
                    <path d="M 192,48 L 224,48" fill="none" stroke="black"></path>
                    <path d="M 16,64 L 40,64" fill="none" stroke="black"></path>
                    <path d="M 192,64 L 224,64" fill="none" stroke="black"></path>
                    <path d="M 16,80 L 40,80" fill="none" stroke="black"></path>
                    <path d="M 192,80 L 224,80" fill="none" stroke="black"></path>
                    <path d="M 16,96 L 40,96" fill="none" stroke="black"></path>
                    <path d="M 192,96 L 224,96" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="232,80 220,74.4 220,85.6" fill="black" transform="rotate(0,224,80)"></polygon>
                    <polygon class="arrowhead" points="232,48 220,42.4 220,53.6" fill="black" transform="rotate(0,224,48)"></polygon>
                    <polygon class="arrowhead" points="24,96 12,90.4 12,101.6" fill="black" transform="rotate(180,16,96)"></polygon>
                    <polygon class="arrowhead" points="24,64 12,58.4 12,69.6" fill="black" transform="rotate(180,16,64)"></polygon>
                    <g class="text">
                      <text x="12" y="36">EE</text>
                      <text x="240" y="36">RA/CA</text>
                      <text x="112" y="52">req</text>
                      <text x="72" y="68">rep</text>
                      <text x="108" y="68">(enc</text>
                      <text x="152" y="68">cert)</text>
                      <text x="68" y="84">conf</text>
                      <text x="112" y="84">(cert</text>
                      <text x="160" y="84">hash)</text>
                      <text x="112" y="100">ack</text>
                    </g>
                  </svg><a href="#section-5.2.8.3.2-2.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.2.8.3.2-3">The end entity proves knowledge of the private key to the CA by providing the correct CertHash for this certificate in the certConf message. This demonstrates POP because the EE can only compute the correct CertHash if it is able to recover the encrypted certificate, and it can only recover the certificate if it is able to obtain the symmetric key using the required private key. Clearly, for this to work, the CA <span class="bcp14">MUST NOT</span> publish the certificate until the certConf message arrives (when certHash is to be used to demonstrate POP). See <a href="#sect-5.3.18" class="auto internal xref">Section 5.3.18</a> for further details and see <a href="#sect-8.11" class="auto internal xref">Section 8.11</a> for security considerations regarding use of Certificate Transparency logs.<a href="#section-5.2.8.3.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.8.3.2-4">The recipient <span class="bcp14">SHOULD</span> maintain a context of the PKI management operation, e.g., using transactionID and certReqId, to identify the private key to use when decrypting the EnvelopedData containing the newly issued certificate. The recipient may be unable to use the RecipientInfo structure as it refers to the certificate that is still encrypted. The sender <span class="bcp14">MUST</span> populate the rid field as specified by CMS and the client <span class="bcp14">MAY</span> ignore it.<a href="#section-5.2.8.3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.2.8.3.3">
<section id="section-5.2.8.3.3">
              <h6 id="name-direct-method-challenge-res">
<a href="#section-5.2.8.3.3" class="section-number selfRef">5.2.8.3.3. </a><a href="#name-direct-method-challenge-res" class="section-name selfRef">Direct Method - Challenge-Response Protocol</a>
              </h6>
<p id="section-5.2.8.3.3-1">The direct method mentioned previously in <a href="#sect-4.3" class="auto internal xref">Section 4.3</a> demonstrates proof-of-possession of the private key by having the end entity engage in a challenge-response protocol (using the messages popdecc of type POPODecKeyChall and popdecr of type POPODecKeyResp; see below) between CertReqMessages and CertRepMessage. This method is indicated in the CertRequest by requesting the challengeResp option in the subsequentMessage choice of POPOPrivKey.<a href="#section-5.2.8.3.3-1" class="pilcrow">¶</a></p>
<p id="section-5.2.8.3.3-2">Note: This method would typically be used in an environment in which an RA verifies POP and then makes a certification request to the CA on behalf of the end entity. In such a scenario, the CA trusts the RA to have done POP correctly before the RA requests a certificate for the end entity.<a href="#section-5.2.8.3.3-2" class="pilcrow">¶</a></p>
<p id="section-5.2.8.3.3-3">The complete protocol then looks as follows (note that req' does not necessarily encapsulate req as a nested message):<a href="#section-5.2.8.3.3-3" class="pilcrow">¶</a></p>
<div id="section-5.2.8.3.3-4">
                <div class="alignLeft art-svg artwork" id="section-5.2.8.3.3-4.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="224" width="248" viewBox="0 0 248 224" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 16,48 L 40,48" fill="none" stroke="black"></path>
                    <path d="M 88,48 L 120,48" fill="none" stroke="black"></path>
                    <path d="M 16,64 L 40,64" fill="none" stroke="black"></path>
                    <path d="M 104,64 L 120,64" fill="none" stroke="black"></path>
                    <path d="M 16,80 L 40,80" fill="none" stroke="black"></path>
                    <path d="M 96,80 L 120,80" fill="none" stroke="black"></path>
                    <path d="M 128,96 L 152,96" fill="none" stroke="black"></path>
                    <path d="M 208,96 L 232,96" fill="none" stroke="black"></path>
                    <path d="M 128,112 L 152,112" fill="none" stroke="black"></path>
                    <path d="M 200,112 L 232,112" fill="none" stroke="black"></path>
                    <path d="M 128,128 L 152,128" fill="none" stroke="black"></path>
                    <path d="M 208,128 L 232,128" fill="none" stroke="black"></path>
                    <path d="M 128,144 L 152,144" fill="none" stroke="black"></path>
                    <path d="M 200,144 L 232,144" fill="none" stroke="black"></path>
                    <path d="M 16,160 L 40,160" fill="none" stroke="black"></path>
                    <path d="M 88,160 L 120,160" fill="none" stroke="black"></path>
                    <path d="M 16,176 L 40,176" fill="none" stroke="black"></path>
                    <path d="M 96,176 L 120,176" fill="none" stroke="black"></path>
                    <path d="M 16,192 L 40,192" fill="none" stroke="black"></path>
                    <path d="M 88,192 L 120,192" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="240,128 228,122.4 228,133.6" fill="black" transform="rotate(0,232,128)"></polygon>
                    <polygon class="arrowhead" points="240,96 228,90.4 228,101.6" fill="black" transform="rotate(0,232,96)"></polygon>
                    <polygon class="arrowhead" points="136,144 124,138.4 124,149.6" fill="black" transform="rotate(180,128,144)"></polygon>
                    <polygon class="arrowhead" points="136,112 124,106.4 124,117.6" fill="black" transform="rotate(180,128,112)"></polygon>
                    <polygon class="arrowhead" points="128,176 116,170.4 116,181.6" fill="black" transform="rotate(0,120,176)"></polygon>
                    <polygon class="arrowhead" points="128,80 116,74.4 116,85.6" fill="black" transform="rotate(0,120,80)"></polygon>
                    <polygon class="arrowhead" points="128,48 116,42.4 116,53.6" fill="black" transform="rotate(0,120,48)"></polygon>
                    <polygon class="arrowhead" points="24,192 12,186.4 12,197.6" fill="black" transform="rotate(180,16,192)"></polygon>
                    <polygon class="arrowhead" points="24,160 12,154.4 12,165.6" fill="black" transform="rotate(180,16,160)"></polygon>
                    <polygon class="arrowhead" points="24,64 12,58.4 12,69.6" fill="black" transform="rotate(180,16,64)"></polygon>
                    <g class="text">
                      <text x="12" y="36">EE</text>
                      <text x="124" y="36">RA</text>
                      <text x="236" y="36">CA</text>
                      <text x="64" y="52">req</text>
                      <text x="72" y="68">chall</text>
                      <text x="68" y="84">resp</text>
                      <text x="180" y="100">req'</text>
                      <text x="176" y="116">rep</text>
                      <text x="180" y="132">conf</text>
                      <text x="176" y="148">ack</text>
                      <text x="64" y="164">rep</text>
                      <text x="68" y="180">conf</text>
                      <text x="64" y="196">ack</text>
                    </g>
                  </svg><a href="#section-5.2.8.3.3-4.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.2.8.3.3-5">This protocol is obviously much longer than the exchange given in <a href="#sect-5.2.8.3.2" class="auto internal xref">Section 5.2.8.3.2</a> above, but allows a local Registration Authority to be involved and has the property that the certificate itself is not actually created until the proof-of-possession is complete. In some environments, a different order of the above messages may be required, such as the following (this may be determined by policy):<a href="#section-5.2.8.3.3-5" class="pilcrow">¶</a></p>
<div id="section-5.2.8.3.3-6">
                <div class="alignLeft art-svg artwork" id="section-5.2.8.3.3-6.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="224" width="248" viewBox="0 0 248 224" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                    <path d="M 16,48 L 40,48" fill="none" stroke="black"></path>
                    <path d="M 88,48 L 120,48" fill="none" stroke="black"></path>
                    <path d="M 16,64 L 40,64" fill="none" stroke="black"></path>
                    <path d="M 104,64 L 120,64" fill="none" stroke="black"></path>
                    <path d="M 16,80 L 40,80" fill="none" stroke="black"></path>
                    <path d="M 96,80 L 120,80" fill="none" stroke="black"></path>
                    <path d="M 128,96 L 152,96" fill="none" stroke="black"></path>
                    <path d="M 208,96 L 232,96" fill="none" stroke="black"></path>
                    <path d="M 128,112 L 152,112" fill="none" stroke="black"></path>
                    <path d="M 200,112 L 232,112" fill="none" stroke="black"></path>
                    <path d="M 16,128 L 40,128" fill="none" stroke="black"></path>
                    <path d="M 88,128 L 120,128" fill="none" stroke="black"></path>
                    <path d="M 16,144 L 40,144" fill="none" stroke="black"></path>
                    <path d="M 96,144 L 120,144" fill="none" stroke="black"></path>
                    <path d="M 128,160 L 152,160" fill="none" stroke="black"></path>
                    <path d="M 208,160 L 232,160" fill="none" stroke="black"></path>
                    <path d="M 128,176 L 152,176" fill="none" stroke="black"></path>
                    <path d="M 200,176 L 232,176" fill="none" stroke="black"></path>
                    <path d="M 16,192 L 40,192" fill="none" stroke="black"></path>
                    <path d="M 88,192 L 120,192" fill="none" stroke="black"></path>
                    <polygon class="arrowhead" points="240,160 228,154.4 228,165.6" fill="black" transform="rotate(0,232,160)"></polygon>
                    <polygon class="arrowhead" points="240,96 228,90.4 228,101.6" fill="black" transform="rotate(0,232,96)"></polygon>
                    <polygon class="arrowhead" points="136,176 124,170.4 124,181.6" fill="black" transform="rotate(180,128,176)"></polygon>
                    <polygon class="arrowhead" points="136,112 124,106.4 124,117.6" fill="black" transform="rotate(180,128,112)"></polygon>
                    <polygon class="arrowhead" points="128,144 116,138.4 116,149.6" fill="black" transform="rotate(0,120,144)"></polygon>
                    <polygon class="arrowhead" points="128,80 116,74.4 116,85.6" fill="black" transform="rotate(0,120,80)"></polygon>
                    <polygon class="arrowhead" points="128,48 116,42.4 116,53.6" fill="black" transform="rotate(0,120,48)"></polygon>
                    <polygon class="arrowhead" points="24,192 12,186.4 12,197.6" fill="black" transform="rotate(180,16,192)"></polygon>
                    <polygon class="arrowhead" points="24,128 12,122.4 12,133.6" fill="black" transform="rotate(180,16,128)"></polygon>
                    <polygon class="arrowhead" points="24,64 12,58.4 12,69.6" fill="black" transform="rotate(180,16,64)"></polygon>
                    <g class="text">
                      <text x="12" y="36">EE</text>
                      <text x="124" y="36">RA</text>
                      <text x="236" y="36">CA</text>
                      <text x="64" y="52">req</text>
                      <text x="72" y="68">chall</text>
                      <text x="68" y="84">resp</text>
                      <text x="180" y="100">req'</text>
                      <text x="176" y="116">rep</text>
                      <text x="64" y="132">rep</text>
                      <text x="68" y="148">conf</text>
                      <text x="180" y="164">conf</text>
                      <text x="176" y="180">ack</text>
                      <text x="64" y="196">ack</text>
                    </g>
                  </svg><a href="#section-5.2.8.3.3-6.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.2.8.3.3-7">The challenge-response messages for proof-of-possession of a private key are specified as follows (for decryption keys see <span>[<a href="#MvOV97" class="cite xref">MvOV97</a>]</span>, p.404 for details).  This challenge-response exchange is associated with the preceding certification request message (and subsequent certification response and confirmation messages) by the transactionID used in the PKIHeader and by the protection applied to the PKIMessage.<a href="#section-5.2.8.3.3-7" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.8.3.3-8">
<pre>
   POPODecKeyChallContent ::= SEQUENCE OF Challenge

   Challenge ::= SEQUENCE {
      owf AlgorithmIdentifier OPTIONAL,
      witness OCTET STRING,
      challenge OCTET STRING, -- deprecated
      encryptedRand [0] EnvelopedData OPTIONAL
   }

   Rand ::= SEQUENCE {
      int INTEGER,
      sender GeneralName
   }
</pre><a href="#section-5.2.8.3.3-8" class="pilcrow">¶</a>
</div>
<p id="section-5.2.8.3.3-9">More details on the fields in this syntax is available in <a href="#sect-f" class="auto internal xref">Appendix F</a>.<a href="#section-5.2.8.3.3-9" class="pilcrow">¶</a></p>
<p id="section-5.2.8.3.3-10">For a popdecc message indicating cmp2021(3) in the pvno field of the PKIHeader, the encryption of Rand <span class="bcp14">MUST</span> be transferred in the encryptedRand field in a CMS EnvelopedData structure as defined in <a href="#sect-5.2.2" class="auto internal xref">Section 5.2.2</a>.  The challenge field <span class="bcp14">MUST</span> contain an empty OCTET STRING.<a href="#section-5.2.8.3.3-10" class="pilcrow">¶</a></p>
<p id="section-5.2.8.3.3-11">The recipient <span class="bcp14">SHOULD</span> maintain a context of the PKI management operation, e.g., using transactionID and certReqId, to identify the private key to use when decrypting encryptedRand. The sender <span class="bcp14">MUST</span> populate the rid field in the EnvelopedData sequence using the issuerAndSerialNumber choice containing a NULL-DN as issuer and the certReqId as serialNumber. The client <span class="bcp14">MAY</span> ignore the rid field.<a href="#section-5.2.8.3.3-11" class="pilcrow">¶</a></p>
<p id="section-5.2.8.3.3-12">Note: The challenge field has been deprecated in favor of encryptedRand.  When using cmp2000(2) in the popdecc message header for backward compatibility, the challenge field <span class="bcp14">MUST</span> contain the encryption (involving the public key for which the certification request is being made) of Rand and encryptedRand <span class="bcp14">MUST</span> be omitted.  Using challenge (omitting the optional encryptedRand field) is bit-compatible with <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span>. Note that the size of Rand, when used with challenge, needs to be appropriate for encryption, involving the public key of the requester. If, in some environment, names are so long that they cannot fit (e.g., very long DNs), then whatever portion will fit should be used (as long as it includes at least the common name, and as long as the receiver is able to deal meaningfully with the abbreviation).<a href="#section-5.2.8.3.3-12" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.2.8.3.3-13">
<pre>
   POPODecKeyRespContent ::= SEQUENCE OF INTEGER
</pre><a href="#section-5.2.8.3.3-13" class="pilcrow">¶</a>
</div>
<p id="section-5.2.8.3.3-14">On receiving the popdecc message, the end entity decrypts all included challenges
and responds with a popdecr message containing the decrypted integer values in the same order.<a href="#section-5.2.8.3.3-14" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5.2.8.4">
<section id="section-5.2.8.4">
            <h5 id="name-summary-of-pop-options">
<a href="#section-5.2.8.4" class="section-number selfRef">5.2.8.4. </a><a href="#name-summary-of-pop-options" class="section-name selfRef">Summary of PoP Options</a>
            </h5>
<p id="section-5.2.8.4-1">The text in this section provides several options with respect to POP techniques. Using "SK" for "signing key", "EK" for "encryption key", "KAK" for "key agreement key", and "KEMK" for "key encapsulation mechanism key", the techniques may be summarized as follows:<a href="#section-5.2.8.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.8.4-2">
<pre>
   RAVerified;
   SKPOP;
   EKPOPThisMessage; -- deprecated
   KAKPOPThisMessage; -- deprecated
   EKPOPEncryptedKey;
   KAKPOPEncryptedKey;
   KEMKPOPEncryptedKey;
   KAKPOPThisMessageDHMAC;
   EKPOPEncryptedCert;
   KAKPOPEncryptedCert;
   KEMKPOPEncryptedCert;
   EKPOPChallengeResp;
   KAKPOPChallengeResp; and
   KEMKPOPChallengeResp.
</pre><a href="#section-5.2.8.4-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.8.4-3">Given this array of options, it is natural to ask how an end entity can know what is supported by the CA/RA (i.e., which options it may use when requesting certificates). The following guidelines should clarify this situation for EE implementers.<a href="#section-5.2.8.4-3" class="pilcrow">¶</a></p>
<p id="section-5.2.8.4-4">RAVerified: This is not an EE decision; the RA uses this if and only if it has verified POP before forwarding the request on to the CA, so it is not possible for the EE to choose this technique.<a href="#section-5.2.8.4-4" class="pilcrow">¶</a></p>
<p id="section-5.2.8.4-5">SKPOP: If the EE has a signing key pair, this is the only POP method specified for use in the request for a corresponding certificate.<a href="#section-5.2.8.4-5" class="pilcrow">¶</a></p>
<p id="section-5.2.8.4-6">EKPOPThisMessage (deprecated), KAKPOPThisMessage (deprecated), EKPOPEncryptedKey, KAKPOPEncryptedKey, KEMKPOPEncryptedKey: Whether or not to give up its private key to the CA/RA is an EE decision. If the EE decides to reveal its key, then these are the only POP methods available in this specification to achieve this (and the key pair type and protocol version used will determine which of these methods to use).  The reason for deprecating EKPOPThisMessage and KAKPOPThisMessage options has been given in <a href="#sect-5.2.8.3.1" class="auto internal xref">Section 5.2.8.3.1</a>.<a href="#section-5.2.8.4-6" class="pilcrow">¶</a></p>
<p id="section-5.2.8.4-7">KAKPOPThisMessageDHMAC: The EE can only use this method if (1) the CA/RA has a DH certificate available for this purpose, and (2) the EE already has a copy of this certificate. If both these conditions hold, then this technique is clearly supported and may be used by the EE, if desired.<a href="#section-5.2.8.4-7" class="pilcrow">¶</a></p>
<p id="section-5.2.8.4-8">EKPOPEncryptedCert, KAKPOPEncryptedCert, KEMKPOPEncryptedCert, EKPOPChallengeResp, KAKPOPChallengeResp, and KEMKPOPChallengeResp: The EE picks one of these (in the subsequentMessage field) in the request message, depending upon preference and key pair type. The EE is not doing POP at this point; it is simply indicating which method it wants to use. Therefore, if the CA/RA replies with a "badPOP" error, the EE can re-request using the other POP method chosen in subsequentMessage. Note, however, that this specification encourages the use of the EncryptedCert choice and, furthermore, says that the challenge-response would typically be used when an RA is involved and doing POP verification. Thus, the EE should be able to make an intelligent decision regarding which of these POP methods to choose in the request message.<a href="#section-5.2.8.4-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5.2.9">
<section id="section-5.2.9">
          <h4 id="name-generalizedtime">
<a href="#section-5.2.9" class="section-number selfRef">5.2.9. </a><a href="#name-generalizedtime" class="section-name selfRef">GeneralizedTime</a>
          </h4>
<p id="section-5.2.9-1">GeneralizedTime is a standard ASN.1 type and <span class="bcp14">SHALL</span> be used as specified in Section 4.1.2.5.2 of <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-5.2.9-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5.3">
<section id="section-5.3">
        <h3 id="name-operation-specific-data-str">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-operation-specific-data-str" class="section-name selfRef">Operation-Specific Data Structures</a>
        </h3>
<div id="sect-5.3.1">
<section id="section-5.3.1">
          <h4 id="name-initialization-request">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-initialization-request" class="section-name selfRef">Initialization Request</a>
          </h4>
<p id="section-5.3.1-1">An Initialization request message contains as the PKIBody a
CertReqMessages data structure, which specifies the requested
certificate(s).  Typically, SubjectPublicKeyInfo, KeyId, and Validity
are the template fields which may be supplied for each certificate
requested (see the profiles defined in <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> Section 4.1.1, <a href="#sect-c.4" class="auto internal xref">Appendix C.4</a>
and <a href="#sect-d.7" class="auto internal xref">Appendix D.7</a> for further information).  This
message is intended to be used for entities when first initializing
into the PKI.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">See <a href="#sect-5.2.1" class="auto internal xref">Section 5.2.1</a> and <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for CertReqMessages syntax.<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.2">
<section id="section-5.3.2">
          <h4 id="name-initialization-response">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-initialization-response" class="section-name selfRef">Initialization Response</a>
          </h4>
<p id="section-5.3.2-1">An Initialization response message contains as the PKIBody a
CertRepMessage data structure, which has for each certificate
requested a PKIStatusInfo field, a subject certificate, and possibly
a private key (normally encrypted using EnvelopedData, see <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> Section
4.1.6 for further information).<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2-2">See <a href="#sect-5.3.4" class="auto internal xref">Section 5.3.4</a> for CertRepMessage syntax.  Note that if the PKI
Message Protection is "shared secret information" (see <a href="#sect-5.1.3.1" class="auto internal xref">Section 5.1.3.1</a>),
then any certificate transported in the caPubs field may be
directly trusted as a root CA certificate by the initiator.<a href="#section-5.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.3">
<section id="section-5.3.3">
          <h4 id="name-certification-request">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-certification-request" class="section-name selfRef">Certification Request</a>
          </h4>
<p id="section-5.3.3-1">A Certification request message contains as the PKIBody a
CertReqMessages data structure, which specifies the requested
certificates (see the profiles defined in <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> Section 4.1.2 and <a href="#sect-c.2" class="auto internal xref">Appendix C.2</a>
for further information).  This message is intended to be used for existing PKI
entities who wish to obtain additional certificates.<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3-2">See <a href="#sect-5.2.1" class="auto internal xref">Section 5.2.1</a> and <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for CertReqMessages syntax.<a href="#section-5.3.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3.3-3">Alternatively, the PKIBody <span class="bcp14">MAY</span> be a CertificationRequest (this
structure is fully specified by the ASN.1 structure
CertificationRequest given in <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>, see the profiles defined in
<span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> Section 4.1.4 for further information).
This structure may be
required for certificate requests for signing key pairs when
interoperation with legacy systems is desired, but its use is
strongly discouraged whenever not absolutely necessary.<a href="#section-5.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.4">
<section id="section-5.3.4">
          <h4 id="name-certification-response">
<a href="#section-5.3.4" class="section-number selfRef">5.3.4. </a><a href="#name-certification-response" class="section-name selfRef">Certification Response</a>
          </h4>
<p id="section-5.3.4-1">A Certification response message contains as the PKIBody a
CertRepMessage data structure, which has a status value for each
certificate requested, and optionally has a CA public key, failure
information, a subject certificate, and an encrypted private key.<a href="#section-5.3.4-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.4-2">
<pre>
  CertRepMessage ::= SEQUENCE {
     caPubs          [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                         OPTIONAL,
     response            SEQUENCE OF CertResponse
  }

  CertResponse ::= SEQUENCE {
     certReqId           INTEGER,
     status              PKIStatusInfo,
     certifiedKeyPair    CertifiedKeyPair     OPTIONAL,
     rspInfo             OCTET STRING         OPTIONAL
     -- analogous to the id-regInfo-utf8Pairs string defined
     -- for regInfo in CertReqMsg [RFC4211]
  }

  CertifiedKeyPair ::= SEQUENCE {
     certOrEncCert       CertOrEncCert,
     privateKey      [0] EncryptedKey         OPTIONAL,
     -- See [RFC4211] for comments on encoding.
     publicationInfo [1] PKIPublicationInfo   OPTIONAL
  }

  CertOrEncCert ::= CHOICE {
     certificate     [0] CMPCertificate,
     encryptedCert   [1] EncryptedKey
  }
</pre><a href="#section-5.3.4-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.4-3">A p10cr message contains exactly one CertificationRequestInfo data structure,
as specified in PKCS#10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>, but no certReqId.
Therefore, the certReqId in the corresponding Certification
Response (cp) message <span class="bcp14">MUST</span> be set to -1.<a href="#section-5.3.4-3" class="pilcrow">¶</a></p>
<p id="section-5.3.4-4">Only one of the failInfo (in PKIStatusInfo) and certificate (in
CertifiedKeyPair) fields can be present in each CertResponse
(depending on the status).  For some status values (e.g., waiting),
neither of the optional fields will be present.<a href="#section-5.3.4-4" class="pilcrow">¶</a></p>
<p id="section-5.3.4-5">Given an EncryptedCert and the relevant decryption key, the
certificate may be obtained.  The purpose of this is to allow a CA to
return the value of a certificate, but with the constraint that only
the intended recipient can obtain the actual certificate.  The
benefit of this approach is that a CA may reply with a certificate
even in the absence of a proof that the requester is the end entity
that can use the relevant private key (note that the proof is not
obtained until the certConf message is received by the CA).  Thus,
the CA will not have to revoke that certificate in the event that
something goes wrong with the proof-of-possession (but <span class="bcp14">MAY</span> do so
anyway, depending upon policy).<a href="#section-5.3.4-5" class="pilcrow">¶</a></p>
<p id="section-5.3.4-6">The use of EncryptedKey is described in <a href="#sect-5.2.2" class="auto internal xref">Section 5.2.2</a>.<a href="#section-5.3.4-6" class="pilcrow">¶</a></p>
<p id="section-5.3.4-7">Note: To indicate support for EnvelopedData, the pvno cmp2021 has been
introduced. Details on the usage of different protocol version
numbers (pvno) are described in <a href="#sect-7" class="auto internal xref">Section 7</a>.<a href="#section-5.3.4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.5">
<section id="section-5.3.5">
          <h4 id="name-key-update-request-content">
<a href="#section-5.3.5" class="section-number selfRef">5.3.5. </a><a href="#name-key-update-request-content" class="section-name selfRef">Key Update Request Content</a>
          </h4>
<p id="section-5.3.5-1">For key update requests the CertReqMessages syntax is used.
Typically, SubjectPublicKeyInfo, KeyId, and Validity are the template
fields that may be supplied for each key to be updated (see the profiles
defined in <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> Section 4.1.3 and <a href="#sect-c.6" class="auto internal xref">Appendix C.6</a> for further information).
This message
is intended to be used to request updates to existing (non-revoked
and non-expired) certificates (therefore, it is sometimes referred to
as a "Certificate Update" operation).  An update is a replacement
certificate containing either a new subject public key or the current
subject public key (although the latter practice may not be
appropriate for some environments).<a href="#section-5.3.5-1" class="pilcrow">¶</a></p>
<p id="section-5.3.5-2">See <a href="#sect-5.2.1" class="auto internal xref">Section 5.2.1</a> and <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for CertReqMessages syntax.<a href="#section-5.3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.6">
<section id="section-5.3.6">
          <h4 id="name-key-update-response-content">
<a href="#section-5.3.6" class="section-number selfRef">5.3.6. </a><a href="#name-key-update-response-content" class="section-name selfRef">Key Update Response Content</a>
          </h4>
<p id="section-5.3.6-1">For key update responses, the CertRepMessage syntax is used.  The
response is identical to the initialization response.<a href="#section-5.3.6-1" class="pilcrow">¶</a></p>
<p id="section-5.3.6-2">See <a href="#sect-5.3.4" class="auto internal xref">Section 5.3.4</a> for CertRepMessage syntax.<a href="#section-5.3.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.7">
<section id="section-5.3.7">
          <h4 id="name-key-recovery-request-conten">
<a href="#section-5.3.7" class="section-number selfRef">5.3.7. </a><a href="#name-key-recovery-request-conten" class="section-name selfRef">Key Recovery Request Content</a>
          </h4>
<p id="section-5.3.7-1">For key recovery requests the syntax used is identical to the
initialization request CertReqMessages.  Typically,
SubjectPublicKeyInfo and KeyId are the template fields that may be
used to supply a signature public key for which a certificate is
required.<a href="#section-5.3.7-1" class="pilcrow">¶</a></p>
<p id="section-5.3.7-2">See <a href="#sect-5.2.1" class="auto internal xref">Section 5.2.1</a> and <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for CertReqMessages syntax.  Note that if a
key history is required, the requester must supply a Protocol
Encryption Key control in the request message.<a href="#section-5.3.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.8">
<section id="section-5.3.8">
          <h4 id="name-key-recovery-response-conte">
<a href="#section-5.3.8" class="section-number selfRef">5.3.8. </a><a href="#name-key-recovery-response-conte" class="section-name selfRef">Key Recovery Response Content</a>
          </h4>
<p id="section-5.3.8-1">For key recovery responses, the following syntax is used.  For some
status values (e.g., waiting) none of the optional fields will be
present.<a href="#section-5.3.8-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.8-2">
<pre>
  KeyRecRepContent ::= SEQUENCE {
     status            PKIStatusInfo,
     newSigCert    [0] Certificate                 OPTIONAL,
     caCerts       [1] SEQUENCE SIZE (1..MAX) OF
                                  Certificate      OPTIONAL,
     keyPairHist   [2] SEQUENCE SIZE (1..MAX) OF
                                  CertifiedKeyPair OPTIONAL
  }
</pre><a href="#section-5.3.8-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.9">
<section id="section-5.3.9">
          <h4 id="name-revocation-request-content">
<a href="#section-5.3.9" class="section-number selfRef">5.3.9. </a><a href="#name-revocation-request-content" class="section-name selfRef">Revocation Request Content</a>
          </h4>
<p id="section-5.3.9-1">When requesting revocation of a certificate (or several
certificates), the following data structure is used (see the profiles defined
in <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> Section 4.2 for further information).  The name of the
requester is present in the PKIHeader structure.<a href="#section-5.3.9-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.9-2">
<pre>
  RevReqContent ::= SEQUENCE OF RevDetails

  RevDetails ::= SEQUENCE {
     certDetails         CertTemplate,
     crlEntryDetails     Extensions       OPTIONAL
  }
</pre><a href="#section-5.3.9-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.10">
<section id="section-5.3.10">
          <h4 id="name-revocation-response-content">
<a href="#section-5.3.10" class="section-number selfRef">5.3.10. </a><a href="#name-revocation-response-content" class="section-name selfRef">Revocation Response Content</a>
          </h4>
<p id="section-5.3.10-1">The revocation response is the response to the above message.  If
produced, this is sent to the requester of the revocation.  (A
separate revocation announcement message <span class="bcp14">MAY</span> be sent to the subject
of the certificate for which revocation was requested.)<a href="#section-5.3.10-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.10-2">
<pre>
  RevRepContent ::= SEQUENCE {
     status        SEQUENCE SIZE (1..MAX) OF PKIStatusInfo,
     revCerts  [0] SEQUENCE SIZE (1..MAX) OF CertId OPTIONAL,
     crls      [1] SEQUENCE SIZE (1..MAX) OF CertificateList
                   OPTIONAL
  }
</pre><a href="#section-5.3.10-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.11">
<section id="section-5.3.11">
          <h4 id="name-cross-certification-request">
<a href="#section-5.3.11" class="section-number selfRef">5.3.11. </a><a href="#name-cross-certification-request" class="section-name selfRef">Cross Certification Request Content</a>
          </h4>
<p id="section-5.3.11-1">Cross certification requests use the same syntax (CertReqMessages) as
normal certification requests, with the restriction that the key pair
<span class="bcp14">MUST</span> have been generated by the requesting CA and the private key
<span class="bcp14">MUST NOT</span> be sent to the responding CA (see the profiles defined in <a href="#sect-d.6" class="auto internal xref">Appendix D.6</a>
for further information).  This request <span class="bcp14">MAY</span> also be used
by subordinate CAs to get their certificates signed by the parent CA.<a href="#section-5.3.11-1" class="pilcrow">¶</a></p>
<p id="section-5.3.11-2">See <a href="#sect-5.2.1" class="auto internal xref">Section 5.2.1</a> and <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> for CertReqMessages syntax.<a href="#section-5.3.11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.12">
<section id="section-5.3.12">
          <h4 id="name-cross-certification-respons">
<a href="#section-5.3.12" class="section-number selfRef">5.3.12. </a><a href="#name-cross-certification-respons" class="section-name selfRef">Cross Certification Response Content</a>
          </h4>
<p id="section-5.3.12-1">Cross certification responses use the same syntax (CertRepMessage) as
normal certification responses, with the restriction that no
encrypted private key can be sent.<a href="#section-5.3.12-1" class="pilcrow">¶</a></p>
<p id="section-5.3.12-2">See <a href="#sect-5.3.4" class="auto internal xref">Section 5.3.4</a> for CertRepMessage syntax.<a href="#section-5.3.12-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.13">
<section id="section-5.3.13">
          <h4 id="name-ca-key-update-announcement-">
<a href="#section-5.3.13" class="section-number selfRef">5.3.13. </a><a href="#name-ca-key-update-announcement-" class="section-name selfRef">CA Key Update Announcement Content</a>
          </h4>
<p id="section-5.3.13-1">When a CA updates its own key pair, the following data structure <span class="bcp14">MAY</span>
be used to announce this event.<a href="#section-5.3.13-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.13-2">
<pre>
  RootCaKeyUpdateContent ::= SEQUENCE {
     newWithNew              CMPCertificate,
     newWithOld          [0] CMPCertificate OPTIONAL,
     oldWithNew          [1] CMPCertificate OPTIONAL
  }

CAKeyUpdContent ::= CHOICE {
    cAKeyUpdAnnV2      CAKeyUpdAnnContent, -- deprecated
    cAKeyUpdAnnV3  [0] RootCaKeyUpdateContent
}
</pre><a href="#section-5.3.13-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.13-3">When using RootCaKeyUpdateContent in the ckuann message, the pvno cmp2021 <span class="bcp14">MUST</span> be used. Details on the usage of the protocol version number (pvno) are described in Section 7.<a href="#section-5.3.13-3" class="pilcrow">¶</a></p>
<p id="section-5.3.13-4">In contrast to CAKeyUpdAnnContent as supported with cmp2000, RootCaKeyUpdateContent offers omitting newWithOld and oldWithNew, depending on the needs of the EE.<a href="#section-5.3.13-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.14">
<section id="section-5.3.14">
          <h4 id="name-certificate-announcement">
<a href="#section-5.3.14" class="section-number selfRef">5.3.14. </a><a href="#name-certificate-announcement" class="section-name selfRef">Certificate Announcement</a>
          </h4>
<p id="section-5.3.14-1">This structure <span class="bcp14">MAY</span> be used to announce the existence of certificates.<a href="#section-5.3.14-1" class="pilcrow">¶</a></p>
<p id="section-5.3.14-2">Note that this message is intended to be used for those cases (if
any) where there is no pre-existing method for publication of
certificates; it is not intended to be used where, for example, X.500
is the method for publication of certificates.<a href="#section-5.3.14-2" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.14-3">
<pre>
  CertAnnContent ::= Certificate
</pre><a href="#section-5.3.14-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.15">
<section id="section-5.3.15">
          <h4 id="name-revocation-announcement">
<a href="#section-5.3.15" class="section-number selfRef">5.3.15. </a><a href="#name-revocation-announcement" class="section-name selfRef">Revocation Announcement</a>
          </h4>
<p id="section-5.3.15-1">When a CA has revoked, or is about to revoke, a particular
certificate, it <span class="bcp14">MAY</span> issue an announcement of this (possibly upcoming)
event.<a href="#section-5.3.15-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.15-2">
<pre>
  RevAnnContent ::= SEQUENCE {
     status              PKIStatus,
     certId              CertId,
     willBeRevokedAt     GeneralizedTime,
     badSinceDate        GeneralizedTime,
     crlDetails          Extensions  OPTIONAL
  }
</pre><a href="#section-5.3.15-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.15-3">A CA <span class="bcp14">MAY</span> use such an announcement to warn (or notify) a subject that
its certificate is about to be (or has been) revoked.  This would
typically be used where the request for revocation did not come from
the subject concerned.<a href="#section-5.3.15-3" class="pilcrow">¶</a></p>
<p id="section-5.3.15-4">The willBeRevokedAt field contains the time at which a new entry will
be added to the relevant CRLs.<a href="#section-5.3.15-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.16">
<section id="section-5.3.16">
          <h4 id="name-crl-announcement">
<a href="#section-5.3.16" class="section-number selfRef">5.3.16. </a><a href="#name-crl-announcement" class="section-name selfRef">CRL Announcement</a>
          </h4>
<p id="section-5.3.16-1">When a CA issues a new CRL (or set of CRLs) the following data
structure <span class="bcp14">MAY</span> be used to announce this event.<a href="#section-5.3.16-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.16-2">
<pre>
  CRLAnnContent ::= SEQUENCE OF CertificateList
</pre><a href="#section-5.3.16-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.17">
<section id="section-5.3.17">
          <h4 id="name-pki-confirmation-content">
<a href="#section-5.3.17" class="section-number selfRef">5.3.17. </a><a href="#name-pki-confirmation-content" class="section-name selfRef">PKI Confirmation Content</a>
          </h4>
<p id="section-5.3.17-1">This data structure is used in the protocol exchange as the final
PKIMessage.  Its content is the same in all cases -- actually there
is no content since the PKIHeader carries all the required
information.<a href="#section-5.3.17-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.17-2">
<pre>
  PKIConfirmContent ::= NULL
</pre><a href="#section-5.3.17-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.17-3">Use of this message for certificate confirmation is <span class="bcp14">NOT RECOMMENDED</span>;
certConf <span class="bcp14">SHOULD</span> be used instead.  Upon receiving a PKIConfirm for a
certificate response, the recipient <span class="bcp14">MAY</span> treat it as a certConf with
all certificates being accepted.<a href="#section-5.3.17-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.18">
<section id="section-5.3.18">
          <h4 id="name-certificate-confirmation-co">
<a href="#section-5.3.18" class="section-number selfRef">5.3.18. </a><a href="#name-certificate-confirmation-co" class="section-name selfRef">Certificate Confirmation Content</a>
          </h4>
<p id="section-5.3.18-1">This data structure is used by the client to send a confirmation to
the CA/RA to accept or reject certificates.<a href="#section-5.3.18-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.18-2">
<pre>
  CertConfirmContent ::= SEQUENCE OF CertStatus

  CertStatus ::= SEQUENCE {
     certHash    OCTET STRING,
     certReqId   INTEGER,
     statusInfo  PKIStatusInfo OPTIONAL,
     hashAlg [0] AlgorithmIdentifier{DIGEST-ALGORITHM, {...}}
                 OPTIONAL
  }
</pre><a href="#section-5.3.18-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.18-3">The hashAlg field <span class="bcp14">SHOULD</span> be used only in exceptional cases where the signatureAlgorithm
of the certificate to be confirmed does not specify a hash algorithm in the
OID or in the parameters or no hash algorithm is specified for hashing certificates signed using the signatureAlgorithm. Note that for EdDSA a hash algorithm is specified in Section 3.3 of <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>, such that the hashAlg field is not needed for EdDSA. Otherwise, the certHash value
<span class="bcp14">SHALL</span> be computed using the same hash algorithm as used to create and verify
the certificate signature or as specified for hashing certificates signed using the signatureAlgorithm. If hashAlg is used, the CMP version indicated
by the certConf message header must be cmp2021(3).<a href="#section-5.3.18-3" class="pilcrow">¶</a></p>
<p id="section-5.3.18-4">For any particular CertStatus, omission of the statusInfo field
indicates acceptance of the specified certificate.  Alternatively,
explicit status details (with respect to acceptance or rejection) <span class="bcp14">MAY</span>
be provided in the statusInfo field, perhaps for auditing purposes at
the CA/RA.<a href="#section-5.3.18-4" class="pilcrow">¶</a></p>
<p id="section-5.3.18-5">Within CertConfirmContent, omission of a CertStatus structure
corresponding to a certificate supplied in the previous response
message indicates rejection of the certificate.  Thus, an empty
CertConfirmContent (a zero-length SEQUENCE) <span class="bcp14">MAY</span> be used to indicate
rejection of all supplied certificates.  See <a href="#sect-5.2.8.3.2" class="auto internal xref">Section 5.2.8.3.2</a>,
for a discussion of the certHash field with respect to
proof-of-possession.<a href="#section-5.3.18-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19">
<section id="section-5.3.19">
          <h4 id="name-pki-general-message-content">
<a href="#section-5.3.19" class="section-number selfRef">5.3.19. </a><a href="#name-pki-general-message-content" class="section-name selfRef">PKI General Message Content</a>
          </h4>
<div class="lang-asn.1 sourcecode" id="section-5.3.19-1">
<pre>
  InfoTypeAndValue ::= SEQUENCE {
     infoType               OBJECT IDENTIFIER,
     infoValue              ANY DEFINED BY infoType  OPTIONAL
  }

  -- where {id-it} = {id-pkix 4} = {1 3 6 1 5 5 7 4}
  GenMsgContent ::= SEQUENCE OF InfoTypeAndValue
</pre><a href="#section-5.3.19-1" class="pilcrow">¶</a>
</div>
<div id="sect-5.3.19.1">
<section id="section-5.3.19.1">
            <h5 id="name-ca-protocol-encryption-cert">
<a href="#section-5.3.19.1" class="section-number selfRef">5.3.19.1. </a><a href="#name-ca-protocol-encryption-cert" class="section-name selfRef">CA Protocol Encryption Certificate</a>
            </h5>
<p id="section-5.3.19.1-1">This <span class="bcp14">MAY</span> be used by the EE to get a certificate from the CA to use to
protect sensitive information during the protocol.<a href="#section-5.3.19.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.1-2">
<pre>
  GenMsg:    {id-it 1}, &lt; absent &gt;
  GenRep:    {id-it 1}, Certificate | &lt; absent &gt;
</pre><a href="#section-5.3.19.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.1-3">EEs <span class="bcp14">MUST</span> ensure that the correct certificate is used for this
purpose.<a href="#section-5.3.19.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.2">
<section id="section-5.3.19.2">
            <h5 id="name-signing-key-pair-types">
<a href="#section-5.3.19.2" class="section-number selfRef">5.3.19.2. </a><a href="#name-signing-key-pair-types" class="section-name selfRef">Signing Key Pair Types</a>
            </h5>
<p id="section-5.3.19.2-1">This <span class="bcp14">MAY</span> be used by the EE to get the list of signature algorithm whose subject
public key values the CA is willing to
certify.<a href="#section-5.3.19.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.2-2">
<pre>
  GenMsg:    {id-it 2}, &lt; absent &gt;
  GenRep:    {id-it 2}, SEQUENCE SIZE (1..MAX) OF
                          AlgorithmIdentifier
</pre><a href="#section-5.3.19.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.2-3">Note: For the purposes of this exchange, rsaEncryption and sha256WithRSAEncryption, for
example, are considered to be equivalent; the question being asked is, "Is
the CA willing to certify an RSA public key?"<a href="#section-5.3.19.2-3" class="pilcrow">¶</a></p>
<p id="section-5.3.19.2-4">Note: In case several elliptic curves are supported, several id-ecPublicKey elements
as defined in <span>[<a href="#RFC5480" class="cite xref">RFC5480</a>]</span> need to be given, one per named curve.<a href="#section-5.3.19.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.3">
<section id="section-5.3.19.3">
            <h5 id="name-encryption-key-agreement-ke">
<a href="#section-5.3.19.3" class="section-number selfRef">5.3.19.3. </a><a href="#name-encryption-key-agreement-ke" class="section-name selfRef">Encryption/Key Agreement Key Pair Types</a>
            </h5>
<p id="section-5.3.19.3-1">This <span class="bcp14">MAY</span> be used by the client to get the list of encryption/key
agreement algorithms whose subject public key values the CA is
willing to certify.<a href="#section-5.3.19.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.3-2">
<pre>
  GenMsg:    {id-it 3}, &lt; absent &gt;
  GenRep:    {id-it 3}, SEQUENCE SIZE (1..MAX) OF
                          AlgorithmIdentifier
</pre><a href="#section-5.3.19.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.3-3">Note: In case several elliptic curves are supported, several id-ecPublicKey elements
as defined in <span>[<a href="#RFC5480" class="cite xref">RFC5480</a>]</span> need to be given, one per named curve.<a href="#section-5.3.19.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.4">
<section id="section-5.3.19.4">
            <h5 id="name-preferred-symmetric-algorit">
<a href="#section-5.3.19.4" class="section-number selfRef">5.3.19.4. </a><a href="#name-preferred-symmetric-algorit" class="section-name selfRef">Preferred Symmetric Algorithm</a>
            </h5>
<p id="section-5.3.19.4-1">This <span class="bcp14">MAY</span> be used by the client to get the CA-preferred symmetric
encryption algorithm for any confidential information that needs to
be exchanged between the EE and the CA (for example, if the EE wants
to send its private decryption key to the CA for archival purposes).<a href="#section-5.3.19.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.4-2">
<pre>
  GenMsg:    {id-it 4}, &lt; absent &gt;
  GenRep:    {id-it 4}, AlgorithmIdentifier
</pre><a href="#section-5.3.19.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.19.5">
<section id="section-5.3.19.5">
            <h5 id="name-updated-ca-key-pair">
<a href="#section-5.3.19.5" class="section-number selfRef">5.3.19.5. </a><a href="#name-updated-ca-key-pair" class="section-name selfRef">Updated CA Key Pair</a>
            </h5>
<p id="section-5.3.19.5-1">This <span class="bcp14">MAY</span> be used by the CA to announce a CA key update event.<a href="#section-5.3.19.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.5-2">
<pre>
  GenMsg:    {id-it 18}, RootCaKeyUpdateValue
</pre><a href="#section-5.3.19.5-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.5-3">See <a href="#sect-5.3.13" class="auto internal xref">Section 5.3.13</a> for details of CA key update announcements.<a href="#section-5.3.19.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.6">
<section id="section-5.3.19.6">
            <h5 id="name-crl">
<a href="#section-5.3.19.6" class="section-number selfRef">5.3.19.6. </a><a href="#name-crl" class="section-name selfRef">CRL</a>
            </h5>
<p id="section-5.3.19.6-1">This <span class="bcp14">MAY</span> be used by the client to get a copy of the latest CRL.<a href="#section-5.3.19.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.6-2">
<pre>
  GenMsg:    {id-it 6}, &lt; absent &gt;
  GenRep:    {id-it 6}, CertificateList
</pre><a href="#section-5.3.19.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.19.7">
<section id="section-5.3.19.7">
            <h5 id="name-unsupported-object-identifi">
<a href="#section-5.3.19.7" class="section-number selfRef">5.3.19.7. </a><a href="#name-unsupported-object-identifi" class="section-name selfRef">Unsupported Object Identifiers</a>
            </h5>
<p id="section-5.3.19.7-1">This is used by the server to return a list of object identifiers
that it does not recognize or support from the list submitted by the
client.<a href="#section-5.3.19.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.7-2">
<pre>
  GenRep:    {id-it 7}, SEQUENCE SIZE (1..MAX) OF OBJECT IDENTIFIER
</pre><a href="#section-5.3.19.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.19.8">
<section id="section-5.3.19.8">
            <h5 id="name-key-pair-parameters">
<a href="#section-5.3.19.8" class="section-number selfRef">5.3.19.8. </a><a href="#name-key-pair-parameters" class="section-name selfRef">Key Pair Parameters</a>
            </h5>
<p id="section-5.3.19.8-1">This <span class="bcp14">MAY</span> be used by the EE to request the domain parameters to use
for generating the key pair for certain public-key algorithms.  It
can be used, for example, to request the appropriate P, Q, and G to
generate the DH/DSA key, or to request a set of well-known elliptic
curves.<a href="#section-5.3.19.8-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.8-2">
<pre>
  GenMsg:    {id-it 10}, OBJECT IDENTIFIER -- (Algorithm object-id)
  GenRep:    {id-it 11}, AlgorithmIdentifier | &lt; absent &gt;
</pre><a href="#section-5.3.19.8-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.8-3">An absent infoValue in the GenRep indicates that the algorithm
specified in GenMsg is not supported.<a href="#section-5.3.19.8-3" class="pilcrow">¶</a></p>
<p id="section-5.3.19.8-4">EEs <span class="bcp14">MUST</span> ensure that the parameters are acceptable to it and that the
GenRep message is authenticated (to avoid substitution attacks).<a href="#section-5.3.19.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.9">
<section id="section-5.3.19.9">
            <h5 id="name-revocation-passphrase">
<a href="#section-5.3.19.9" class="section-number selfRef">5.3.19.9. </a><a href="#name-revocation-passphrase" class="section-name selfRef">Revocation Passphrase</a>
            </h5>
<p id="section-5.3.19.9-1">This <span class="bcp14">MAY</span> be used by the EE to send a passphrase to a CA/RA for the purpose
of authenticating a later revocation request (in the case that the appropriate
signing private key is no longer available to authenticate the request).
See <a href="#sect-b" class="auto internal xref">Appendix B</a> for further details on the use of this mechanism.<a href="#section-5.3.19.9-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.9-2">
<pre>
  GenMsg:    {id-it 12}, EncryptedKey
  GenRep:    {id-it 12}, &lt; absent &gt;
</pre><a href="#section-5.3.19.9-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.9-3">The use of EncryptedKey is described in <a href="#sect-5.2.2" class="auto internal xref">Section 5.2.2</a>.<a href="#section-5.3.19.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.10">
<section id="section-5.3.19.10">
            <h5 id="name-implicitconfirm-2">
<a href="#section-5.3.19.10" class="section-number selfRef">5.3.19.10. </a><a href="#name-implicitconfirm-2" class="section-name selfRef">ImplicitConfirm</a>
            </h5>
<p id="section-5.3.19.10-1">See <a href="#sect-5.1.1.1" class="auto internal xref">Section 5.1.1.1</a> for the definition and use of {id-it 13}.<a href="#section-5.3.19.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.11">
<section id="section-5.3.19.11">
            <h5 id="name-confirmwaittime-2">
<a href="#section-5.3.19.11" class="section-number selfRef">5.3.19.11. </a><a href="#name-confirmwaittime-2" class="section-name selfRef">ConfirmWaitTime</a>
            </h5>
<p id="section-5.3.19.11-1">See <a href="#sect-5.1.1.2" class="auto internal xref">Section 5.1.1.2</a> for the definition and use of {id-it 14}.<a href="#section-5.3.19.11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.12">
<section id="section-5.3.19.12">
            <h5 id="name-original-pkimessage">
<a href="#section-5.3.19.12" class="section-number selfRef">5.3.19.12. </a><a href="#name-original-pkimessage" class="section-name selfRef">Original PKIMessage</a>
            </h5>
<p id="section-5.3.19.12-1">See <a href="#sect-5.1.1.3" class="auto internal xref">Section 5.1.1.3</a> for the definition and use of {id-it 15}.<a href="#section-5.3.19.12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.13">
<section id="section-5.3.19.13">
            <h5 id="name-supported-language-tags">
<a href="#section-5.3.19.13" class="section-number selfRef">5.3.19.13. </a><a href="#name-supported-language-tags" class="section-name selfRef">Supported Language Tags</a>
            </h5>
<p id="section-5.3.19.13-1">This <span class="bcp14">MAY</span> be used to determine the appropriate <span>[<a href="#RFC5646" class="cite xref">RFC5646</a>]</span> language tag to use in
subsequent messages.  The sender sends its list of supported
languages (in order, most preferred to least); the receiver returns
the one it wishes to use.  (Note: each UTF8String <span class="bcp14">MUST</span> include a
language tag.)  If none of the offered tags are supported, an error
<span class="bcp14">MUST</span> be returned.<a href="#section-5.3.19.13-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.13-2">
<pre>
  GenMsg:    {id-it 16}, SEQUENCE SIZE (1..MAX) OF UTF8String
  GenRep:    {id-it 16}, SEQUENCE SIZE (1) OF UTF8String
</pre><a href="#section-5.3.19.13-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.19.14">
<section id="section-5.3.19.14">
            <h5 id="name-ca-certificates">
<a href="#section-5.3.19.14" class="section-number selfRef">5.3.19.14. </a><a href="#name-ca-certificates" class="section-name selfRef">CA Certificates</a>
            </h5>
<p id="section-5.3.19.14-1">This <span class="bcp14">MAY</span> be used by the client to get CA certificates.<a href="#section-5.3.19.14-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.14-2">
<pre>
  GenMsg:    {id-it 17}, &lt; absent &gt;
  GenRep:    {id-it 17}, SEQUENCE SIZE (1..MAX) OF
                           CMPCertificate | &lt; absent &gt;
</pre><a href="#section-5.3.19.14-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.19.15">
<section id="section-5.3.19.15">
            <h5 id="name-root-ca-update">
<a href="#section-5.3.19.15" class="section-number selfRef">5.3.19.15. </a><a href="#name-root-ca-update" class="section-name selfRef">Root CA Update</a>
            </h5>
<p id="section-5.3.19.15-1">This <span class="bcp14">MAY</span> be used by the client to get an update of a root CA certificate,
which is provided in the body of the request message.  In contrast to the
ckuann message, this approach follows the request/response model.<a href="#section-5.3.19.15-1" class="pilcrow">¶</a></p>
<p id="section-5.3.19.15-2">The EE <span class="bcp14">SHOULD</span> reference its current trust anchor in RootCaCertValue
in the request body, giving the root CA certificate if available.<a href="#section-5.3.19.15-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.15-3">
<pre>
  GenMsg:    {id-it 20}, RootCaCertValue | &lt; absent &gt;
  GenRep:    {id-it 18}, RootCaKeyUpdateValue | &lt; absent &gt;
</pre><a href="#section-5.3.19.15-3" class="pilcrow">¶</a>
</div>
<div class="lang-asn.1 sourcecode" id="section-5.3.19.15-4">
<pre>
  RootCaCertValue ::= CMPCertificate

  RootCaKeyUpdateValue ::= RootCaKeyUpdateContent

  RootCaKeyUpdateContent ::= SEQUENCE {
     newWithNew              CMPCertificate,
     newWithOld          [0] CMPCertificate OPTIONAL,
     oldWithNew          [1] CMPCertificate OPTIONAL
  }
</pre><a href="#section-5.3.19.15-4" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.15-5">Note: In contrast to CAKeyUpdAnnContent (which was deprecated with pvno cmp2021),
RootCaKeyUpdateContent offers omitting newWithOld and oldWithNew,
depending on the needs of the EE.<a href="#section-5.3.19.15-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.16">
<section id="section-5.3.19.16">
            <h5 id="name-certificate-request-templat">
<a href="#section-5.3.19.16" class="section-number selfRef">5.3.19.16. </a><a href="#name-certificate-request-templat" class="section-name selfRef">Certificate Request Template</a>
            </h5>
<p id="section-5.3.19.16-1">This <span class="bcp14">MAY</span> be used by the client to get a template containing requirements
for certificate request attributes and extensions. The controls id-regCtrl-algId
and id-regCtrl-rsaKeyLen <span class="bcp14">MAY</span> contain details on the types of subject public
keys the CA is willing to certify.<a href="#section-5.3.19.16-1" class="pilcrow">¶</a></p>
<p id="section-5.3.19.16-2">The id-regCtrl-algId control <span class="bcp14">MAY</span> be used to identify a cryptographic algorithm
(see Section 4.1.2.7 of <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>) other than rsaEncryption. The algorithm
field <span class="bcp14">SHALL</span> identify a cryptographic
algorithm. The contents of the optional parameters field will vary according
to the algorithm identified. For example, when the algorithm is set to id-ecPublicKey,
the parameters identify the elliptic curve to be used; see <span>[<a href="#RFC5480" class="cite xref">RFC5480</a>]</span>.<a href="#section-5.3.19.16-2" class="pilcrow">¶</a></p>
<p id="section-5.3.19.16-3">Note: The client may specify a profile name in the certProfile field, see <a href="#sect-5.1.1.4" class="auto internal xref">Section 5.1.1.4</a>.<a href="#section-5.3.19.16-3" class="pilcrow">¶</a></p>
<p id="section-5.3.19.16-4">The id-regCtrl-rsaKeyLen control <span class="bcp14">SHALL</span> be used for algorithm rsaEncryption
and <span class="bcp14">SHALL</span> contain the intended modulus bit length of the RSA key.<a href="#section-5.3.19.16-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.16-5">
<pre>
  GenMsg:    {id-it 19}, &lt; absent &gt;
  GenRep:    {id-it 19}, CertReqTemplateContent | &lt; absent &gt;
</pre><a href="#section-5.3.19.16-5" class="pilcrow">¶</a>
</div>
<div class="lang-asn.1 sourcecode" id="section-5.3.19.16-6">
<pre>
  CertReqTemplateValue  ::= CertReqTemplateContent

  CertReqTemplateContent ::= SEQUENCE {
     certTemplate           CertTemplate,
     keySpec                Controls OPTIONAL }

  Controls  ::= SEQUENCE SIZE (1..MAX) OF AttributeTypeAndValue

  id-regCtrl-algId OBJECT IDENTIFIER ::= { iso(1)
     identified-organization(3) dod(6) internet(1) security(5)
     mechanisms(5) pkix(7) pkip(5) regCtrl(1) 11 }

  AlgIdCtrl ::= AlgorithmIdentifier{ALGORITHM, {...}}

  id-regCtrl-rsaKeyLen OBJECT IDENTIFIER ::= { iso(1)
     identified-organization(3) dod(6) internet(1) security(5)
     mechanisms(5) pkix(7) pkip(5) regCtrl(1) 12 }

  RsaKeyLenCtrl ::= INTEGER (1..MAX)
</pre><a href="#section-5.3.19.16-6" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.16-7">The CertReqTemplateValue contains the prefilled certTemplate to be used for
a future certificate request.  The publicKey field in the certTemplate <span class="bcp14">MUST NOT</span> be used.  In case the PKI management entity wishes to specify supported
public-key algorithms, the keySpec field <span class="bcp14">MUST</span> be used.  One AttributeTypeAndValue
per supported algorithm or RSA key length <span class="bcp14">MUST</span> be used.<a href="#section-5.3.19.16-7" class="pilcrow">¶</a></p>
<p id="section-5.3.19.16-8">Note: The controls ASN.1 type is defined in Section 6 of CRMF <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span><a href="#section-5.3.19.16-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.19.17">
<section id="section-5.3.19.17">
            <h5 id="name-crl-update-retrieval">
<a href="#section-5.3.19.17" class="section-number selfRef">5.3.19.17. </a><a href="#name-crl-update-retrieval" class="section-name selfRef">CRL Update Retrieval</a>
            </h5>
<p id="section-5.3.19.17-1">This <span class="bcp14">MAY</span> be used by the client to get new CRLs, specifying the source of
the CRLs and the thisUpdate value of the latest CRL it already has, if available.
A CRL source is given either by a DistributionPointName or the GeneralNames
of the issuing CA.  The DistributionPointName should be treated as an internal
pointer to identify a CRL that the server already has and not as a way to
ask the server to fetch CRLs from external locations. The server <span class="bcp14">SHALL</span> only provide
those CRLs that are more recent than the ones indicated by the client.<a href="#section-5.3.19.17-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.17-2">
<pre>
  GenMsg:    {id-it 22}, SEQUENCE SIZE (1..MAX) OF CRLStatus
  GenRep:    {id-it 23}, SEQUENCE SIZE (1..MAX) OF
                           CertificateList  |  &lt; absent &gt;
</pre><a href="#section-5.3.19.17-2" class="pilcrow">¶</a>
</div>
<div class="lang-asn.1 sourcecode" id="section-5.3.19.17-3">
<pre>
  CRLSource ::= CHOICE {
     dpn          [0] DistributionPointName,
     issuer       [1] GeneralNames }

  CRLStatus ::= SEQUENCE {
     source       CRLSource,
     thisUpdate   Time OPTIONAL }
</pre><a href="#section-5.3.19.17-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-5.3.19.18">
<section id="section-5.3.19.18">
            <h5 id="name-kem-ciphertext">
<a href="#section-5.3.19.18" class="section-number selfRef">5.3.19.18. </a><a href="#name-kem-ciphertext" class="section-name selfRef">KEM Ciphertext</a>
            </h5>
<p id="section-5.3.19.18-1">This <span class="bcp14">MAY</span> be used by a PKI entity to get the KEM ciphertext for MAC-based message protection using KEM (see <a href="#sect-5.1.3.4" class="auto internal xref">Section 5.1.3.4</a>).<a href="#section-5.3.19.18-1" class="pilcrow">¶</a></p>
<p id="section-5.3.19.18-2">The PKI entity which possesses a KEM key pair can request the ciphertext by sending an InfoTypeAndValue structure of type KemCiphertextInfo where the infoValue is absent. The ciphertext can be provided in the following genp message with an InfoTypeAndValue structure of the same type.<a href="#section-5.3.19.18-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.3.19.18-3">
<pre>
  GenMsg:    {id-it TBD1}, &lt; absent &gt;
  GenRep:    {id-it TBD1}, KemCiphertextInfo
</pre><a href="#section-5.3.19.18-3" class="pilcrow">¶</a>
</div>
<div class="lang-asn.1 sourcecode" id="section-5.3.19.18-4">
<pre>
  KemCiphertextInfo ::= SEQUENCE {
    kem              AlgorithmIdentifier{KEM-ALGORITHM, {...}},
    ct               OCTET STRING
  }
</pre><a href="#section-5.3.19.18-4" class="pilcrow">¶</a>
</div>
<p id="section-5.3.19.18-5">kem is the algorithm identifier of the KEM algorithm, and any associated parameters, used to generate the ciphertext ct.<a href="#section-5.3.19.18-5" class="pilcrow">¶</a></p>
<p id="section-5.3.19.18-6">ct is the ciphertext output from the KEM Encapsulate function.<a href="#section-5.3.19.18-6" class="pilcrow">¶</a></p>
<p id="section-5.3.19.18-7">NOTE: These InfoTypeAndValue structures can also be transferred in the generalInfo field of the PKIHeader in messages of other types (see <a href="#sect-5.1.1.5" class="auto internal xref">Section 5.1.1.5</a>).<a href="#section-5.3.19.18-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5.3.20">
<section id="section-5.3.20">
          <h4 id="name-pki-general-response-conten">
<a href="#section-5.3.20" class="section-number selfRef">5.3.20. </a><a href="#name-pki-general-response-conten" class="section-name selfRef">PKI General Response Content</a>
          </h4>
<div class="lang-asn.1 sourcecode" id="section-5.3.20-1">
<pre>
  GenRepContent ::= SEQUENCE OF InfoTypeAndValue
</pre><a href="#section-5.3.20-1" class="pilcrow">¶</a>
</div>
<p id="section-5.3.20-2">Examples of GenReps that <span class="bcp14">MAY</span> be supported include those listed in the
subsections of <a href="#sect-5.3.19" class="auto internal xref">Section 5.3.19</a>.<a href="#section-5.3.20-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.21">
<section id="section-5.3.21">
          <h4 id="name-error-message-content">
<a href="#section-5.3.21" class="section-number selfRef">5.3.21. </a><a href="#name-error-message-content" class="section-name selfRef">Error Message Content</a>
          </h4>
<p id="section-5.3.21-1">This data structure <span class="bcp14">MAY</span> be used by EE, CA, or RA to convey error information and
by a PKI management entity to initiate delayed delivery of responses.<a href="#section-5.3.21-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.21-2">
<pre>
  ErrorMsgContent ::= SEQUENCE {
     pKIStatusInfo          PKIStatusInfo,
     errorCode              INTEGER           OPTIONAL,
     errorDetails           PKIFreeText       OPTIONAL
  }
</pre><a href="#section-5.3.21-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.21-3">This message <span class="bcp14">MAY</span> be generated at any time during a PKI transaction. If the
client sends this request, the server <span class="bcp14">MUST</span> respond with a PKIConfirm response,
or another ErrorMsg if any part of the header is not valid.<a href="#section-5.3.21-3" class="pilcrow">¶</a></p>
<p id="section-5.3.21-4">In case a PKI management entity sends an error message to the EE with the
pKIStatusInfo field containing the status "waiting", the EE <span class="bcp14">SHOULD</span> initiate
polling as described in <a href="#sect-5.3.22" class="auto internal xref">Section 5.3.22</a>.
If the EE does not initiate polling, both sides <span class="bcp14">MUST</span> treat this message
as the end of the transaction (if a transaction is in progress).<a href="#section-5.3.21-4" class="pilcrow">¶</a></p>
<p id="section-5.3.21-5">If protection is desired on the message, the client <span class="bcp14">MUST</span> protect it
using the same technique (i.e., signature or MAC) as the starting
message of the transaction.  The CA <span class="bcp14">MUST</span> always sign it with a
signature key.<a href="#section-5.3.21-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-5.3.22">
<section id="section-5.3.22">
          <h4 id="name-polling-request-and-respons">
<a href="#section-5.3.22" class="section-number selfRef">5.3.22. </a><a href="#name-polling-request-and-respons" class="section-name selfRef">Polling Request and Response</a>
          </h4>
<p id="section-5.3.22-1">This pair of messages is intended to handle scenarios in which the client
needs to poll the server to determine the status of an outstanding response
(i.e., when the "waiting" PKIStatus has been received).<a href="#section-5.3.22-1" class="pilcrow">¶</a></p>
<div class="lang-asn.1 sourcecode" id="section-5.3.22-2">
<pre>
  PollReqContent ::= SEQUENCE OF SEQUENCE {
     certReqId    INTEGER }

  PollRepContent ::= SEQUENCE OF SEQUENCE {
     certReqId    INTEGER,
     checkAfter   INTEGER,  -- time in seconds
     reason       PKIFreeText OPTIONAL }
</pre><a href="#section-5.3.22-2" class="pilcrow">¶</a>
</div>
<p id="section-5.3.22-3">Unless implicit confirmation has been requested and granted, in response to an ir, cr, p10cr, kur, krr, or ccr request message, polling is initiated
with an ip, cp, kup, krp, or ccp response message containing status "waiting". For
any type of request message, polling can be initiated with an error response
messages with status "waiting". The following clauses describe how polling
messages are used.  It is assumed that multiple certConf messages can be
sent during transactions.  There will be one sent in response to each ip,
cp, kup, krp, or ccp that contains a CertStatus for an issued certificate.<a href="#section-5.3.22-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-5.3.22-4">
<dt>1</dt>
<dd id="section-5.3.22-4.1">
              <p id="section-5.3.22-4.1.1">In response to an ip, cp, kup, krp, or ccp message, an EE will send a certConf for
  all issued certificates and expect a PKIconf for each certConf.  An EE will
  send a pollReq message in response to each CertResponse element of an ip,
  cp, or kup message with status "waiting" and in response to an error message
  with status "waiting".  Its certReqId <span class="bcp14">MUST</span> be either the index of a CertResponse
  data structure with status "waiting" or -1 referring to the complete response.<a href="#section-5.3.22-4.1.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>2</dt>
<dd id="section-5.3.22-4.2">
              <p id="section-5.3.22-4.2.1">In response to a pollReq, a CA/RA will return an ip, cp, kup, krp, or ccp if one or
  more of still pending requested certificates are ready or the final response
  to some other type of request is available; otherwise, it will return a pollRep.<a href="#section-5.3.22-4.2.1" class="pilcrow">¶</a></p>
</dd>
            <dd class="break"></dd>
<dt>3</dt>
<dd id="section-5.3.22-4.3">
              <p id="section-5.3.22-4.3.1">If the EE receives a pollRep, it will wait for at least the number of seconds
  given in the checkAfter field before sending another pollReq.<a href="#section-5.3.22-4.3.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.3.22-5.1">
              <p id="section-5.3.22-5.1.1">[RFC-Editor: Please fix the indentation. This note belongs to 3.] Note that the checkAfter value heavily depends on the certificate management
environment. There are different reasons for a delayed delivery of response
messages possible, e.g., high load on the server's backend, offline transfer of
messages between two PKI management entities, or required RA operator
approval. Therefore, the checkAfter time can vary greatly. This should also be
considered by the transfer protocol.<a href="#section-5.3.22-5.1.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<ol start="1" type="1" class="normal type-1" id="section-5.3.22-6">
<li id="section-5.3.22-6.1">
              <p id="section-5.3.22-6.1.1">[RFC-Editor: Please fix the enumeration and continue with '4'.] If the EE receives an ip, cp, kup, krp, or ccp, then it will be treated in the same
  way as the initial response; if it receives any other response, then this
  will be treated as the final response to the original request.<a href="#section-5.3.22-6.1.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.3.22-7">The following client-side state machine describes polling for individual
CertResponse elements at the example of an ir request message.<a href="#section-5.3.22-7" class="pilcrow">¶</a></p>
<div id="section-5.3.22-8">
            <div class="alignLeft art-svg artwork" id="section-5.3.22-8.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="464" width="504" viewBox="0 0 504 464" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 32,192 L 32,224" fill="none" stroke="black"></path>
                <path d="M 176,384 L 176,416" fill="none" stroke="black"></path>
                <path d="M 240,48 L 240,64" fill="none" stroke="black"></path>
                <path d="M 240,96 L 240,112" fill="none" stroke="black"></path>
                <path d="M 240,176 L 240,224" fill="none" stroke="black"></path>
                <path d="M 320,384 L 320,416" fill="none" stroke="black"></path>
                <path d="M 352,336 L 352,352" fill="none" stroke="black"></path>
                <path d="M 352,384 L 352,416" fill="none" stroke="black"></path>
                <path d="M 400,192 L 400,224" fill="none" stroke="black"></path>
                <path d="M 480,384 L 480,416" fill="none" stroke="black"></path>
                <path d="M 496,144 L 496,336" fill="none" stroke="black"></path>
                <path d="M 296,144 L 496,144" fill="none" stroke="black"></path>
                <path d="M 32,192 L 232,192" fill="none" stroke="black"></path>
                <path d="M 248,192 L 400,192" fill="none" stroke="black"></path>
                <path d="M 72,240 L 160,240" fill="none" stroke="black"></path>
                <path d="M 328,240 L 376,240" fill="none" stroke="black"></path>
                <path d="M 352,336 L 496,336" fill="none" stroke="black"></path>
                <path d="M 72,368 L 104,368" fill="none" stroke="black"></path>
                <path d="M 384,368 L 464,368" fill="none" stroke="black"></path>
                <path d="M 176,416 L 320,416" fill="none" stroke="black"></path>
                <path d="M 352,416 L 480,416" fill="none" stroke="black"></path>
                <path d="M 248,272 L 288,352" fill="none" stroke="black"></path>
                <path d="M 192,352 L 232,272" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="472,368 460,362.4 460,373.6" fill="black" transform="rotate(0,464,368)"></polygon>
                <polygon class="arrowhead" points="384,240 372,234.4 372,245.6" fill="black" transform="rotate(0,376,240)"></polygon>
                <polygon class="arrowhead" points="360,384 348,378.4 348,389.6" fill="black" transform="rotate(270,352,384)"></polygon>
                <polygon class="arrowhead" points="328,384 316,378.4 316,389.6" fill="black" transform="rotate(270,320,384)"></polygon>
                <polygon class="arrowhead" points="304,144 292,138.4 292,149.6" fill="black" transform="rotate(180,296,144)"></polygon>
                <polygon class="arrowhead" points="296,352 284,346.4 284,357.6" fill="black" transform="rotate(63.43494882292201,288,352)"></polygon>
                <polygon class="arrowhead" points="256,192 244,186.4 244,197.6" fill="black" transform="rotate(180,248,192)"></polygon>
                <polygon class="arrowhead" points="248,224 236,218.4 236,229.6" fill="black" transform="rotate(90,240,224)"></polygon>
                <polygon class="arrowhead" points="248,112 236,106.4 236,117.6" fill="black" transform="rotate(90,240,112)"></polygon>
                <polygon class="arrowhead" points="248,64 236,58.4 236,69.6" fill="black" transform="rotate(90,240,64)"></polygon>
                <polygon class="arrowhead" points="240,192 228,186.4 228,197.6" fill="black" transform="rotate(0,232,192)"></polygon>
                <polygon class="arrowhead" points="200,352 188,346.4 188,357.6" fill="black" transform="rotate(116.56505117707799,192,352)"></polygon>
                <polygon class="arrowhead" points="80,368 68,362.4 68,373.6" fill="black" transform="rotate(180,72,368)"></polygon>
                <polygon class="arrowhead" points="80,240 68,234.4 68,245.6" fill="black" transform="rotate(180,72,240)"></polygon>
                <g class="text">
                  <text x="240" y="36">START</text>
                  <text x="228" y="84">Send</text>
                  <text x="260" y="84">ir</text>
                  <text x="260" y="100">ip</text>
                  <text x="216" y="132">Check</text>
                  <text x="268" y="132">status</text>
                  <text x="204" y="148">of</text>
                  <text x="252" y="148">returned</text>
                  <text x="240" y="164">certs</text>
                  <text x="132" y="228">(issued)</text>
                  <text x="336" y="228">(waiting)</text>
                  <text x="24" y="244">Add</text>
                  <text x="52" y="244">to</text>
                  <text x="192" y="244">Check</text>
                  <text x="268" y="244">CertResponse</text>
                  <text x="400" y="244">Add</text>
                  <text x="428" y="244">to</text>
                  <text x="20" y="260">conf</text>
                  <text x="60" y="260">list</text>
                  <text x="176" y="260">for</text>
                  <text x="212" y="260">each</text>
                  <text x="280" y="260">certificate</text>
                  <text x="400" y="260">pending</text>
                  <text x="452" y="260">list</text>
                  <text x="300" y="292">(empty</text>
                  <text x="348" y="292">conf</text>
                  <text x="392" y="292">list)</text>
                  <text x="136" y="308">(conf</text>
                  <text x="184" y="308">list)</text>
                  <text x="396" y="324">ip</text>
                  <text x="44" y="356">(empty</text>
                  <text x="104" y="356">pending</text>
                  <text x="160" y="356">list)</text>
                  <text x="416" y="356">pollRep</text>
                  <text x="48" y="372">END</text>
                  <text x="132" y="372">Send</text>
                  <text x="188" y="372">certConf</text>
                  <text x="300" y="372">Send</text>
                  <text x="352" y="372">pollReq</text>
                  <text x="484" y="372">Wait</text>
                  <text x="228" y="436">(pending</text>
                  <text x="288" y="436">list)</text>
                </g>
              </svg><a href="#section-5.3.22-8.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.3.22-9">In the following exchange, the end entity is enrolling for two certificates
in one request.<a href="#section-5.3.22-9" class="pilcrow">¶</a></p>
<div id="section-5.3.22-10">
            <div class="alignLeft art-svg artwork" id="section-5.3.22-10.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="672" width="560" viewBox="0 0 560 672" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 552,48" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="24" y="36">Step#</text>
                  <text x="64" y="36">End</text>
                  <text x="108" y="36">Entity</text>
                  <text x="328" y="36">PKI</text>
                  <text x="24" y="68">1</text>
                  <text x="76" y="68">format</text>
                  <text x="116" y="68">ir</text>
                  <text x="24" y="84">2</text>
                  <text x="196" y="84">-&gt;</text>
                  <text x="220" y="84">ir</text>
                  <text x="284" y="84">-&gt;</text>
                  <text x="24" y="100">3</text>
                  <text x="340" y="100">handle</text>
                  <text x="380" y="100">ir</text>
                  <text x="24" y="116">4</text>
                  <text x="340" y="116">manual</text>
                  <text x="420" y="116">intervention</text>
                  <text x="484" y="116">is</text>
                  <text x="364" y="132">required</text>
                  <text x="416" y="132">for</text>
                  <text x="452" y="132">both</text>
                  <text x="496" y="132">certs</text>
                  <text x="24" y="148">5</text>
                  <text x="196" y="148">&lt;-</text>
                  <text x="220" y="148">ip</text>
                  <text x="284" y="148">&lt;-</text>
                  <text x="24" y="164">6</text>
                  <text x="80" y="164">process</text>
                  <text x="124" y="164">ip</text>
                  <text x="24" y="180">7</text>
                  <text x="76" y="180">format</text>
                  <text x="136" y="180">pollReq</text>
                  <text x="24" y="196">8</text>
                  <text x="196" y="196">-&gt;</text>
                  <text x="240" y="196">pollReq</text>
                  <text x="292" y="196">-&gt;</text>
                  <text x="24" y="212">9</text>
                  <text x="336" y="212">check</text>
                  <text x="388" y="212">status</text>
                  <text x="428" y="212">of</text>
                  <text x="460" y="212">cert</text>
                  <text x="520" y="212">requests,</text>
                  <text x="380" y="228">certificates</text>
                  <text x="448" y="228">not</text>
                  <text x="488" y="228">ready</text>
                  <text x="20" y="244">10</text>
                  <text x="340" y="244">format</text>
                  <text x="400" y="244">pollRep</text>
                  <text x="20" y="260">11</text>
                  <text x="196" y="260">&lt;-</text>
                  <text x="240" y="260">pollRep</text>
                  <text x="292" y="260">&lt;-</text>
                  <text x="20" y="276">12</text>
                  <text x="68" y="276">wait</text>
                  <text x="20" y="292">13</text>
                  <text x="76" y="292">format</text>
                  <text x="136" y="292">pollReq</text>
                  <text x="20" y="308">14</text>
                  <text x="196" y="308">-&gt;</text>
                  <text x="240" y="308">pollReq</text>
                  <text x="292" y="308">-&gt;</text>
                  <text x="20" y="324">15</text>
                  <text x="336" y="324">check</text>
                  <text x="388" y="324">status</text>
                  <text x="428" y="324">of</text>
                  <text x="460" y="324">cert</text>
                  <text x="520" y="324">requests,</text>
                  <text x="344" y="340">one</text>
                  <text x="408" y="340">certificate</text>
                  <text x="468" y="340">is</text>
                  <text x="504" y="340">ready</text>
                  <text x="20" y="356">16</text>
                  <text x="340" y="356">format</text>
                  <text x="380" y="356">ip</text>
                  <text x="20" y="372">17</text>
                  <text x="196" y="372">&lt;-</text>
                  <text x="220" y="372">ip</text>
                  <text x="292" y="372">&lt;-</text>
                  <text x="20" y="388">18</text>
                  <text x="76" y="388">handle</text>
                  <text x="116" y="388">ip</text>
                  <text x="20" y="404">19</text>
                  <text x="76" y="404">format</text>
                  <text x="140" y="404">certConf</text>
                  <text x="20" y="420">20</text>
                  <text x="196" y="420">-&gt;</text>
                  <text x="244" y="420">certConf</text>
                  <text x="292" y="420">-&gt;</text>
                  <text x="20" y="436">21</text>
                  <text x="340" y="436">handle</text>
                  <text x="404" y="436">certConf</text>
                  <text x="20" y="452">22</text>
                  <text x="340" y="452">format</text>
                  <text x="384" y="452">ack</text>
                  <text x="20" y="468">23</text>
                  <text x="196" y="468">&lt;-</text>
                  <text x="240" y="468">pkiConf</text>
                  <text x="300" y="468">&lt;-</text>
                  <text x="20" y="484">24</text>
                  <text x="76" y="484">format</text>
                  <text x="136" y="484">pollReq</text>
                  <text x="20" y="500">25</text>
                  <text x="196" y="500">-&gt;</text>
                  <text x="240" y="500">pollReq</text>
                  <text x="292" y="500">-&gt;</text>
                  <text x="20" y="516">26</text>
                  <text x="336" y="516">check</text>
                  <text x="388" y="516">status</text>
                  <text x="428" y="516">of</text>
                  <text x="492" y="516">certificate,</text>
                  <text x="376" y="532">certificate</text>
                  <text x="436" y="532">is</text>
                  <text x="472" y="532">ready</text>
                  <text x="20" y="548">27</text>
                  <text x="340" y="548">format</text>
                  <text x="380" y="548">ip</text>
                  <text x="20" y="564">28</text>
                  <text x="196" y="564">&lt;-</text>
                  <text x="220" y="564">ip</text>
                  <text x="292" y="564">&lt;-</text>
                  <text x="20" y="580">29</text>
                  <text x="76" y="580">handle</text>
                  <text x="116" y="580">ip</text>
                  <text x="20" y="596">30</text>
                  <text x="76" y="596">format</text>
                  <text x="140" y="596">certConf</text>
                  <text x="20" y="612">31</text>
                  <text x="196" y="612">-&gt;</text>
                  <text x="244" y="612">certConf</text>
                  <text x="292" y="612">-&gt;</text>
                  <text x="20" y="628">32</text>
                  <text x="340" y="628">handle</text>
                  <text x="404" y="628">certConf</text>
                  <text x="20" y="644">33</text>
                  <text x="340" y="644">format</text>
                  <text x="384" y="644">ack</text>
                  <text x="20" y="660">34</text>
                  <text x="196" y="660">&lt;-</text>
                  <text x="240" y="660">pkiConf</text>
                  <text x="292" y="660">&lt;-</text>
                </g>
              </svg><a href="#section-5.3.22-10.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.3.22-11">The following client-side state machine describes polling for a complete
response message.<a href="#section-5.3.22-11" class="pilcrow">¶</a></p>
<div id="section-5.3.22-12">
            <div class="alignLeft art-svg artwork" id="section-5.3.22-12.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="416" width="520" viewBox="0 0 520 416" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,192 L 8,288" fill="none" stroke="black"></path>
                <path d="M 104,96 L 104,176" fill="none" stroke="black"></path>
                <path d="M 104,208 L 104,288" fill="none" stroke="black"></path>
                <path d="M 272,48 L 272,80" fill="none" stroke="black"></path>
                <path d="M 272,288 L 272,320" fill="none" stroke="black"></path>
                <path d="M 272,352 L 272,368" fill="none" stroke="black"></path>
                <path d="M 440,96 L 440,288" fill="none" stroke="black"></path>
                <path d="M 104,96 L 192,96" fill="none" stroke="black"></path>
                <path d="M 344,96 L 440,96" fill="none" stroke="black"></path>
                <path d="M 8,192 L 64,192" fill="none" stroke="black"></path>
                <path d="M 8,288 L 264,288" fill="none" stroke="black"></path>
                <path d="M 280,288 L 440,288" fill="none" stroke="black"></path>
                <polygon class="arrowhead" points="288,288 276,282.4 276,293.6" fill="black" transform="rotate(180,280,288)"></polygon>
                <polygon class="arrowhead" points="280,368 268,362.4 268,373.6" fill="black" transform="rotate(90,272,368)"></polygon>
                <polygon class="arrowhead" points="280,320 268,314.4 268,325.6" fill="black" transform="rotate(90,272,320)"></polygon>
                <polygon class="arrowhead" points="272,288 260,282.4 260,293.6" fill="black" transform="rotate(0,264,288)"></polygon>
                <polygon class="arrowhead" points="112,176 100,170.4 100,181.6" fill="black" transform="rotate(90,104,176)"></polygon>
                <polygon class="arrowhead" points="72,192 60,186.4 60,197.6" fill="black" transform="rotate(0,64,192)"></polygon>
                <g class="text">
                  <text x="272" y="36">Start</text>
                  <text x="300" y="68">Send</text>
                  <text x="352" y="68">request</text>
                  <text x="232" y="100">Receive</text>
                  <text x="300" y="100">response</text>
                  <text x="208" y="132">ip/cp/kup/krp/ccp/error</text>
                  <text x="324" y="132">with</text>
                  <text x="472" y="132">other</text>
                  <text x="140" y="148">status</text>
                  <text x="208" y="148">"waiting"</text>
                  <text x="484" y="148">response</text>
                  <text x="104" y="196">Polling</text>
                  <text x="132" y="228">Send</text>
                  <text x="184" y="228">pollReq</text>
                  <text x="144" y="244">Receive</text>
                  <text x="212" y="244">response</text>
                  <text x="64" y="276">pollRep</text>
                  <text x="136" y="276">other</text>
                  <text x="196" y="276">response</text>
                  <text x="244" y="340">Handle</text>
                  <text x="308" y="340">response</text>
                  <text x="272" y="388">End</text>
                </g>
              </svg><a href="#section-5.3.22-12.1" class="pilcrow">¶</a>
</div>
</div>
<p id="section-5.3.22-13">In the following exchange, the end entity is sending a general message request,
and the response is delayed by the server.<a href="#section-5.3.22-13" class="pilcrow">¶</a></p>
<div id="section-5.3.22-14">
            <div class="alignLeft art-svg artwork" id="section-5.3.22-14.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="448" width="560" viewBox="0 0 560 448" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                <path d="M 8,48 L 552,48" fill="none" stroke="black"></path>
                <g class="text">
                  <text x="24" y="36">Step#</text>
                  <text x="64" y="36">End</text>
                  <text x="108" y="36">Entity</text>
                  <text x="328" y="36">PKI</text>
                  <text x="24" y="68">1</text>
                  <text x="76" y="68">format</text>
                  <text x="124" y="68">genm</text>
                  <text x="24" y="84">2</text>
                  <text x="180" y="84">-&gt;</text>
                  <text x="212" y="84">genm</text>
                  <text x="276" y="84">-&gt;</text>
                  <text x="24" y="100">3</text>
                  <text x="316" y="100">handle</text>
                  <text x="364" y="100">genm</text>
                  <text x="24" y="116">4</text>
                  <text x="312" y="116">delay</text>
                  <text x="348" y="116">in</text>
                  <text x="396" y="116">response</text>
                  <text x="444" y="116">is</text>
                  <text x="496" y="116">necessary</text>
                  <text x="24" y="132">5</text>
                  <text x="316" y="132">format</text>
                  <text x="368" y="132">error</text>
                  <text x="424" y="132">message</text>
                  <text x="496" y="132">"waiting"</text>
                  <text x="324" y="148">with</text>
                  <text x="384" y="148">certReqId</text>
                  <text x="440" y="148">set</text>
                  <text x="468" y="148">to</text>
                  <text x="492" y="148">-1</text>
                  <text x="24" y="164">6</text>
                  <text x="188" y="164">&lt;-</text>
                  <text x="224" y="164">error</text>
                  <text x="276" y="164">&lt;-</text>
                  <text x="24" y="180">7</text>
                  <text x="80" y="180">process</text>
                  <text x="136" y="180">error</text>
                  <text x="24" y="196">8</text>
                  <text x="76" y="196">format</text>
                  <text x="136" y="196">pollReq</text>
                  <text x="24" y="212">9</text>
                  <text x="188" y="212">-&gt;</text>
                  <text x="232" y="212">pollReq</text>
                  <text x="276" y="212">-&gt;</text>
                  <text x="20" y="228">10</text>
                  <text x="312" y="228">check</text>
                  <text x="364" y="228">status</text>
                  <text x="404" y="228">of</text>
                  <text x="452" y="228">original</text>
                  <text x="524" y="228">request,</text>
                  <text x="336" y="244">general</text>
                  <text x="400" y="244">message</text>
                  <text x="468" y="244">response</text>
                  <text x="520" y="244">not</text>
                  <text x="328" y="260">ready</text>
                  <text x="20" y="276">11</text>
                  <text x="316" y="276">format</text>
                  <text x="376" y="276">pollRep</text>
                  <text x="20" y="292">12</text>
                  <text x="188" y="292">&lt;-</text>
                  <text x="232" y="292">pollRep</text>
                  <text x="276" y="292">&lt;-</text>
                  <text x="20" y="308">13</text>
                  <text x="68" y="308">wait</text>
                  <text x="20" y="324">14</text>
                  <text x="76" y="324">format</text>
                  <text x="136" y="324">pollReq</text>
                  <text x="20" y="340">15</text>
                  <text x="188" y="340">-&gt;</text>
                  <text x="232" y="340">pollReq</text>
                  <text x="276" y="340">-&gt;</text>
                  <text x="20" y="356">16</text>
                  <text x="312" y="356">check</text>
                  <text x="364" y="356">status</text>
                  <text x="404" y="356">of</text>
                  <text x="452" y="356">original</text>
                  <text x="524" y="356">request,</text>
                  <text x="336" y="372">general</text>
                  <text x="400" y="372">message</text>
                  <text x="468" y="372">response</text>
                  <text x="516" y="372">is</text>
                  <text x="328" y="388">ready</text>
                  <text x="20" y="404">17</text>
                  <text x="316" y="404">format</text>
                  <text x="364" y="404">genp</text>
                  <text x="20" y="420">18</text>
                  <text x="188" y="420">&lt;-</text>
                  <text x="220" y="420">genp</text>
                  <text x="276" y="420">&lt;-</text>
                  <text x="20" y="436">19</text>
                  <text x="76" y="436">handle</text>
                  <text x="124" y="436">genp</text>
                </g>
              </svg><a href="#section-5.3.22-14.1" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-6">
<section id="section-6">
      <h2 id="name-mandatory-pki-management-fu">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-mandatory-pki-management-fu" class="section-name selfRef">Mandatory PKI Management Functions</a>
      </h2>
<p id="section-6-1">Some of the PKI management functions outlined in <a href="#sect-3.1" class="auto internal xref">Section 3.1</a> are
described in this section.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This section deals with functions that are "mandatory" in the sense
that all end entity and CA/RA implementations <span class="bcp14">MUST</span> be able to provide
the functionality described.  This part is effectively the profile of
the PKI management functionality that <span class="bcp14">MUST</span> be supported.  Note,
however, that the management functions described in this section do
not need to be accomplished using the PKI messages defined in <a href="#sect-5" class="auto internal xref">Section 5</a>
if alternate means are suitable for a given environment. See
<span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> Section 7 and <a href="#sect-c" class="auto internal xref">Appendix C</a> for profiles of the PKIMessage structures
that <span class="bcp14">MUST</span> be supported for specific use cases.<a href="#section-6-2" class="pilcrow">¶</a></p>
<div id="sect-6.1">
<section id="section-6.1">
        <h3 id="name-root-ca-initialization">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-root-ca-initialization" class="section-name selfRef">Root CA Initialization</a>
        </h3>
<p id="section-6.1-1">[See <a href="#sect-3.1.1.2" class="auto internal xref">Section 3.1.1.2</a> for this document's definition of "root CA".]<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">A newly created root CA must produce a "self-certificate", which is a
Certificate structure with the profile defined for the "newWithNew"
certificate issued following a root CA key update.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">In order to make the CA's self certificate useful to end entities
that do not acquire the self certificate via "out-of-band" means, the
CA must also produce a fingerprint for its certificate.  End entities
that acquire this fingerprint securely via some "out-of-band" means
can then verify the CA's self-certificate and, hence, the other
attributes contained therein.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">The data structure used to carry the fingerprint may be the OOBCertHash, see <a href="#sect-5.2.5" class="auto internal xref">Section 5.2.5</a>.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6.2">
<section id="section-6.2">
        <h3 id="name-root-ca-key-update-2">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-root-ca-key-update-2" class="section-name selfRef">Root CA Key Update</a>
        </h3>
<p id="section-6.2-1">CA keys (as all other keys) have a finite lifetime and will have to
be updated on a periodic basis.  The certificates NewWithNew,
NewWithOld, and OldWithNew (see <a href="#sect-4.4.1" class="auto internal xref">Section 4.4.1</a>) <span class="bcp14">MAY</span> be issued by the
CA to aid existing end entities who hold the current self-signed CA
certificate (OldWithOld) to transition securely to the new self-signed
CA certificate (NewWithNew), and to aid new end entities who
will hold NewWithNew to acquire OldWithOld securely for verification
of existing data.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6.3">
<section id="section-6.3">
        <h3 id="name-subordinate-ca-initializati">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-subordinate-ca-initializati" class="section-name selfRef">Subordinate CA Initialization</a>
        </h3>
<p id="section-6.3-1">[See <a href="#sect-3.1.1.2" class="auto internal xref">Section 3.1.1.2</a> for this document's definition of "subordinate CA".]<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">From the perspective of PKI management protocols, the initialization of a
subordinate CA is the same as the initialization of an end entity.  The only
difference is that the subordinate CA must also produce an initial revocation
list.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6.4">
<section id="section-6.4">
        <h3 id="name-crl-production">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-crl-production" class="section-name selfRef">CRL production</a>
        </h3>
<p id="section-6.4-1">Before issuing any certificates, a newly established CA (which issues
CRLs) must produce "empty" versions of each CRL which are to be
periodically produced.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6.5">
<section id="section-6.5">
        <h3 id="name-pki-information-request">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-pki-information-request" class="section-name selfRef">PKI Information Request</a>
        </h3>
<p id="section-6.5-1">When a PKI entity (CA, RA, or EE) wishes to acquire information about
the current status of a CA, it <span class="bcp14">MAY</span> send that CA a request for such
information.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">The CA <span class="bcp14">MUST</span> respond to the request by providing (at least) all of the
information requested by the requester.  If some of the information
cannot be provided, then an error must be conveyed to the requester.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">If PKIMessages are used to request and supply this PKI information,
then the request <span class="bcp14">MUST</span> be the GenMsg message, the response <span class="bcp14">MUST</span> be the
GenRep message, and the error <span class="bcp14">MUST</span> be the Error message.  These
messages are protected using a MAC based on shared secret information
(e.g., password-based MAC, see CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span> Section 6.1) or using any asymmetric authentication means such as a
signature (if the end entity has an existing certificate).<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6.6">
<section id="section-6.6">
        <h3 id="name-cross-certification">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-cross-certification" class="section-name selfRef">Cross Certification</a>
        </h3>
<p id="section-6.6-1">The requester CA is the CA that will become the subject of the
cross-certificate; the responder CA will become the issuer of the
cross-certificate.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">The requester CA must be "up and running" before initiating the
cross-certification operation.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
<div id="sect-6.6.1">
<section id="section-6.6.1">
          <h4 id="name-one-way-request-response-sc">
<a href="#section-6.6.1" class="section-number selfRef">6.6.1. </a><a href="#name-one-way-request-response-sc" class="section-name selfRef">One-Way Request-Response Scheme:</a>
          </h4>
<p id="section-6.6.1-1">The cross-certification scheme is essentially a one way operation;
that is, when successful, this operation results in the creation of
one new cross-certificate.  If the requirement is that cross-certificates
be created in "both directions", then each CA, in turn,
must initiate a cross-certification operation (or use another
scheme).<a href="#section-6.6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.6.1-2">This scheme is suitable where the two CAs in question can already
verify each other's signatures (they have some common points of
trust) or where there is an out-of-band verification of the origin of
the certification request.<a href="#section-6.6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.6.1-3">Detailed Description:<a href="#section-6.6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.6.1-4">Cross certification is initiated at one CA known as the responder.
The CA administrator for the responder identifies the CA it wants to
cross certify and the responder CA equipment generates an
authorization code.  The responder CA administrator passes this
authorization code by out-of-band means to the requester CA
administrator.  The requester CA administrator enters the
authorization code at the requester CA in order to initiate the
on-line exchange.<a href="#section-6.6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.6.1-5">The authorization code is used for authentication and integrity
purposes.  This is done by generating a symmetric key based on the
authorization code and using the symmetric key for generating Message
Authentication Codes (MACs) on all messages exchanged.
(Authentication may alternatively be done using signatures instead of
MACs, if the CAs are able to retrieve and validate the required
public keys by some means, such as an out-of-band hash comparison.)<a href="#section-6.6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.6.1-6">The requester CA initiates the exchange by generating a cross-certification
request (ccr) with a fresh random number (requester random number).
The requester CA then sends the ccr message to the responder CA.
The fields in this message are protected from modification with a
MAC based on the authorization code.<a href="#section-6.6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.6.1-7">Upon receipt of the ccr message, the responder CA validates the
message and the MAC, saves the requester random number, and generates
its own random number (responder random number).  It then generates
(and archives, if desired) a new requester certificate that contains
the requester CA public key and is signed with the responder CA
signature private key.  The responder CA responds with the cross
certification response (ccp) message.  The fields in this message are
protected from modification with a MAC based on the authorization
code.<a href="#section-6.6.1-7" class="pilcrow">¶</a></p>
<p id="section-6.6.1-8">Upon receipt of the ccp message, the requester CA validates the
message (including the received random numbers) and the MAC.  The
requester CA responds with the certConf message.  The fields in this
message are protected from modification with a MAC based on the
authorization code.  The requester CA <span class="bcp14">MAY</span> write the requester
certificate to the Repository as an aid to later certificate path
construction.<a href="#section-6.6.1-8" class="pilcrow">¶</a></p>
<p id="section-6.6.1-9">Upon receipt of the certConf message, the responder CA validates the
message and the MAC, and sends back an acknowledgement using the
PKIConfirm message.  It <span class="bcp14">MAY</span> also publish the requester certificate as
an aid to later path construction.<a href="#section-6.6.1-9" class="pilcrow">¶</a></p>
<p id="section-6.6.1-10">Notes:<a href="#section-6.6.1-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.6.1-11">
<li id="section-6.6.1-11.1">
              <p id="section-6.6.1-11.1.1">The ccr message must contain a "complete" certification request;
  that is, all fields except the serial number (including, e.g., a
  BasicConstraints extension) must be specified by the requester
  CA.<a href="#section-6.6.1-11.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-6.6.1-11.2">
              <p id="section-6.6.1-11.2.1">The ccp message <span class="bcp14">SHOULD</span> contain the verification certificate of
  the responder CA; if present, the requester CA must then verify
  this certificate (for example, via the "out-of-band" mechanism).<a href="#section-6.6.1-11.2.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-6.6.1-12">(A simpler, non-interactive model of cross-certification may also be
envisioned, in which the issuing CA acquires the subject CA's public
key from some repository, verifies it via some out-of-band mechanism,
and creates and publishes the cross-certificate without the subject
CA's explicit involvement.  This model may be perfectly legitimate
for many environments, but since it does not require any protocol
message exchanges, its detailed description is outside the scope of
this specification.)<a href="#section-6.6.1-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-6.7">
<section id="section-6.7">
        <h3 id="name-end-entity-initialization-2">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-end-entity-initialization-2" class="section-name selfRef">End Entity Initialization</a>
        </h3>
<p id="section-6.7-1">As with CAs, end entities must be initialized.  Initialization of end
entities requires at least two steps:<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7-2.1">
            <p id="section-6.7-2.1.1">acquisition of PKI information<a href="#section-6.7-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.7-2.2">
            <p id="section-6.7-2.2.1">out-of-band verification of one root-CA public key<a href="#section-6.7-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.7-3">(other possible steps include the retrieval of trust condition
information and/or out-of-band verification of other CA public keys).<a href="#section-6.7-3" class="pilcrow">¶</a></p>
<div id="sect-6.7.1">
<section id="section-6.7.1">
          <h4 id="name-acquisition-of-pki-informat">
<a href="#section-6.7.1" class="section-number selfRef">6.7.1. </a><a href="#name-acquisition-of-pki-informat" class="section-name selfRef">Acquisition of PKI Information</a>
          </h4>
<p id="section-6.7.1-1">The information <span class="bcp14">REQUIRED</span> is:<a href="#section-6.7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1-2.1">
              <p id="section-6.7.1-2.1.1">the current root-CA public key<a href="#section-6.7.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.7.1-2.2">
              <p id="section-6.7.1-2.2.1">(if the certifying CA is not a root-CA) the certification path
from the root CA to the certifying CA together with appropriate
revocation lists<a href="#section-6.7.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-6.7.1-2.3">
              <p id="section-6.7.1-2.3.1">the algorithms and algorithm parameters that the certifying CA
supports for each relevant usage<a href="#section-6.7.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-6.7.1-3">Additional information could be required (e.g., supported extensions
or CA policy information) in order to produce a certification request
that will be successful.  However, for simplicity we do not mandate
that the end entity acquires this information via the PKI messages.
The end result is simply that some certification requests may fail
(e.g., if the end entity wants to generate its own encryption key,
but the CA doesn't allow that).<a href="#section-6.7.1-3" class="pilcrow">¶</a></p>
<p id="section-6.7.1-4">The required information <span class="bcp14">MAY</span> be acquired as described in <a href="#sect-6.5" class="auto internal xref">Section 6.5</a>.<a href="#section-6.7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6.7.2">
<section id="section-6.7.2">
          <h4 id="name-out-of-band-verification-of">
<a href="#section-6.7.2" class="section-number selfRef">6.7.2. </a><a href="#name-out-of-band-verification-of" class="section-name selfRef">Out-of-Band Verification of Root-CA Key</a>
          </h4>
<p id="section-6.7.2-1">An end entity must securely possess the public key of its root CA.
One method to achieve this is to provide the end entity with the CA's
self-certificate fingerprint via some secure "out-of-band" means.
The end entity can then securely use the CA's self-certificate.<a href="#section-6.7.2-1" class="pilcrow">¶</a></p>
<p id="section-6.7.2-2">See <a href="#sect-6.1" class="auto internal xref">Section 6.1</a> for further details.<a href="#section-6.7.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-6.8">
<section id="section-6.8">
        <h3 id="name-certificate-request">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-certificate-request" class="section-name selfRef">Certificate Request</a>
        </h3>
<p id="section-6.8-1">An initialized end entity <span class="bcp14">MAY</span> request an additional certificate at
any time (for any purpose).  This request will be made using the
certification request (cr) message.  If the end entity already
possesses a signing key pair (with a corresponding verification
certificate), then this cr message will typically be protected by the
entity's digital signature.  The CA returns the new certificate (if
the request is successful) in a CertRepMessage.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6.9">
<section id="section-6.9">
        <h3 id="name-key-update">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-key-update" class="section-name selfRef">Key Update</a>
        </h3>
<p id="section-6.9-1">When a key pair is due to expire, the relevant end entity <span class="bcp14">MAY</span> request
a key update; that is, it <span class="bcp14">MAY</span> request that the CA issue a new
certificate for a new key pair (or, in certain circumstances, a new
certificate for the same key pair).  The request is made using a key
update request (kur) message (referred to, in some environments, as a
"Certificate Update" operation).  If the end entity already possesses
a signing key pair (with a corresponding verification certificate),
then this message will typically be protected by the entity's digital
signature.  The CA returns the new certificate (if the request is
successful) in a key update response (kup) message, which is
syntactically identical to a CertRepMessage.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-7">
<section id="section-7">
      <h2 id="name-version-negotiation">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-version-negotiation" class="section-name selfRef">Version Negotiation</a>
      </h2>
<p id="section-7-1">This section defines the version negotiation used to support older
protocols between client and servers.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">If a client knows the protocol version(s) supported by the server (e.g.,
from a previous PKIMessage exchange or via some out-of-band means), then
it <span class="bcp14">MUST</span> send a PKIMessage with the highest version supported by both it and
the server.  If a client does not know what version(s) the server supports,
then it <span class="bcp14">MUST</span> send a PKIMessage using the highest version it supports with
the following exception: version cmp2021 <span class="bcp14">SHOULD</span> only be used if cmp2021 syntax
is needed for the request being sent or for the expected response.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">Note: Using cmp2000 as the default pvno is done to avoid extra message exchanges
for version negotiation and to foster compatibility with cmp2000 implementations.
Version cmp2021 syntax is only needed if a message exchange uses EnvelopedData,
hashAlg (in CertStatus), POPOPrivKey with agreeMAC, or ckuann with RootCaKeyUpdateContent.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">If a server receives a message with a version that it supports, then
the version of the response message <span class="bcp14">MUST</span> be the same as the received
version.  If a server receives a message with a version higher or
lower than it supports, then it <span class="bcp14">MUST</span> send back an ErrorMsg with the
unsupportedVersion bit set (in the failureInfo field of the
pKIStatusInfo).  If the received version is higher than the highest
supported version, then the version in the error message <span class="bcp14">MUST</span> be the
highest version the server supports; if the received version is lower
than the lowest supported version then the version in the error
message <span class="bcp14">MUST</span> be the lowest version the server supports.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">If a client gets back an ErrorMsgContent with the unsupportedVersion
bit set and a version it supports, then it <span class="bcp14">MAY</span> retry the request with
that version.<a href="#section-7-5" class="pilcrow">¶</a></p>
<div id="sect-7.1">
<section id="section-7.1">
        <h3 id="name-supporting-rfc-2510-impleme">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-supporting-rfc-2510-impleme" class="section-name selfRef">Supporting RFC 2510 Implementations</a>
        </h3>
<p id="section-7.1-1">RFC 2510 did not specify the behavior of implementations receiving
versions they did not understand since there was only one version in
existence.  With the introduction of the revision in <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span>, the following versioning behaviour is recommended.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div id="sect-7.1.1">
<section id="section-7.1.1">
          <h4 id="name-clients-talking-to-rfc-2510">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-clients-talking-to-rfc-2510" class="section-name selfRef">Clients Talking to RFC 2510 Servers</a>
          </h4>
<p id="section-7.1.1-1">If, after sending a message with a protocol version number higher than cmp1999,
a client receives an ErrorMsgContent with a version of cmp1999, then it <span class="bcp14">MUST</span>
abort the current transaction.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">If a client receives a non-error PKIMessage with a version of
cmp1999, then it <span class="bcp14">MAY</span> decide to continue the transaction (if the
transaction hasn't finished) using RFC 2510 semantics.  If it does
not choose to do so and the transaction is not finished, then it <span class="bcp14">MUST</span>
abort the transaction and send an ErrorMsgContent with a version of
cmp1999.<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7.1.2">
<section id="section-7.1.2">
          <h4 id="name-servers-receiving-version-c">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-servers-receiving-version-c" class="section-name selfRef">Servers Receiving Version cmp1999 PKIMessages</a>
          </h4>
<p id="section-7.1.2-1">If a server receives a version cmp1999 message it <span class="bcp14">MAY</span> revert to RFC
2510 behaviour and respond with version cmp1999 messages.  If it does
not choose to do so, then it <span class="bcp14">MUST</span> send back an ErrorMsgContent as
described above in <a href="#sect-7" class="auto internal xref">Section 7</a>.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-8">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="sect-8.1">
<section id="section-8.1">
        <h3 id="name-on-the-necessity-of-proof-o">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-on-the-necessity-of-proof-o" class="section-name selfRef">On the Necessity of Proof-Of-Possession</a>
        </h3>
<p id="section-8.1-1">It is well established that the role of a Certification Authority is to
verify that the name and public key belong to the end entity prior to
issuing a certificate. If an entity holding a private key obtains a certificate containing the corresponding public key issued for a different entity, it can authenticate as the entity named in the certificate. This facilitates masquerading. It is not entirely clear what security guarantees are lost if an end entity is able to obtain a certificate containing a public key that they do not possess the corresponding private key for. There are some scenarios,
described as "forwarding attacks" in Appendix A of <span>[<a href="#Gueneysu" class="cite xref">Gueneysu</a>]</span>, in
which this can lead to protocol attacks against a naively-implemented
sign-then-encrypt protocol, but in general it merely results in the
end entity obtaining a certificate that they can not use.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.2">
<section id="section-8.2">
        <h3 id="name-proof-of-possession-with-a-">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-proof-of-possession-with-a-" class="section-name selfRef">Proof-Of-Possession with a Decryption Key</a>
        </h3>
<p id="section-8.2-1">Some cryptographic considerations are worth explicitly spelling out.
In the protocols specified above, when an end entity is required to
prove possession of a decryption key, it is effectively challenged to
decrypt something (its own certificate).  This scheme (and many
others!) could be vulnerable to an attack if the possessor of the
decryption key in question could be fooled into decrypting an
arbitrary challenge and returning the cleartext to an attacker.
Although in this specification a number of other failures in security
are required in order for this attack to succeed, it is conceivable
that some future services (e.g., notary, trusted time) could
potentially be vulnerable to such attacks.  For this reason, we
reiterate the general rule that implementations should be very careful
about decrypting arbitrary "ciphertext" and revealing recovered
"plaintext" since such a practice can lead to serious security
vulnerabilities.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">The client <span class="bcp14">MUST</span> return the decrypted values only if they match the expected content type. In an Indirect Method, the decrypted value <span class="bcp14">MUST</span> be a valid certificate, and in the Direct Method, the decrypted value <span class="bcp14">MUST</span> be a Rand as defined in <a href="#sect-5.2.8.3.3" class="auto internal xref">Section 5.2.8.3.3</a>.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.3">
<section id="section-8.3">
        <h3 id="name-proof-of-possession-by-expo">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-proof-of-possession-by-expo" class="section-name selfRef">Proof-Of-Possession by Exposing the Private Key</a>
        </h3>
<p id="section-8.3-1">Note also that exposing a private key to the CA/RA as a
proof-of-possession technique can carry some security risks (depending
upon whether or not the CA/RA can be trusted to handle such material
appropriately).  Implementers are advised to:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-2.1">
            <p id="section-8.3-2.1.1">Exercise caution in selecting and using this particular POP
mechanism.<a href="#section-8.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-2.2">
            <p id="section-8.3-2.2.1">Only use this POP mechanism if archival of the private key is desired.<a href="#section-8.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-2.3">
            <p id="section-8.3-2.3.1">When appropriate, have the user of the application explicitly
state that they are willing to trust the CA/RA to have a copy of
their private key before proceeding to reveal the private key.<a href="#section-8.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-8.4">
<section id="section-8.4">
        <h3 id="name-attack-against-diffie-hellm">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-attack-against-diffie-hellm" class="section-name selfRef">Attack Against Diffie-Hellman Key Exchange</a>
        </h3>
<p id="section-8.4-1">A small subgroup attack during a Diffie-Hellman key exchange may be
carried out as follows.  A malicious end entity may deliberately
choose D-H parameters that enable it to derive (a significant
number of bits of) the D-H private key of the CA during a key
archival or key recovery operation.  Armed with this knowledge, the
EE would then be able to retrieve the decryption private key of
another unsuspecting end entity, EE2, during EE2's legitimate key
archival or key recovery operation with that CA.  In order to avoid
the possibility of such an attack, two courses of action are
available.  (1) The CA may generate a fresh D-H key pair to be used
as a protocol encryption key pair for each EE with which it
interacts.  (2) The CA may enter into a key validation protocol (not
specified in this document) with each requesting end entity to ensure
that the EE's protocol encryption key pair will not facilitate this
attack.  Option (1) is clearly simpler (requiring no extra protocol
exchanges from either party) and is therefore <span class="bcp14">RECOMMENDED</span>.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.5">
<section id="section-8.5">
        <h3 id="name-perfect-forward-secrecy">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-perfect-forward-secrecy" class="section-name selfRef">Perfect Forward Secrecy</a>
        </h3>
<p id="section-8.5-1">Long-term security typically requires perfect forward secrecy (pfs).
When transferring encrypted long-term confidential values such as centrally generated private keys or revocation passphrases, pfs likely is important.
Yet it is not needed for CMP message protection providing integrity and authenticity because transfer of PKI messages is usually completed in very limited time.
For the same reason it typically is not required for the indirect method of providing a POP <a href="#sect-5.2.8.3.2" class="auto internal xref">Section 5.2.8.3.2</a> delivering the newly issued certificate in encrypted form.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">Encrypted values <a href="#sect-5.2.2" class="auto internal xref">Section 5.2.2</a> are transferred using CMS EnvelopedData <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span>, which does not offer pfs. In cases where long-term security is needed, CMP messages <span class="bcp14">SHOULD</span> be transferred over a mechanism that provides pfs, such as TLS with appropriate cipher suites selected.<a href="#section-8.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.6">
<section id="section-8.6">
        <h3 id="name-private-keys-for-certificat">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-private-keys-for-certificat" class="section-name selfRef">Private Keys for Certificate Signing and CMP Message Protection</a>
        </h3>
<p id="section-8.6-1">A CA should not reuse its certificate signing key for other purposes, such
as protecting CMP responses and TLS connections. This way, exposure to other
parts of the system and the number of uses of this particularly critical
key are reduced to a minimum.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.7">
<section id="section-8.7">
        <h3 id="name-entropy-of-random-numbers-k">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-entropy-of-random-numbers-k" class="section-name selfRef">Entropy of Random Numbers, Key Pairs, and Shared Secret Information</a>
        </h3>
<p id="section-8.7-1">Implementations must generate nonces and private keys from random input.
The use of inadequate pseudorandom number generators (PRNGs) to generate
cryptographic keys can result in little or no security. An attacker may find
it much easier to reproduce the PRNG environment that produced the keys and
to search the resulting small set of possibilities than brute-force searching
the whole key space. As an example of predictable random numbers, see <span>[<a href="#CVE-2008-0166" class="cite xref">CVE-2008-0166</a>]</span>; consequences of low-entropy random numbers are discussed in <span><a href="#MiningPsQs" class="internal xref">Mining Your Ps and Qs</a> [<a href="#MiningPsQs" class="cite xref">MiningPsQs</a>]</span>. The generation of quality random numbers is difficult. <span><a href="#ISO.20543-2019" class="internal xref">ISO/IEC 20543:2019</a> [<a href="#ISO.20543-2019" class="cite xref">ISO.20543-2019</a>]</span>, <span><a href="#NIST.SP.800_90Ar1" class="internal xref">NIST SP 800-90A Rev.1</a> [<a href="#NIST.SP.800_90Ar1" class="cite xref">NIST.SP.800_90Ar1</a>]</span>, <span><a href="#AIS31" class="internal xref">BSI AIS 31 V2.0</a> [<a href="#AIS31" class="cite xref">AIS31</a>]</span>, and other specifications offer valuable guidance in this area.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
<p id="section-8.7-2">If shared secret information is generated by a cryptographically secure random number
generator (CSRNG), it is safe to assume that the entropy of the shared secret
information equals its bit length. If no CSRNG is used, the entropy of
shared secret information depends on the details of the generation process
and cannot be measured securely after it has been generated. If user-generated
passwords are used as shared secret information, their entropy cannot be
measured and are typically insufficient for protected delivery of centrally
generated keys or trust anchors.<a href="#section-8.7-2" class="pilcrow">¶</a></p>
<p id="section-8.7-3">If the entropy of shared secret information protecting the delivery of
a centrally generated key pair is known, it should not be less than the security
strength of that key pair; if the shared secret information is reused for
different key pairs, the security of the shared secret information should
exceed the security strength of each individual key pair.<a href="#section-8.7-3" class="pilcrow">¶</a></p>
<p id="section-8.7-4">For the case of a PKI management operation that delivers a new trust anchor
(e.g., a root CA certificate) using caPubs or genp that is (a) not concluded
in a timely manner or (b) where the shared secret information is reused
for several key management operations, the entropy of the shared secret information,
if known, should not be less than the security strength of the trust anchor
being managed by the operation. The shared secret information should have
an entropy that at least matches the security strength of the key material
being managed by the operation. Certain use cases may require shared secret
information that may be of a low security strength, e.g., a human-generated
password. It is <span class="bcp14">RECOMMENDED</span> that such secret information be limited to a
single PKI management operation.<a href="#section-8.7-4" class="pilcrow">¶</a></p>
<p id="section-8.7-5">Importantly for this section further information about algorithm use profiles
and their security strength is available in CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span> Section
7.<a href="#section-8.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.8">
<section id="section-8.8">
        <h3 id="name-recurring-usage-of-kem-keys">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-recurring-usage-of-kem-keys" class="section-name selfRef">Recurring Usage of KEM Keys for Message Protection</a>
        </h3>
<p id="section-8.8-1">For each PKI management operation using MAC-based message protection involving KEM, see <a href="#sect-5.1.3.4" class="auto internal xref">Section 5.1.3.4</a>, the KEM Encapsulate() function, providing a fresh KEM ciphertext (ct) and shared secret (ss), <span class="bcp14">MUST</span> be invoked.<a href="#section-8.8-1" class="pilcrow">¶</a></p>
<p id="section-8.8-2">It is assumed that the overall data size of the CMP messages
in a PKI management operation protected by a single shared secret key
is small enough not to introduce extra security risks.<a href="#section-8.8-2" class="pilcrow">¶</a></p>
<p id="section-8.8-3">To be appropriate for use with this specification, the KEM algorithm
<span class="bcp14">MUST</span> explicitly be designed to be secure when the public key is used
many times. For example, a KEM algorithm with a single-use public
key is not appropriate because the public key is expected to be
carried in a long-lived certificate <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> and used over and over.
Thus, KEM algorithms that offer indistinguishability under adaptive
chosen ciphertext attack (IND-CCA2) security are appropriate. A
common design pattern for obtaining IND-CCA2 security with public key
reuse is to apply the Fujisaki-Okamoto (FO) transform <span>[<a href="#Fujisaki" class="cite xref">Fujisaki</a>]</span> or a
variant of the FO transform <span>[<a href="#Hofheinz" class="cite xref">Hofheinz</a>]</span>.<a href="#section-8.8-3" class="pilcrow">¶</a></p>
<p id="section-8.8-4">Therefore, given a long-term public key using an IND-CCA2 secure KEM
algorithm, there is no limit to the number of CMP messages that can
be authenticated using KEM keys for MAC-based message protection.<a href="#section-8.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.9">
<section id="section-8.9">
        <h3 id="name-trust-anchor-provisioning-u">
<a href="#section-8.9" class="section-number selfRef">8.9. </a><a href="#name-trust-anchor-provisioning-u" class="section-name selfRef">Trust Anchor Provisioning Using CMP Messages</a>
        </h3>
<p id="section-8.9-1">A provider of trust anchors, which may be an RA involved in configuration
management of its clients, <span class="bcp14">MUST NOT</span> include to-be-trusted CA certificates
in a CMP message unless the specific deployment scenario can ensure that
it is adequate that the receiving EE trusts these certificates, e.g., by
loading them into its trust store.<a href="#section-8.9-1" class="pilcrow">¶</a></p>
<p id="section-8.9-2">Whenever an EE receives in a CMP message a CA certificate to be used
as a trust anchor (for example in the caPubs field of a certificate response
or in a general response), it <span class="bcp14">MUST</span> properly authenticate the message sender with
existing trust anchors without requiring new trust anchor information included in the
message.<a href="#section-8.9-2" class="pilcrow">¶</a></p>
<p id="section-8.9-3">Additionally, the EE <span class="bcp14">MUST</span> verify that the sender is an authorized source
of trust anchors.  This authorization is governed by local policy and typically
indicated using shared secret information or with a signature-based message
protection using a certificate issued by a PKI that is explicitly authorized
for this purpose.<a href="#section-8.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.10">
<section id="section-8.10">
        <h3 id="name-authorizing-requests-for-ce">
<a href="#section-8.10" class="section-number selfRef">8.10. </a><a href="#name-authorizing-requests-for-ce" class="section-name selfRef">Authorizing Requests for Certificates with Specific EKUs</a>
        </h3>
<p id="section-8.10-1">When a CA issues a certificate containing extended key usage extensions as
defined in <a href="#sect-4.5" class="auto internal xref">Section 4.5</a>, this expresses delegation of an authorization that
originally is only with the CA certificate itself.
Such delegation is a very sensitive action in a PKI and therefore
special care must be taken when approving such certificate requests to
ensure that only legitimate entities receive a certificate containing
such an EKU.<a href="#section-8.10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8.11">
<section id="section-8.11">
        <h3 id="name-usage-of-certificate-transp">
<a href="#section-8.11" class="section-number selfRef">8.11. </a><a href="#name-usage-of-certificate-transp" class="section-name selfRef">Usage of Certificate Transparency Logs</a>
        </h3>
<p id="section-8.11-1">CAs that support indirect POP <span class="bcp14">MUST NOT</span> also publish final certificates to Certificate Transparency logs <span>[<a href="#RFC9162" class="cite xref">RFC9162</a>]</span> before having received the certConf message containing the certHash of that certificate to complete the POP. The risk is that a malicious actor could fetch the final certificate from the CT log and use that to spoof a response to the implicit POP challenge via a certConf response. This risk does not apply to CT precertificates, so those are ok to publish.<a href="#section-8.11-1" class="pilcrow">¶</a></p>
<p id="section-8.11-2">If a certificate or its precertificate was published in a CT log it must be revoked, if a required certConf message could not be verified, especially when the implicit POP was used.<a href="#section-8.11-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-9">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document updates the ASN.1 modules of CMP Updates Appendix A.2 <span>[<a href="#RFC9480" class="cite xref">RFC9480</a>]</span>. The OID TBD2 (id-mod-cmp2023-02) was registered in the "SMI Security for PKIX Module Identifier" registry to identify the updated ASN.1 module.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">In the SMI-numbers registry "SMI Security for PKIX CMP Information Types (1.3.6.1.5.5.7.4)" (see https://www.iana.org/assignments/smi-numbers/smi-numbers.xhtml#smi-numbers-1.3.6.1.5.5.7.4) as defined in <span>[<a href="#RFC7299" class="cite xref">RFC7299</a>]</span> one addition has been performed.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">One new entry has been added:<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">Decimal: TBD1<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">Description: id-it-KemCiphertextInfo<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">Reference: [RFCXXXX]<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">The new OID 1.2.840.113533.7.66.16 was registered by Entrust for id-KemBasedMac in the arch 1.2.840.113533.7.66. Entrust registered also the OIDs for id-PasswordBasedMac and id-DHBasedMac there.<a href="#section-9-7" class="pilcrow">¶</a></p>
<p id="section-9-8">All existing references to <span>[<a href="#RFC2510" class="cite xref">RFC2510</a>]</span>, <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span>, and <span>[<a href="#RFC9480" class="cite xref">RFC9480</a>]</span> at https://www.iana.org/assignments/smi-numbers/smi-numbers.xhtml except those in the "SMI Security for PKIX Module Identifier" registry should be replaced with references to this document.<a href="#section-9-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-10">
      <h2 id="name-acknowledgements">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-10-1">The authors of this document wish to thank Carlisle Adams, Stephen Farrell,
Tomi Kause, and Tero Mononen, the original authors of <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span>, for their work.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">We also thank all reviewers of this document for their valuable feedback.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Adding KEM support to this document was partly funded by the German Federal Ministry of Education and Research in the project Quoryptan through grant number 16KIS2033.<a href="#section-10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2985">[RFC2985]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #9: Selected Object Classes and Attribute Types Version 2.0"</span>, <span class="seriesInfo">RFC 2985</span>, <span class="seriesInfo">DOI 10.17487/RFC2985</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2985">https://www.rfc-editor.org/rfc/rfc2985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2986">https://www.rfc-editor.org/rfc/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3629">https://www.rfc-editor.org/rfc/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4211">https://www.rfc-editor.org/rfc/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5480">https://www.rfc-editor.org/rfc/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5646">[RFC5646]</dt>
        <dd>
<span class="refAuthor">Phillips, A., Ed.</span> and <span class="refAuthor">M. Davis, Ed.</span>, <span class="refTitle">"Tags for Identifying Languages"</span>, <span class="seriesInfo">BCP 47</span>, <span class="seriesInfo">RFC 5646</span>, <span class="seriesInfo">DOI 10.17487/RFC5646</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5646">https://www.rfc-editor.org/rfc/rfc5646</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5652">https://www.rfc-editor.org/rfc/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5958">[RFC5958]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Asymmetric Key Packages"</span>, <span class="seriesInfo">RFC 5958</span>, <span class="seriesInfo">DOI 10.17487/RFC5958</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5958">https://www.rfc-editor.org/rfc/rfc5958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6402">[RFC6402]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6402">https://www.rfc-editor.org/rfc/rfc6402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8933">[RFC8933]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Update to the Cryptographic Message Syntax (CMS) for Algorithm Identifier Protection"</span>, <span class="seriesInfo">RFC 8933</span>, <span class="seriesInfo">DOI 10.17487/RFC8933</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8933">https://www.rfc-editor.org/rfc/rfc8933</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9045">[RFC9045]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Algorithm Requirements Update to the Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 9045</span>, <span class="seriesInfo">DOI 10.17487/RFC9045</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9045">https://www.rfc-editor.org/rfc/rfc9045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9481">[RFC9481]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">Aschauer, H.</span>, <span class="refAuthor">Ounsworth, M.</span>, and <span class="refAuthor">J. Gray</span>, <span class="refTitle">"Certificate Management Protocol (CMP) Algorithms"</span>, <span class="seriesInfo">RFC 9481</span>, <span class="seriesInfo">DOI 10.17487/RFC9481</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9481">https://www.rfc-editor.org/rfc/rfc9481</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9629">[RFC9629]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Gray, J.</span>, and <span class="refAuthor">T. Okubo</span>, <span class="refTitle">"Using Key Encapsulation Mechanism (KEM) Algorithms in the Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 9629</span>, <span class="seriesInfo">DOI 10.17487/RFC9629</span>, <time datetime="2024-08" class="refDate">August 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9629">https://www.rfc-editor.org/rfc/rfc9629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MvOV97">[MvOV97]</dt>
        <dd>
<span class="refAuthor">Menezes, A.</span>, <span class="refAuthor">van Oorschot, P.</span>, and <span class="refAuthor">S. Vanstone</span>, <span class="refTitle">"Handbook of Applied Cryptography"</span>, <span class="seriesInfo">CRC Press ISBN 0-8493-8523-7</span>, <time datetime="1996" class="refDate">1996</time>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC9480">[RFC9480]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">von Oheimb, D.</span>, and <span class="refAuthor">J. Gray</span>, <span class="refTitle">"Certificate Management Protocol (CMP) Updates"</span>, <span class="seriesInfo">RFC 9480</span>, <span class="seriesInfo">DOI 10.17487/RFC9480</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9480">https://www.rfc-editor.org/rfc/rfc9480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9482">[RFC9482]</dt>
        <dd>
<span class="refAuthor">Sahni, M., Ed.</span> and <span class="refAuthor">S. Tripathi, Ed.</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Transfer for the Certificate Management Protocol"</span>, <span class="seriesInfo">RFC 9482</span>, <span class="seriesInfo">DOI 10.17487/RFC9482</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9482">https://www.rfc-editor.org/rfc/rfc9482</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9483">[RFC9483]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">von Oheimb, D.</span>, and <span class="refAuthor">S. Fries</span>, <span class="refTitle">"Lightweight Certificate Management Protocol (CMP) Profile"</span>, <span class="seriesInfo">RFC 9483</span>, <span class="seriesInfo">DOI 10.17487/RFC9483</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9483">https://www.rfc-editor.org/rfc/rfc9483</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-rfc6712bis">[I-D.ietf-lamps-rfc6712bis]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">von Oheimb, D.</span>, <span class="refAuthor">Ounsworth, M.</span>, and <span class="refAuthor">J. Gray</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure -- HTTP Transfer for the Certificate Management Protocol (CMP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-rfc6712bis-09</span>, <time datetime="2024-11-29" class="refDate">29 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-rfc6712bis-09">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-rfc6712bis-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1847">[RFC1847]</dt>
        <dd>
<span class="refAuthor">Galvin, J.</span>, <span class="refAuthor">Murphy, S.</span>, <span class="refAuthor">Crocker, S.</span>, and <span class="refAuthor">N. Freed</span>, <span class="refTitle">"Security Multiparts for MIME: Multipart/Signed and Multipart/Encrypted"</span>, <span class="seriesInfo">RFC 1847</span>, <span class="seriesInfo">DOI 10.17487/RFC1847</span>, <time datetime="1995-10" class="refDate">October 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1847">https://www.rfc-editor.org/rfc/rfc1847</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2510">[RFC2510]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocols"</span>, <span class="seriesInfo">RFC 2510</span>, <span class="seriesInfo">DOI 10.17487/RFC2510</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2510">https://www.rfc-editor.org/rfc/rfc2510</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2585">[RFC2585]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Operational Protocols: FTP and HTTP"</span>, <span class="seriesInfo">RFC 2585</span>, <span class="seriesInfo">DOI 10.17487/RFC2585</span>, <time datetime="1999-05" class="refDate">May 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2585">https://www.rfc-editor.org/rfc/rfc2585</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4210">[RFC4210]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Kause, T.</span>, and <span class="refAuthor">T. Mononen</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 4210</span>, <span class="seriesInfo">DOI 10.17487/RFC4210</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4210">https://www.rfc-editor.org/rfc/rfc4210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4212">[RFC4212]</dt>
        <dd>
<span class="refAuthor">Blinov, M.</span> and <span class="refAuthor">C. Adams</span>, <span class="refTitle">"Alternative Certificate Formats for the Public-Key Infrastructure Using X.509 (PKIX) Certificate Management Protocols"</span>, <span class="seriesInfo">RFC 4212</span>, <span class="seriesInfo">DOI 10.17487/RFC4212</span>, <time datetime="2005-10" class="refDate">October 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4212">https://www.rfc-editor.org/rfc/rfc4212</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4303">[RFC4303]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Encapsulating Security Payload (ESP)"</span>, <span class="seriesInfo">RFC 4303</span>, <span class="seriesInfo">DOI 10.17487/RFC4303</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4303">https://www.rfc-editor.org/rfc/rfc4303</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4511">[RFC4511]</dt>
        <dd>
<span class="refAuthor">Sermersheim, J., Ed.</span>, <span class="refTitle">"Lightweight Directory Access Protocol (LDAP): The Protocol"</span>, <span class="seriesInfo">RFC 4511</span>, <span class="seriesInfo">DOI 10.17487/RFC4511</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4511">https://www.rfc-editor.org/rfc/rfc4511</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5912">https://www.rfc-editor.org/rfc/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6268">[RFC6268]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Additional New ASN.1 Modules for the Cryptographic Message Syntax (CMS) and the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 6268</span>, <span class="seriesInfo">DOI 10.17487/RFC6268</span>, <time datetime="2011-07" class="refDate">July 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6268">https://www.rfc-editor.org/rfc/rfc6268</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6712">[RFC6712]</dt>
        <dd>
<span class="refAuthor">Kause, T.</span> and <span class="refAuthor">M. Peylo</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure -- HTTP Transfer for the Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 6712</span>, <span class="seriesInfo">DOI 10.17487/RFC6712</span>, <time datetime="2012-09" class="refDate">September 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6712">https://www.rfc-editor.org/rfc/rfc6712</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7296">https://www.rfc-editor.org/rfc/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7299">[RFC7299]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Object Identifier Registry for the PKIX Working Group"</span>, <span class="seriesInfo">RFC 7299</span>, <span class="seriesInfo">DOI 10.17487/RFC7299</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7299">https://www.rfc-editor.org/rfc/rfc7299</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8572">[RFC8572]</dt>
        <dd>
<span class="refAuthor">Watsen, K.</span>, <span class="refAuthor">Farrer, I.</span>, and <span class="refAuthor">M. Abrahamsson</span>, <span class="refTitle">"Secure Zero Touch Provisioning (SZTP)"</span>, <span class="seriesInfo">RFC 8572</span>, <span class="seriesInfo">DOI 10.17487/RFC8572</span>, <time datetime="2019-04" class="refDate">April 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8572">https://www.rfc-editor.org/rfc/rfc8572</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8649">[RFC8649]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Hash Of Root Key Certificate Extension"</span>, <span class="seriesInfo">RFC 8649</span>, <span class="seriesInfo">DOI 10.17487/RFC8649</span>, <time datetime="2019-08" class="refDate">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8649">https://www.rfc-editor.org/rfc/rfc8649</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8995">[RFC8995]</dt>
        <dd>
<span class="refAuthor">Pritikin, M.</span>, <span class="refAuthor">Richardson, M.</span>, <span class="refAuthor">Eckert, T.</span>, <span class="refAuthor">Behringer, M.</span>, and <span class="refAuthor">K. Watsen</span>, <span class="refTitle">"Bootstrapping Remote Secure Key Infrastructure (BRSKI)"</span>, <span class="seriesInfo">RFC 8995</span>, <span class="seriesInfo">DOI 10.17487/RFC8995</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8995">https://www.rfc-editor.org/rfc/rfc8995</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9162">[RFC9162]</dt>
        <dd>
<span class="refAuthor">Laurie, B.</span>, <span class="refAuthor">Messeri, E.</span>, and <span class="refAuthor">R. Stradling</span>, <span class="refTitle">"Certificate Transparency Version 2.0"</span>, <span class="seriesInfo">RFC 9162</span>, <span class="seriesInfo">DOI 10.17487/RFC9162</span>, <time datetime="2021-12" class="refDate">December 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9162">https://www.rfc-editor.org/rfc/rfc9162</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-anima-brski-ae">[I-D.ietf-anima-brski-ae]</dt>
        <dd>
<span class="refAuthor">von Oheimb, D.</span>, <span class="refAuthor">Fries, S.</span>, and <span class="refAuthor">H. Brockhaus</span>, <span class="refTitle">"BRSKI-AE: Alternative Enrollment Protocols in BRSKI"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-anima-brski-ae-13</span>, <time datetime="2024-09-17" class="refDate">17 September 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-ae-13">https://datatracker.ietf.org/doc/html/draft-ietf-anima-brski-ae-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-kyber-certificates">[I-D.ietf-lamps-kyber-certificates]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Kampanakis, P.</span>, <span class="refAuthor">Massimo, J.</span>, and <span class="refAuthor">B. Westerbaan</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure - Algorithm Identifiers for the Module-Lattice-Based Key-Encapsulation Mechanism (ML-KEM)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-kyber-certificates-07</span>, <time datetime="2025-01-07" class="refDate">7 January 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lamps-kyber-certificates-07">https://datatracker.ietf.org/doc/html/draft-ietf-lamps-kyber-certificates-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800_90Ar1">[NIST.SP.800_90Ar1]</dt>
        <dd>
<span class="refAuthor">Barker, E. B.</span>, <span class="refAuthor">Kelsey, J. M.</span>, and <span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span class="seriesInfo">NIST Special Publications (General) 800-90Ar1</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-90Ar1</span>, <time datetime="2015-06" class="refDate">June 2015</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE.802.1AR-2018">[IEEE.802.1AR-2018]</dt>
        <dd>
<span class="refTitle">"IEEE Standard for Local and Metropolitan Area Networks - Secure Device Identity"</span>, <span class="refContent">IEEE</span>, <span class="seriesInfo">DOI 10.1109/ieeestd.2018.8423794</span>, <span class="seriesInfo">ISBN ["9781504450195"]</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://doi.org/10.1109/ieeestd.2018.8423794">https://doi.org/10.1109/ieeestd.2018.8423794</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CVE-2008-0166">[CVE-2008-0166]</dt>
        <dd>
<span class="refAuthor">National Institute of Science and Technology (NIST)</span>, <span class="refTitle">"National Vulnerability Database - CVE-2008-0166"</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://nvd.nist.gov/vuln/detail/CVE-2008-0166">https://nvd.nist.gov/vuln/detail/CVE-2008-0166</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MiningPsQs">[MiningPsQs]</dt>
        <dd>
<span class="refAuthor">Security'12: Proceedings of the 21st USENIX conference on Security symposium</span>, <span class="refAuthor">Heninger, N.</span>, <span class="refAuthor">Durumeric, Z.</span>, <span class="refAuthor">Wustrow, E.</span>, and <span class="refAuthor">J. A. Halderman</span>, <span class="refTitle">"Mining Your Ps and Qs: Detection of Widespread Weak Keys in Network Devices"</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.usenix.org/conference/usenixsecurity12/technical-sessions/presentation/heninger">https://www.usenix.org/conference/usenixsecurity12/technical-sessions/presentation/heninger</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO.20543-2019">[ISO.20543-2019]</dt>
        <dd>
<span class="refAuthor">International Organization for Standardization (ISO)</span>, <span class="refTitle">"Information technology -- Security techniques -- Test and analysis methods for random bit generators within ISO/IEC 19790 and ISO/IEC 15408"</span>, <span class="seriesInfo">ISO Draft Standard 20543-2019</span>, <time datetime="2019-10" class="refDate">October 2019</time>. </dd>
<dd class="break"></dd>
<dt id="AIS31">[AIS31]</dt>
        <dd>
<span class="refAuthor">Federal Office for Information Security (BSI)</span>, <span class="refAuthor">Killmann, W.</span>, and <span class="refAuthor">W. Schindler</span>, <span class="refTitle">"A proposal for: Functionality classes for random number generators, version 2.0"</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Zertifizierung/Interpretationen/AIS_31_Functionality_classes_for_random_number_generators_e.pdf">https://www.bsi.bund.de/SharedDocs/Downloads/DE/BSI/Zertifizierung/Interpretationen/AIS_31_Functionality_classes_for_random_number_generators_e.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Gueneysu">[Gueneysu]</dt>
        <dd>
<span class="refAuthor">Gueneysu, T.</span>, <span class="refAuthor">Hodges, P.</span>, <span class="refAuthor">Land, G.</span>, <span class="refAuthor">Ounsworth, M.</span>, <span class="refAuthor">Stebila, D.</span>, and <span class="refAuthor">G. Zaverucha</span>, <span class="refTitle">"Proof-of-possession for KEM certificates using verifiable generation"</span>, <span class="seriesInfo">Cryptology ePrint Archive </span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://eprint.iacr.org/2022/703">https://eprint.iacr.org/2022/703</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Fujisaki">[Fujisaki]</dt>
        <dd>
<span class="refAuthor">Fujisaki, E.</span> and <span class="refAuthor">T. Okamoto</span>, <span class="refTitle">"Secure Integration of Asymmetric and Symmetric Encryption Schemes"</span>, <span class="refContent">Springer Science and Business Media LLC</span>, <span class="seriesInfo">Journal of Cryptology vol. 26, no. 1, pp. 80-101</span>, <span class="seriesInfo">DOI 10.1007/s00145-011-9114-1</span>, <time datetime="2011-12" class="refDate">December 2011</time>, <span>&lt;<a href="https://doi.org/10.1007/s00145-011-9114-1">https://doi.org/10.1007/s00145-011-9114-1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Hofheinz">[Hofheinz]</dt>
        <dd>
<span class="refAuthor">Hofheinz, D.</span>, <span class="refAuthor">Hövelmanns, K.</span>, and <span class="refAuthor">E. Kiltz</span>, <span class="refTitle">"A Modular Analysis of the Fujisaki-Okamoto Transformation"</span>, <span class="refContent">Springer International Publishing</span>, <span class="seriesInfo">Lecture Notes in Computer Science pp. 341-371</span>, <span class="seriesInfo">DOI 10.1007/978-3-319-70500-2_12</span>, <span class="seriesInfo">ISBN ["9783319704999", "9783319705002"]</span>, <time datetime="2017" class="refDate">2017</time>, <span>&lt;<a href="https://doi.org/10.1007/978-3-319-70500-2_12">https://doi.org/10.1007/978-3-319-70500-2_12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ETSI-3GPP.33.310">[ETSI-3GPP.33.310]</dt>
        <dd>
<span class="refAuthor">3GPP</span>, <span class="refTitle">"Network Domain Security (NDS); Authentication Framework (AF)"</span>, <span class="seriesInfo">3GPP TS 33.310 16.6.0</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="http://www.3gpp.org/ftp/Specs/html-info/33310.htm">http://www.3gpp.org/ftp/Specs/html-info/33310.htm</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UNISIG.Subset-137">[UNISIG.Subset-137]</dt>
      <dd>
<span class="refAuthor">UNISIG</span>, <span class="refTitle">"ERTMS/ETCS On-line Key Management FFFIS"</span>, <span class="seriesInfo">Subset-137, V1.0.0 </span>, <time datetime="2015-12" class="refDate">December 2015</time>, <span>&lt;<a href="https://www.era.europa.eu/system/files/2023-01/sos3_index083_-_subset-137_v100.pdf">https://www.era.europa.eu/system/files/2023-01/sos3_index083_-_subset-137_v100.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="sect-a">
<section id="appendix-A">
      <h2 id="name-reasons-for-the-presence-of">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-reasons-for-the-presence-of" class="section-name selfRef">Reasons for the Presence of RAs</a>
      </h2>
<p id="appendix-A-1">The reasons that justify the presence of an RA can be split into
those that are due to technical factors and those which are
organizational in nature.  Technical reasons include the following.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">
          <p id="appendix-A-2.1.1">If hardware tokens are in use, then not all end entities will have
the equipment needed to initialize these; the RA equipment can
include the necessary functionality (this may also be a matter of
policy).<a href="#appendix-A-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.2">
          <p id="appendix-A-2.2.1">Some end entities may not have the capability to publish
certificates; again, the RA may be suitably placed for this.<a href="#appendix-A-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-2.3">
          <p id="appendix-A-2.3.1">The RA will be able to issue signed revocation requests on behalf
of end entities associated with it, whereas the end entity may not
be able to do this (if the key pair is completely lost).<a href="#appendix-A-2.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-3">Some of the organizational reasons that argue for the presence of an
RA are the following.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-4.1">
          <p id="appendix-A-4.1.1">It may be more cost effective to concentrate functionality in the
RA equipment than to supply functionality to all end entities
(especially if special token initialization equipment is to be
used).<a href="#appendix-A-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.2">
          <p id="appendix-A-4.2.1">Establishing RAs within an organization can reduce the number of
CAs required, which is sometimes desirable.<a href="#appendix-A-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.3">
          <p id="appendix-A-4.3.1">RAs may be better placed to identify people with their
"electronic" names, especially if the CA is physically remote from
the end entity.<a href="#appendix-A-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-A-4.4">
          <p id="appendix-A-4.4.1">For many applications, there will already be in place some
administrative structure so that candidates for the role of RA are
easy to find (which may not be true of the CA).<a href="#appendix-A-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-A-5">Further reasons relevant for automated machine-to-machine certificate lifecycle
management are available in the Lightweight CMP Profile <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span>.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-b">
<section id="appendix-B">
      <h2 id="name-the-use-of-revocation-passp">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-the-use-of-revocation-passp" class="section-name selfRef">The Use of Revocation Passphrase</a>
      </h2>
<p id="appendix-B-1">A revocation request must incorporate suitable security mechanisms,
including proper authentication, in order to reduce the probability
of successful denial-of-service attacks.  A digital signature or DH/KEM-based message protection on the
request -- <span class="bcp14">REQUIRED</span> to support within this specification depending on the key type used if
revocation requests are supported -- can provide the authentication
required, but there are circumstances under which an alternative
mechanism may be desirable (e.g., when the private key is no longer
accessible and the entity wishes to request a revocation prior to
re-certification of another key pair).  In order to accommodate such
circumstances, a password-based MAC, see CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span> Section
6.1, on the request is also <span class="bcp14">REQUIRED</span> to
support within this specification (subject to local security policy
for a given environment) if revocation requests are supported and if
shared secret information can be established between the requester
and the responder prior to the need for revocation.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">A mechanism that has seen use in some environments is "revocation passphrase",
in which a value of sufficient entropy (i.e., a
relatively long passphrase rather than a short password) is shared
between (only) the entity and the CA/RA at some point prior to
revocation; this value is later used to authenticate the revocation
request.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">In this specification, the following technique to establish shared
secret information (i.e., a revocation passphrase) is <span class="bcp14">OPTIONAL</span> to
support.  Its precise use in CMP messages is as follows.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-4.1">
          <p id="appendix-B-4.1.1">The OID and value specified in <a href="#sect-5.3.19.9" class="auto internal xref">Section 5.3.19.9</a> <span class="bcp14">MAY</span> be sent in a GenMsg message
at any time or <span class="bcp14">MAY</span> be sent in the generalInfo
field of the PKIHeader of any PKIMessage at any time.  (In particular, the
EncryptedKey structure as described in <a href="#sect-5.2.2" class="auto internal xref">Section 5.2.2</a> may be sent in the header
of the certConf message that confirms acceptance
of certificates requested in an initialization request or certificate request
message.)  This conveys a revocation passphrase chosen by the entity to the
relevant CA/RA. When EnvelopedData is used, this is in the decrypted bytes
of encryptedContent field. When EncryptedValue is used, this is in the decrypted
bytes of the encValue field. Furthermore, the transfer is accomplished with
appropriate confidentiality characteristics.<a href="#appendix-B-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.2">
          <p id="appendix-B-4.2.1">If a CA/RA receives the revocation passphrase (OID and value
specified in <a href="#sect-5.3.19.9" class="auto internal xref">Section 5.3.19.9</a>) in a GenMsg, it <span class="bcp14">MUST</span> construct and
send a GenRep message that includes the OID (with absent value)
specified in <a href="#sect-5.3.19.9" class="auto internal xref">Section 5.3.19.9</a>. If the CA/RA receives the
revocation passphrase in the generalInfo field of a PKIHeader of
any PKIMessage, it <span class="bcp14">MUST</span> include the OID (with absent value) in the
generalInfo field of the PKIHeader of the corresponding response
PKIMessage.  If the CA/RA is unable to return the appropriate
response message for any reason, it <span class="bcp14">MUST</span> send an error message
with a status of "rejection" and, optionally, a failInfo reason
set.<a href="#appendix-B-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.3">
          <p id="appendix-B-4.3.1">Either the localKeyId attribute of EnvelopedData as specified in
<span>[<a href="#RFC2985" class="cite xref">RFC2985</a>]</span> or the valueHint field of EncryptedValue <span class="bcp14">MAY</span>
contain a key identifier (chosen
by the entity, along with the passphrase itself) to assist in later retrieval
of the correct passphrase (e.g., when the revocation request is constructed
by the end entity and received by the CA/RA).<a href="#appendix-B-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-B-4.4">
          <p id="appendix-B-4.4.1">The revocation request message is protected by a password-based MAC, see
CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span> Section 6.1,
with the revocation passphrase as the key.  If appropriate, the
senderKID field in the PKIHeader <span class="bcp14">MAY</span> contain the value previously
transmitted in localKeyId or valueHint.<a href="#appendix-B-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-B-5">Note: For a message transferring a revocation passphrase indicating cmp2021(3) in the pvno field of the PKIHeader, the encrypted passphrase <span class="bcp14">MUST</span> be transferred in the envelopedData choice of EncryptedKey as defined in Section 5.2.2.  When using cmp2000(2) in the message header for backward compatibility, the encryptedValue is used. This allows the necessary conveyance and protection of the passphrase while maintaining bits-on-the-wire compatibility with <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span>. The encryaptedValue choice has been deprecated in favor of encryptedData.<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<p id="appendix-B-6">Using the technique specified above, the revocation passphrase may be
initially established and updated at any time without requiring extra
messages or out-of-band exchanges.  For example, the revocation
request message itself (protected and authenticated through a MAC
that uses the revocation passphrase as a key) may contain, in the
PKIHeader, a new revocation passphrase to be used for authenticating
future revocation requests for any of the entity's other
certificates.  In some environments this may be preferable to
mechanisms that reveal the passphrase in the revocation request
message, since this can allow a denial-of-service attack in which the
revealed passphrase is used by an unauthorized third party to
authenticate revocation requests on the entity's other certificates.
However, because the passphrase is not revealed in the request
message, there is no requirement that the passphrase must always be
updated when a revocation request is made (that is, the same
passphrase <span class="bcp14">MAY</span> be used by an entity to authenticate revocation
requests for different certificates at different times).<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<p id="appendix-B-7">Furthermore, the above technique can provide strong cryptographic
protection over the entire revocation request message even when a
digital signature is not used.  Techniques that do authentication of
the revocation request by simply revealing the revocation passphrase
typically do not provide cryptographic protection over the fields of
the request message (so that a request for revocation of one
certificate may be modified by an unauthorized third party to a
request for revocation of another certificate for that entity).<a href="#appendix-B-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-c">
<section id="appendix-C">
      <h2 id="name-pki-management-message-prof">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-pki-management-message-prof" class="section-name selfRef">PKI Management Message Profiles (REQUIRED)</a>
      </h2>
<p id="appendix-C-1">This appendix contains detailed profiles for those PKIMessages that
<span class="bcp14">MUST</span> be supported by conforming implementations (see <a href="#sect-6" class="auto internal xref">Section 6</a>).<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">Note: <a href="#sect-c" class="auto internal xref">Appendix C</a> and <a href="#sect-d" class="auto internal xref">D</a> focus on PKI management operations
managing certificates for human end entities.
In contrast, the Lightweight CMP Profile <span>[<a href="#RFC9483" class="cite xref">RFC9483</a>]</span> focuses on typical use
cases of industrial and IoT scenarios supporting highly automated certificate
lifecycle management scenarios.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">Profiles for the PKIMessages used in the following PKI management
operations are provided:<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">initial registration/certification<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.2">
          <p id="appendix-C-4.2.1">basic authenticated scheme<a href="#appendix-C-4.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.3">
          <p id="appendix-C-4.3.1">certificate request<a href="#appendix-C-4.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.4">
          <p id="appendix-C-4.4.1">key update<a href="#appendix-C-4.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="sect-c.1">
<section id="appendix-C.1">
        <h3 id="name-general-rules-for-interpret">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-general-rules-for-interpret" class="section-name selfRef">General Rules for Interpretation of These Profiles</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="appendix-C.1-1">
<li id="appendix-C.1-1.1">
            <p id="appendix-C.1-1.1.1">Where <span class="bcp14">OPTIONAL</span> or DEFAULT fields are not mentioned in individual
  profiles, they <span class="bcp14">SHOULD</span> be absent from the relevant message (i.e.,
  a receiver can validly reject a message containing such fields as
  being syntactically incorrect).  Mandatory fields are not
  mentioned if they have an obvious value. The pvno <span class="bcp14">MUST</span> be set as specified in <a href="#sect-7" class="auto internal xref">Section 7</a>).<a href="#appendix-C.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.1-1.2">
            <p id="appendix-C.1-1.2.1">Where structures occur in more than one message, they are
  separately profiled as appropriate.<a href="#appendix-C.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.1-1.3">
            <p id="appendix-C.1-1.3.1">The algorithmIdentifiers from PKIMessage structures are profiled
  separately.<a href="#appendix-C.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.1-1.4">
            <p id="appendix-C.1-1.4.1">A "special" X.500 DN is called the "NULL-DN"; this means a DN
  containing a zero-length SEQUENCE OF RelativeDistinguishedNames
  (its DER encoding is then '3000'H).<a href="#appendix-C.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.1-1.5">
            <p id="appendix-C.1-1.5.1">Where a GeneralName is required for a field, but no suitable
  value is available (e.g., an end entity produces a request before
  knowing its name), then the GeneralName is to be an X.500 NULL-DN
  (i.e., the Name field of the CHOICE is to contain a NULL-DN).<a href="#appendix-C.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.1-1.6">
            <p id="appendix-C.1-1.6.1">Where a profile omits to specify the value for a GeneralName,
  then the NULL-DN value is to be present in the relevant
  PKIMessage field.  This occurs with the sender field of the
  PKIHeader for some messages.<a href="#appendix-C.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.1-1.7">
            <p id="appendix-C.1-1.7.1">Where any ambiguity arises due to naming of fields, the profile
  names these using a "dot" notation (e.g., "certTemplate.subject"
  means the subject field within a field called certTemplate).<a href="#appendix-C.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.1-1.8">
            <p id="appendix-C.1-1.8.1">Where a "SEQUENCE OF types" is part of a message, a zero-based
  array notation is used to describe fields within the SEQUENCE OF
  (e.g., crm[0].certReq.certTemplate.subject refers to a subfield
  of the first CertReqMsg contained in a request message).<a href="#appendix-C.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.1-1.9">
            <p id="appendix-C.1-1.9.1">All PKI message exchanges in <a href="#sect-c.4" class="auto internal xref">Appendix C.4</a> to <a href="#sect-c.6" class="auto internal xref">C.6</a> require a
  certConf message to be sent by the initiating entity and a
  PKIConfirm to be sent by the responding entity.  The PKIConfirm
  is not included in some of the profiles given since its body is
  NULL and its header contents are clear from the context.  Any
  authenticated means can be used for the protectionAlg (e.g.,
  password-based MAC, if shared secret information is known, or
  signature).<a href="#appendix-C.1-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="sect-c.2">
<section id="appendix-C.2">
        <h3 id="name-algorithm-use-profile">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-algorithm-use-profile" class="section-name selfRef">Algorithm Use Profile</a>
        </h3>
<p id="appendix-C.2-1">For specifications of algorithm identifiers and respective conventions for
conforming implementations, please refer to Section 7.1 of CMP Algorithms <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-c.3">
<section id="appendix-C.3">
        <h3 id="name-proof-of-possession-profile">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-proof-of-possession-profile" class="section-name selfRef">Proof-of-Possession Profile</a>
        </h3>
<p id="appendix-C.3-1">POP fields for use (in signature field of pop field of
ProofOfPossession structure) when proving possession of a private
signing key that corresponds to a public verification key for which a
certificate has been requested.<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Field</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Comment</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">algorithmIdentifier</td>
              <td class="text-left" rowspan="1" colspan="1">MSG_SIG_ALG</td>
              <td class="text-left" rowspan="1" colspan="1">only signature protection is allowed for this proof</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">signature</td>
              <td class="text-left" rowspan="1" colspan="1">present</td>
              <td class="text-left" rowspan="1" colspan="1">bits calculated using MSG_SIG_ALG</td>
            </tr>
          </tbody>
        </table>
<p id="appendix-C.3-3">Note: For examples of MSG_SIG_ALG OIDs see CMP Algorithms Section 3 <span>[<a href="#RFC9481" class="cite xref">RFC9481</a>]</span>.<a href="#appendix-C.3-3" class="pilcrow">¶</a></p>
<p id="appendix-C.3-4">Proof-of-possession of a private decryption key that corresponds to a
public encryption key for which a certificate has been requested does
not use this profile; the CertHash field of the certConf message is
used instead.<a href="#appendix-C.3-4" class="pilcrow">¶</a></p>
<p id="appendix-C.3-5">Not every CA/RA will do Proof-of-Possession (of signing key,
decryption key, or key agreement key) in the PKIX-CMP in-band
certification request protocol (how POP is done <span class="bcp14">MAY</span> ultimately be a
policy issue that is made explicit for any given CA in its publicized
Policy OID and Certification Practice Statement).  However, this
specification mandates that CA/RA entities <span class="bcp14">MUST</span> do POP (by some
means) as part of the certification process.  All end entities <span class="bcp14">MUST</span>
be prepared to provide POP (i.e., these components of the PKIX-CMP
protocol <span class="bcp14">MUST</span> be supported).<a href="#appendix-C.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-c.4">
<section id="appendix-C.4">
        <h3 id="name-initial-registration-certific">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-initial-registration-certific" class="section-name selfRef">Initial Registration/Certification (Basic Authenticated Scheme)</a>
        </h3>
<p id="appendix-C.4-1">An (uninitialized) end entity requests a (first) certificate from a
CA.  When the CA responds with a message containing a certificate,
the end entity replies with a certificate confirmation.  The CA sends
a PKIConfirm back, closing the transaction.  All messages are
authenticated.<a href="#appendix-C.4-1" class="pilcrow">¶</a></p>
<p id="appendix-C.4-2">This scheme allows the end entity to request certification of a
locally-generated public key (typically a signature key).  The end
entity <span class="bcp14">MAY</span> also choose to request the centralized generation and
certification of another key pair (typically an encryption key pair).<a href="#appendix-C.4-2" class="pilcrow">¶</a></p>
<p id="appendix-C.4-3">Certification may only be requested for one locally generated public
key (for more, use separate PKIMessages).<a href="#appendix-C.4-3" class="pilcrow">¶</a></p>
<p id="appendix-C.4-4">The end entity <span class="bcp14">MUST</span> support proof-of-possession of the private key
associated with the locally-generated public key.<a href="#appendix-C.4-4" class="pilcrow">¶</a></p>
<p id="appendix-C.4-5">Preconditions:<a href="#appendix-C.4-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-C.4-6">
<li id="appendix-C.4-6.1">
            <p id="appendix-C.4-6.1.1">The end entity can authenticate the CA's signature based on
out-of-band means<a href="#appendix-C.4-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.4-6.2">
            <p id="appendix-C.4-6.2.1">The end entity and the CA share a symmetric MACing key<a href="#appendix-C.4-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="appendix-C.4-7">Message flow:<a href="#appendix-C.4-7" class="pilcrow">¶</a></p>
<div id="appendix-C.4-8">
          <div class="alignLeft art-svg artwork" id="appendix-C.4-8.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="256" width="560" viewBox="0 0 560 256" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 552,48" fill="none" stroke="black"></path>
              <g class="text">
                <text x="24" y="36">Step#</text>
                <text x="64" y="36">End</text>
                <text x="108" y="36">entity</text>
                <text x="360" y="36">PKI</text>
                <text x="24" y="68">1</text>
                <text x="76" y="68">format</text>
                <text x="116" y="68">ir</text>
                <text x="24" y="84">2</text>
                <text x="212" y="84">-&gt;</text>
                <text x="252" y="84">ir</text>
                <text x="316" y="84">-&gt;</text>
                <text x="24" y="100">3</text>
                <text x="372" y="100">handle</text>
                <text x="412" y="100">ir</text>
                <text x="24" y="116">4</text>
                <text x="372" y="116">format</text>
                <text x="412" y="116">ip</text>
                <text x="24" y="132">5</text>
                <text x="212" y="132">&lt;-</text>
                <text x="252" y="132">ip</text>
                <text x="316" y="132">&lt;-</text>
                <text x="24" y="148">6</text>
                <text x="76" y="148">handle</text>
                <text x="116" y="148">ip</text>
                <text x="24" y="164">7</text>
                <text x="76" y="164">format</text>
                <text x="140" y="164">certConf</text>
                <text x="24" y="180">8</text>
                <text x="212" y="180">-&gt;</text>
                <text x="276" y="180">certConf</text>
                <text x="324" y="180">-&gt;</text>
                <text x="24" y="196">9</text>
                <text x="372" y="196">handle</text>
                <text x="436" y="196">certConf</text>
                <text x="20" y="212">10</text>
                <text x="372" y="212">format</text>
                <text x="432" y="212">PKIConf</text>
                <text x="20" y="228">11</text>
                <text x="212" y="228">&lt;-</text>
                <text x="272" y="228">PKIConf</text>
                <text x="324" y="228">&lt;-</text>
                <text x="20" y="244">12</text>
                <text x="76" y="244">handle</text>
                <text x="136" y="244">PKIConf</text>
              </g>
            </svg><a href="#appendix-C.4-8.1" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-C.4-9">For this profile, we mandate that the end entity <span class="bcp14">MUST</span> include all
(i.e., one or two) CertReqMsg in a single PKIMessage, and that the
PKI (CA) <span class="bcp14">MUST</span> produce a single response PKIMessage that contains the
complete response (i.e., including the <span class="bcp14">OPTIONAL</span> second key pair, if
it was requested and if centralized key generation is supported).
For simplicity, we also mandate that this message <span class="bcp14">MUST</span> be the final
one (i.e., no use of "waiting" status value).<a href="#appendix-C.4-9" class="pilcrow">¶</a></p>
<p id="appendix-C.4-10">The end entity has an out-of-band interaction with the CA/RA.  This
transaction established the shared secret, the referenceNumber and
OPTIONALLY the distinguished name used for both sender and subject
name in the certificate template. See <a href="#sect-8.7" class="auto internal xref">Section 8.7</a> for security
considerations on quality of shared secret information.<a href="#appendix-C.4-10" class="pilcrow">¶</a></p>
<p id="appendix-C.4-11">Initialization Request -- ir<a href="#appendix-C.4-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.4-12">
<pre>
Field                Value

recipient            CA name
  -- the name of the CA who is being asked to produce a certificate
protectionAlg        MSG_MAC_ALG
  -- only MAC protection is allowed for this request, based
  -- on initial authentication key
senderKID            referenceNum
  -- the reference number which the CA has previously issued
  -- to the end entity (together with the MACing key)
transactionID        present
  -- implementation-specific value, meaningful to end
  -- entity.
  -- [If already in use at the CA, then a rejection message MUST
  -- be produced by the CA]

senderNonce          present
  -- 128 (pseudo-)random bits
freeText             any valid value
body                 ir (CertReqMessages)
                     only one or two CertReqMsg
                     are allowed
  -- if more certificates are required, requests MUST be
  -- packaged in separate PKIMessages

CertReqMsg           one or two present
  -- see below for details, note: crm[0] means the first
  -- (which MUST be present), crm[1] means the second (which
  -- is OPTIONAL, and used to ask for a centrally-generated key)

crm[0].certReq.      fixed value of zero
   certReqId
  -- this is the index of the template within the message
crm[0].certReq       present
   certTemplate
  -- MUST include subject public key value, otherwise unconstrained
crm[0].pop...        optionally present if public key
   POPOSigningKey    from crm[0].certReq.certTemplate is
                     a signing key
  -- proof-of-possession MAY be required in this exchange
  -- (see Appendix D.3 for details)
crm[0].certReq.      optionally present
   controls.archiveOptions
  -- the end entity MAY request that the locally-generated
  -- private key be archived

crm[0].certReq.      optionally present
   controls.publicationInfo
  -- the end entity MAY ask for publication of resulting cert.

crm[1].certReq       fixed value of one
      certReqId
     -- the index of the template within the message
   crm[1].certReq       present
      certTemplate
      -- MUST NOT include actual public key bits, otherwise
      -- unconstrained (e.g., the names need not be the same as in
      -- crm[0]).  Note that subjectPublicKeyInfo MAY be present
      -- and contain an AlgorithmIdentifier followed by a
      -- zero-length BIT STRING for the subjectPublicKey if it is
      -- desired to inform the CA/RA of algorithm and parameter
      -- preferences regarding the to-be-generated key pair.

   crm[1].certReq.      present [object identifier MUST be
                                 PROT_ENC_ALG]

      controls.protocolEncrKey
     -- if centralized key generation is supported by this CA,
     -- this short-term asymmetric encryption key (generated by
     -- the end entity) will be used by the CA to encrypt (a
     -- symmetric key used to encrypt) a private key generated by
     -- the CA on behalf of the end entity

crm[1].certReq.      optionally present
   controls.archiveOptions
crm[1].certReq.      optionally present
   controls.publicationInfo
protection           present
  -- bits calculated using MSG_MAC_ALG
</pre><a href="#appendix-C.4-12" class="pilcrow">¶</a>
</div>
<p id="appendix-C.4-13">Initialization Response -- ip<a href="#appendix-C.4-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.4-14">
<pre>
Field                Value

sender               CA name
  -- the name of the CA who produced the message
messageTime          present
  -- time at which CA produced message
protectionAlg        MSG_MAC_ALG
  -- only MAC protection is allowed for this response
senderKID             referenceNum
  -- the reference number that the CA has previously issued to the
  -- end entity (together with the MACing key)
transactionID        present
  -- value from corresponding ir message
senderNonce          present
  -- 128 (pseudo-)random bits
recipNonce           present
  -- value from senderNonce in corresponding ir message
freeText             any valid value
body                 ip (CertRepMessage)
                     contains exactly one response
                     for each request
  -- The PKI (CA) responds to either one or two requests as
  -- appropriate.  crc[0] denotes the first (always present);
  -- crc[1] denotes the second (only present if the ir message
  -- contained two requests and if the CA supports centralized
  -- key generation).
crc[0].              fixed value of zero
   certReqId
  -- MUST contain the response to the first request in the
  -- corresponding ir message
crc[0].status.       present, positive values allowed:
   status               "accepted", "grantedWithMods"
                     negative values allowed:
                        "rejection"
crc[0].status.       present if and only if
   failInfo          crc[0].status.status is "rejection"
crc[0].              present if and only if
   certifiedKeyPair  crc[0].status.status is
                        "accepted" or "grantedWithMods"
certificate          present unless end entity's public
                     key is an encryption key and POP
                     is done in this in-band exchange
encryptedCert        present if and only if end entity's
                     public key is an encryption key and
                     POP done in this in-band exchange
publicationInfo      optionally present

  -- indicates where certificate has been published (present
  -- at discretion of CA)

crc[1].              fixed value of one
   certReqId
  -- MUST contain the response to the second request in the
  -- corresponding ir message
crc[1].status.       present, positive values allowed:
   status               "accepted", "grantedWithMods"
                     negative values allowed:
                        "rejection"
crc[1].status.       present if and only if
   failInfo          crc[0].status.status is "rejection"
crc[1].              present if and only if
   certifiedKeyPair  crc[0].status.status is "accepted"
                     or "grantedWithMods"
certificate          present
privateKey           present
  -- Use EnvelopedData; if backward compatibility is required,
  -- use EncryptedValue, see Section 5.2.2
publicationInfo      optionally present
  -- indicates where certificate has been published (present
  -- at discretion of CA)

protection           present
  -- bits calculated using MSG_MAC_ALG
extraCerts           optionally present
  -- the CA MAY provide additional certificates to the end
  -- entity
</pre><a href="#appendix-C.4-14" class="pilcrow">¶</a>
</div>
<p id="appendix-C.4-15">Certificate confirm -- certConf<a href="#appendix-C.4-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.4-16">
<pre>
Field                Value

sender               present
  -- same as in ir
recipient            CA name
  -- the name of the CA who was asked to produce a certificate
transactionID        present
  -- value from corresponding ir and ip messages
senderNonce          present
  -- 128 (pseudo-) random bits
recipNonce           present
  -- value from senderNonce in corresponding ip message
protectionAlg        MSG_MAC_ALG
  -- only MAC protection is allowed for this message.  The
  -- MAC is based on the initial authentication key shared
  -- between the EE and the CA.

senderKID            referenceNum
  -- the reference number which the CA has previously issued
  -- to the end entity (together with the MACing key)

body                 certConf
  -- see Section 5.3.18, "PKI Confirmation Content", for the
  -- contents of the certConf fields.
  -- Note: two CertStatus structures are required if both an
  -- encryption and a signing certificate were sent.

protection           present
  -- bits calculated using MSG_MAC_ALG
</pre><a href="#appendix-C.4-16" class="pilcrow">¶</a>
</div>
<p id="appendix-C.4-17">Confirmation -- PKIConf<a href="#appendix-C.4-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-C.4-18">
<pre>
Field                Value

sender               present
  -- same as in ip
recipient            present
  -- sender name from certConf
transactionID        present
  -- value from certConf message
senderNonce          present
  -- 128 (pseudo-) random bits
recipNonce           present
  -- value from senderNonce from certConf message
protectionAlg        MSG_MAC_ALG
  -- only MAC protection is allowed for this message.
senderKID            referenceNum
body                 PKIConf
protection           present
  -- bits calculated using MSG_MAC_ALG
</pre><a href="#appendix-C.4-18" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-c.5">
<section id="appendix-C.5">
        <h3 id="name-certificate-request-2">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-certificate-request-2" class="section-name selfRef">Certificate Request</a>
        </h3>
<p id="appendix-C.5-1">An (initialized) end entity requests a certificate from a CA (for any
reason).  When the CA responds with a message containing a
certificate, the end entity replies with a certificate confirmation.
The CA replies with a PKIConfirm, to close the transaction.  All
messages are authenticated.<a href="#appendix-C.5-1" class="pilcrow">¶</a></p>
<p id="appendix-C.5-2">The profile for this exchange is identical to that given in <a href="#sect-c.4" class="auto internal xref">Appendix C.4</a>,
with the following exceptions:<a href="#appendix-C.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C.5-3.1">
            <p id="appendix-C.5-3.1.1">sender name <span class="bcp14">SHOULD</span> be present<a href="#appendix-C.5-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-3.2">
            <p id="appendix-C.5-3.2.1">protectionAlg of MSG_SIG_ALG <span class="bcp14">MUST</span> be supported (MSG_MAC_ALG <span class="bcp14">MAY</span>
also be supported) in request, response, certConfirm, and
PKIConfirm messages;<a href="#appendix-C.5-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-3.3">
            <p id="appendix-C.5-3.3.1">senderKID and recipKID are only present if required for message
verification;<a href="#appendix-C.5-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-3.4">
            <p id="appendix-C.5-3.4.1">body is cr or cp;<a href="#appendix-C.5-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-3.5">
            <p id="appendix-C.5-3.5.1">body may contain one or two CertReqMsg structures, but either
CertReqMsg may be used to request certification of a
locally-generated public key or a centrally-generated public key
(i.e., the position-dependence requirement of <a href="#sect-c.4" class="auto internal xref">Appendix C.4</a> is
removed);<a href="#appendix-C.5-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-C.5-3.6">
            <p id="appendix-C.5-3.6.1">protection bits are calculated according to the protectionAlg
field.<a href="#appendix-C.5-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sect-c.6">
<section id="appendix-C.6">
        <h3 id="name-key-update-request">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-key-update-request" class="section-name selfRef">Key Update Request</a>
        </h3>
<p id="appendix-C.6-1">An (initialized) end entity requests a certificate from a CA (to
update the key pair and/or corresponding certificate that it already
possesses).  When the CA responds with a message containing a
certificate, the end entity replies with a certificate confirmation.
The CA replies with a PKIConfirm, to close the transaction.  All
messages are authenticated.<a href="#appendix-C.6-1" class="pilcrow">¶</a></p>
<p id="appendix-C.6-2">The profile for this exchange is identical to that given in <a href="#sect-c.4" class="auto internal xref">Appendix C.4</a>,
with the following exceptions:<a href="#appendix-C.6-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-C.6-3">
<li id="appendix-C.6-3.1">
            <p id="appendix-C.6-3.1.1">sender name <span class="bcp14">SHOULD</span> be present<a href="#appendix-C.6-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.6-3.2">
            <p id="appendix-C.6-3.2.1">protectionAlg of MSG_SIG_ALG <span class="bcp14">MUST</span> be supported (MSG_MAC_ALG <span class="bcp14">MAY</span>
  also be supported) in request, response, certConfirm, and
  PKIConfirm messages;<a href="#appendix-C.6-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.6-3.3">
            <p id="appendix-C.6-3.3.1">senderKID and recipKID are only present if required for message
  verification;<a href="#appendix-C.6-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.6-3.4">
            <p id="appendix-C.6-3.4.1">body is kur or kup;<a href="#appendix-C.6-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.6-3.5">
            <p id="appendix-C.6-3.5.1">body may contain one or two CertReqMsg structures, but either
  CertReqMsg may be used to request certification of a locally-generated
  public key or a centrally-generated public key (i.e.,the
  position-dependence requirement of <a href="#sect-c.4" class="auto internal xref">Appendix C.4</a> is removed);<a href="#appendix-C.6-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.6-3.6">
            <p id="appendix-C.6-3.6.1">protection bits are calculated according to the protectionAlg
  field;<a href="#appendix-C.6-3.6.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-C.6-3.7">
            <p id="appendix-C.6-3.7.1">regCtrl OldCertId <span class="bcp14">SHOULD</span> be used (unless it is clear to both
  sender and receiver -- by means not specified in this document --
  that it is not needed).<a href="#appendix-C.6-3.7.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="sect-d">
<section id="appendix-D">
      <h2 id="name-pki-management-message-profi">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-pki-management-message-profi" class="section-name selfRef">PKI Management Message Profiles (OPTIONAL)</a>
      </h2>
<p id="appendix-D-1">This appendix contains detailed profiles for those PKIMessages that
<span class="bcp14">MAY</span> be supported by implementations.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">Profiles for the PKIMessages used in the following PKI management
operations are provided:<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-3.1">
          <p id="appendix-D-3.1.1">root CA key update<a href="#appendix-D-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-3.2">
          <p id="appendix-D-3.2.1">information request/response<a href="#appendix-D-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-3.3">
          <p id="appendix-D-3.3.1">cross-certification request/response (1-way)<a href="#appendix-D-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-3.4">
          <p id="appendix-D-3.4.1">in-band initialization using external identity certificate<a href="#appendix-D-3.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-D-4">Later versions of this document may extend the above to include
profiles for the operations listed below (along with other
operations, if desired).<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D-5.1">
          <p id="appendix-D-5.1.1">revocation request<a href="#appendix-D-5.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.2">
          <p id="appendix-D-5.2.1">certificate publication<a href="#appendix-D-5.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-D-5.3">
          <p id="appendix-D-5.3.1">CRL publication<a href="#appendix-D-5.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="sect-d.1">
<section id="appendix-D.1">
        <h3 id="name-general-rules-for-interpreta">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-general-rules-for-interpreta" class="section-name selfRef">General Rules for Interpretation of These Profiles.</a>
        </h3>
<p id="appendix-D.1-1">Identical to <a href="#sect-c.1" class="auto internal xref">Appendix C.1</a>.<a href="#appendix-D.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-d.2">
<section id="appendix-D.2">
        <h3 id="name-algorithm-use-profile-2">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-algorithm-use-profile-2" class="section-name selfRef">Algorithm Use Profile</a>
        </h3>
<p id="appendix-D.2-1">Identical to <a href="#sect-c.2" class="auto internal xref">Appendix C.2</a>.<a href="#appendix-D.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-d.3">
<section id="appendix-D.3">
        <h3 id="name-self-signed-certificates">
<a href="#appendix-D.3" class="section-number selfRef">D.3. </a><a href="#name-self-signed-certificates" class="section-name selfRef">Self-Signed Certificates</a>
        </h3>
<p id="appendix-D.3-1">Profile of how a Certificate structure may be "self-signed".  These
structures are used for distribution of CA public keys.  This can
occur in one of three ways (see <a href="#sect-4.4" class="auto internal xref">Section 4.4</a> above for a description
of the use of these structures):<a href="#appendix-D.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
          <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Function</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">newWithNew</td>
              <td class="text-left" rowspan="1" colspan="1">a true "self-signed" certificate; the contained public key <span class="bcp14">MUST</span> be usable to verify the signature (though this provides only integrity and no authentication whatsoever)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">oldWithNew</td>
              <td class="text-left" rowspan="1" colspan="1">previous root CA public key signed with new private key</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">newWithOld</td>
              <td class="text-left" rowspan="1" colspan="1">new root CA public key signed with previous private key</td>
            </tr>
          </tbody>
        </table>
<p id="appendix-D.3-3">Such certificates (including relevant extensions) must contain
"sensible" values for all fields.  For example, when present,
subjectAltName <span class="bcp14">MUST</span> be identical to issuerAltName, and, when present,
keyIdentifiers must contain appropriate values, et cetera.<a href="#appendix-D.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-d.4">
<section id="appendix-D.4">
        <h3 id="name-root-ca-key-update-3">
<a href="#appendix-D.4" class="section-number selfRef">D.4. </a><a href="#name-root-ca-key-update-3" class="section-name selfRef">Root CA Key Update</a>
        </h3>
<p id="appendix-D.4-1">A root CA updates its key pair.  It then produces a CA key update
announcement message that can be made available (via some transport
mechanism) to the relevant end entities.  A confirmation message is
not required from the end entities.<a href="#appendix-D.4-1" class="pilcrow">¶</a></p>
<p id="appendix-D.4-2">ckuann message:<a href="#appendix-D.4-2" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Field</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Comment</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">sender</td>
              <td class="text-left" rowspan="1" colspan="1">CA name CA name</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">body</td>
              <td class="text-left" rowspan="1" colspan="1">ckuann(RootCaKeyUpdateContent)</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">newWithNew</td>
              <td class="text-left" rowspan="1" colspan="1">optionally present</td>
              <td class="text-left" rowspan="1" colspan="1">see <a href="#sect-d.3" class="auto internal xref">Appendix D.3</a> above</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">newWithOld</td>
              <td class="text-left" rowspan="1" colspan="1">optionally present</td>
              <td class="text-left" rowspan="1" colspan="1">see <a href="#sect-d.3" class="auto internal xref">Appendix D.3</a> above</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">oldWithNew</td>
              <td class="text-left" rowspan="1" colspan="1">optionally present</td>
              <td class="text-left" rowspan="1" colspan="1">see <a href="#sect-d.3" class="auto internal xref">Appendix D.3</a> above</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">extraCerts</td>
              <td class="text-left" rowspan="1" colspan="1">optionally present</td>
              <td class="text-left" rowspan="1" colspan="1">can be used to "publish" certificates (e.g., certificates signed using the new private key)</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="sect-d.5">
<section id="appendix-D.5">
        <h3 id="name-pki-information-request-res">
<a href="#appendix-D.5" class="section-number selfRef">D.5. </a><a href="#name-pki-information-request-res" class="section-name selfRef">PKI Information Request/Response</a>
        </h3>
<p id="appendix-D.5-1">The end entity sends a general message to the PKI requesting details
that will be required for later PKI management operations.  RA/CA
responds with a general response.  If an RA generates the response,
then it will simply forward the equivalent message that it previously
received from the CA, with the possible addition of certificates to
the extraCerts fields of the PKIMessage.  A confirmation message is
not required from the end entity.<a href="#appendix-D.5-1" class="pilcrow">¶</a></p>
<p id="appendix-D.5-2">Message Flows:<a href="#appendix-D.5-2" class="pilcrow">¶</a></p>
<div id="appendix-D.5-3">
          <div class="alignLeft art-svg artwork" id="appendix-D.5-3.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="160" width="560" viewBox="0 0 560 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 552,48" fill="none" stroke="black"></path>
              <g class="text">
                <text x="24" y="36">Step#</text>
                <text x="64" y="36">End</text>
                <text x="108" y="36">entity</text>
                <text x="336" y="36">PKI</text>
                <text x="24" y="68">1</text>
                <text x="76" y="68">format</text>
                <text x="124" y="68">genm</text>
                <text x="24" y="84">2</text>
                <text x="172" y="84">-&gt;</text>
                <text x="220" y="84">genm</text>
                <text x="268" y="84">-&gt;</text>
                <text x="24" y="100">3</text>
                <text x="348" y="100">handle</text>
                <text x="396" y="100">genm</text>
                <text x="24" y="116">4</text>
                <text x="352" y="116">produce</text>
                <text x="404" y="116">genp</text>
                <text x="24" y="132">5</text>
                <text x="172" y="132">&lt;-</text>
                <text x="220" y="132">genp</text>
                <text x="268" y="132">&lt;-</text>
                <text x="24" y="148">6</text>
                <text x="76" y="148">handle</text>
                <text x="124" y="148">genp</text>
              </g>
            </svg><a href="#appendix-D.5-3.1" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-D.5-4">genM:<a href="#appendix-D.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.5-5">
<pre>
Field               Value

recipient           CA name
  -- the name of the CA as contained in issuerAltName
  -- extensions or issuer fields within certificates
protectionAlg       MSG_MAC_ALG or MSG_SIG_ALG
  -- any authenticated protection alg.
SenderKID           present if required
  -- must be present if required for verification of message
  -- protection
freeText            any valid value
body                genr (GenReqContent)
GenMsgContent       empty SEQUENCE
  -- all relevant information requested
protection          present
  -- bits calculated using MSG_MAC_ALG or MSG_SIG_ALG
</pre><a href="#appendix-D.5-5" class="pilcrow">¶</a>
</div>
<p id="appendix-D.5-6">genP:<a href="#appendix-D.5-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.5-7">
<pre>
Field                Value

sender               CA name
  -- name of the CA which produced the message
protectionAlg        MSG_MAC_ALG or MSG_SIG_ALG
  -- any authenticated protection alg.
senderKID            present if required
  -- must be present if required for verification of message
  -- protection
body                 genp (GenRepContent)
CAProtEncCert        present (object identifier one
                     of PROT_ENC_ALG), with relevant
                     value
  -- to be used if end entity needs to encrypt information for
  -- the CA (e.g., private key for recovery purposes)

SignKeyPairTypes     present, with relevant value
  -- the set of signature algorithm identifiers that this CA will
  -- certify for subject public keys
EncKeyPairTypes      present, with relevant value
  -- the set of encryption/key agreement algorithm identifiers that
  -- this CA will certify for subject public keys
PreferredSymmAlg     present (object identifier one
                     of PROT_SYM_ALG) , with relevant
                     value
  -- the symmetric algorithm that this CA expects to be used
  -- in later PKI messages (for encryption)
RootCaKeyUpdate      optionally present, with
                     relevant value
  -- Use RootCaKeyUpdate; if backward compatibility with cmp2000 is
  -- required, use CAKeyUpdateInfo.
  -- The CA MAY provide information about a relevant root CA
  -- key pair using this field (note that this does not imply
  -- that the responding CA is the root CA in question)
CurrentCRL           optionally present, with relevant value
  -- the CA MAY provide a copy of a complete CRL (i.e.,
  -- fullest possible one)
protection           present
  -- bits calculated using MSG_MAC_ALG or MSG_SIG_ALG
extraCerts           optionally present
  -- can be used to send some certificates to the end
  -- entity. An RA MAY add its certificate here.
</pre><a href="#appendix-D.5-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-d.6">
<section id="appendix-D.6">
        <h3 id="name-cross-certification-request-">
<a href="#appendix-D.6" class="section-number selfRef">D.6. </a><a href="#name-cross-certification-request-" class="section-name selfRef">Cross Certification Request/Response (1-way)</a>
        </h3>
<p id="appendix-D.6-1">Creation of a single cross-certificate (i.e., not two at once).  The
requesting CA <span class="bcp14">MAY</span> choose who is responsible for publication of the
cross-certificate created by the responding CA through use of the
PKIPublicationInfo control.<a href="#appendix-D.6-1" class="pilcrow">¶</a></p>
<p id="appendix-D.6-2">Preconditions:<a href="#appendix-D.6-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-D.6-3">
<li id="appendix-D.6-3.1">
            <p id="appendix-D.6-3.1.1">Responding CA can verify the origin of the request (possibly
  requiring out-of-band means) before processing the request.<a href="#appendix-D.6-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="appendix-D.6-3.2">
            <p id="appendix-D.6-3.2.1">Requesting CA can authenticate the authenticity of the origin of
  the response (possibly requiring out-of-band means) before
  processing the response<a href="#appendix-D.6-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="appendix-D.6-4">The use of certificate confirmation and the corresponding server
confirmation is determined by the generalInfo field in the PKIHeader
(see <a href="#sect-5.1.1" class="auto internal xref">Section 5.1.1</a>).  The following profile does not mandate support
for either confirmation.<a href="#appendix-D.6-4" class="pilcrow">¶</a></p>
<p id="appendix-D.6-5">Message Flows:<a href="#appendix-D.6-5" class="pilcrow">¶</a></p>
<div id="appendix-D.6-6">
          <div class="alignLeft art-svg artwork" id="appendix-D.6-6.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="160" width="560" viewBox="0 0 560 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,48 L 552,48" fill="none" stroke="black"></path>
              <g class="text">
                <text x="24" y="36">Step#</text>
                <text x="92" y="36">Requesting</text>
                <text x="148" y="36">CA</text>
                <text x="380" y="36">Responding</text>
                <text x="436" y="36">CA</text>
                <text x="24" y="68">1</text>
                <text x="76" y="68">format</text>
                <text x="120" y="68">ccr</text>
                <text x="24" y="84">2</text>
                <text x="188" y="84">-&gt;</text>
                <text x="240" y="84">ccr</text>
                <text x="292" y="84">-&gt;</text>
                <text x="24" y="100">3</text>
                <text x="364" y="100">handle</text>
                <text x="408" y="100">ccr</text>
                <text x="24" y="116">4</text>
                <text x="368" y="116">produce</text>
                <text x="416" y="116">ccp</text>
                <text x="24" y="132">5</text>
                <text x="188" y="132">&lt;-</text>
                <text x="240" y="132">ccp</text>
                <text x="292" y="132">&lt;-</text>
                <text x="24" y="148">6</text>
                <text x="76" y="148">handle</text>
                <text x="120" y="148">ccp</text>
              </g>
            </svg><a href="#appendix-D.6-6.1" class="pilcrow">¶</a>
</div>
</div>
<p id="appendix-D.6-7">ccr:<a href="#appendix-D.6-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.6-8">
<pre>
Field                 Value

sender                Requesting CA name
  -- the name of the CA who produced the message
recipient             Responding CA name
  -- the name of the CA who is being asked to produce a certificate
messageTime           time of production of message
  -- current time at requesting CA
protectionAlg         MSG_SIG_ALG
  -- only signature protection is allowed for this request
senderKID             present if required
  -- must be present if required for verification of message
  -- protection
recipKID             present if required
  -- must be present if required for verification of message
  -- protection
transactionID         present
  -- implementation-specific value, meaningful to requesting CA.
  -- [If already in use at responding CA then a rejection message
  -- MUST be produced by responding CA]
senderNonce           present
  -- 128 (pseudo-)random bits
freeText              any valid value
body                  ccr (CertReqMessages)
                      only one CertReqMsg
                      allowed
  -- if multiple cross certificates are required, they MUST be
  -- packaged in separate PKIMessages
certTemplate          present
  -- details follow
version               v1 or v3
  -- v3 STRONGLY RECOMMENDED
signingAlg            present
  -- the requesting CA must know in advance with which algorithm it
  -- wishes the certificate to be signed

subject               present
  -- may be NULL-DN only if subjectAltNames extension value proposed
validity              present
  -- MUST be completely specified (i.e., both fields present)
issuer                present
  -- may be NULL-DN only if issuerAltNames extension value proposed
publicKey             present
  -- the key to be certified (which must be for a signing algorithm)
extensions            optionally present
  -- a requesting CA must propose values for all extensions
  -- that it requires to be in the cross-certificate
POPOSigningKey        present
  -- see Section D3: Proof-of-possession profile
protection            present
  -- bits calculated using MSG_SIG_ALG
extraCerts            optionally present
  -- MAY contain any additional certificates that requester wishes
  -- to include
</pre><a href="#appendix-D.6-8" class="pilcrow">¶</a>
</div>
<p id="appendix-D.6-9">ccp:<a href="#appendix-D.6-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.6-10">
<pre>
Field                 Value

sender                Responding CA name
  -- the name of the CA who produced the message
recipient             Requesting CA name
  -- the name of the CA who asked for production of a certificate
messageTime           time of production of message
  -- current time at responding CA
protectionAlg         MSG_SIG_ALG
  -- only signature protection is allowed for this message
senderKID             present if required
  -- must be present if required for verification of message
  -- protection
recipKID              present if required
transactionID         present
  -- value from corresponding ccr message
senderNonce           present
  -- 128 (pseudo-)random bits
recipNonce            present
-- senderNonce from corresponding ccr message
freeText              any valid value
body                  ccp (CertRepMessage)
                      only one CertResponse allowed
  -- if multiple cross certificates are required they MUST be
  -- packaged in separate PKIMessages
response              present
status                present

PKIStatusInfo.status  present
  -- if PKIStatusInfo.status is one of:
  --   accepted, or
  --   grantedWithMods,
  -- then certifiedKeyPair MUST be present and failInfo MUST
  -- be absent

failInfo              present depending on
                      PKIStatusInfo.status
  -- if PKIStatusInfo.status is:
  --   rejection
  -- then certifiedKeyPair MUST be absent and failInfo MUST be
  -- present and contain appropriate bit settings

certifiedKeyPair      present depending on
                      PKIStatusInfo.status
certificate           present depending on
                      certifiedKeyPair
  -- content of actual certificate must be examined by requesting CA
  -- before publication
protection            present
  -- bits calculated using MSG_SIG_ALG
extraCerts            optionally present
  -- MAY contain any additional certificates that responder wishes
  -- to include
</pre><a href="#appendix-D.6-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-d.7">
<section id="appendix-D.7">
        <h3 id="name-in-band-initialization-usin">
<a href="#appendix-D.7" class="section-number selfRef">D.7. </a><a href="#name-in-band-initialization-usin" class="section-name selfRef">In-Band Initialization Using External Identity Certificate</a>
        </h3>
<p id="appendix-D.7-1">An (uninitialized) end entity wishes to initialize into the PKI with
a CA, CA-1.  It uses, for authentication purposes, a pre-existing
identity certificate issued by another (external) CA, CA-X.  A trust
relationship must already have been established between CA-1 and CA-X
so that CA-1 can validate the EE identity certificate signed by CA-X.
Furthermore, some mechanism must already have been established within
the Trusted Execution Environment (TEE) also known as
Personal Security Environment (PSE) of the EE that would allow it
to authenticate and verify PKIMessages signed by CA-1 (as one
example, the TEE may contain a certificate issued for the public key
of CA-1, signed by another CA that the EE trusts on the basis of
out-of-band authentication techniques).<a href="#appendix-D.7-1" class="pilcrow">¶</a></p>
<p id="appendix-D.7-2">The EE sends an initialization request to start the transaction.
When CA-1 responds with a message containing the new certificate, the
end entity replies with a certificate confirmation.  CA-1 replies
with a PKIConfirm to close the transaction.  All messages are signed
(the EE messages are signed using the private key that corresponds to
the public key in its external identity certificate; the CA-1
messages are signed using the private key that corresponds to the
public key in a certificate that can be chained to a trust anchor in the EE's TEE).<a href="#appendix-D.7-2" class="pilcrow">¶</a></p>
<p id="appendix-D.7-3">The profile for this exchange is identical to that given in <a href="#sect-c.4" class="auto internal xref">Appendix C.4</a>,
with the following exceptions:<a href="#appendix-D.7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-D.7-4.1">
            <p id="appendix-D.7-4.1.1">the EE and CA-1 do not share a symmetric MACing key (i.e., there
is no out-of-band shared secret information between these
entities);<a href="#appendix-D.7-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-4.2">
            <p id="appendix-D.7-4.2.1">sender name in ir <span class="bcp14">MUST</span> be present (and identical to the subject
name present in the external identity certificate);<a href="#appendix-D.7-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-4.3">
            <p id="appendix-D.7-4.3.1">protectionAlg of MSG_SIG_ALG <span class="bcp14">MUST</span> be used in all messages;<a href="#appendix-D.7-4.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-4.4">
            <p id="appendix-D.7-4.4.1">external identity cert.  <span class="bcp14">MUST</span> be carried in ir extraCerts field<a href="#appendix-D.7-4.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-4.5">
            <p id="appendix-D.7-4.5.1">senderKID and recipKID are not used;<a href="#appendix-D.7-4.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-4.6">
            <p id="appendix-D.7-4.6.1">body is ir or ip;<a href="#appendix-D.7-4.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-D.7-4.7">
            <p id="appendix-D.7-4.7.1">protection bits are calculated according to the protectionAlg
field.<a href="#appendix-D.7-4.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sect-e">
<section id="appendix-E">
      <h2 id="name-variants-of-using-kem-keys-">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-variants-of-using-kem-keys-" class="section-name selfRef">Variants of Using KEM Keys for PKI Message Protection</a>
      </h2>
<p id="appendix-E-1">As described in <a href="#sect-5.1.3.4" class="auto internal xref">Section 5.1.3.4</a>, any party in a PKI management operation may wish to use a KEM key pair for message protection. Below possible cases are described.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">For any PKI management operation started by a PKI entity with any type of request message, the following message flows describe the use of a KEM key. There are two cases to distinguish, namely whether the PKI entity or the PKI management entity owns a KEM key pair. If both sides own KEM key pairs, the flows need to be combined such that for each direction a shared secret key is established.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<p id="appendix-E-3">In the following message flows Alice indicates the PKI entity that uses a KEM key pair for message authentication and Bob provides the KEM ciphertext using Alice's public KEM key, as described in <a href="#sect-5.1.3.4" class="auto internal xref">Section 5.1.3.4</a>.<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<p id="appendix-E-4">Message Flow when the PKI entity has a KEM key pair and certificate:<a href="#appendix-E-4" class="pilcrow">¶</a></p>
<span id="name-message-flow-when-pki-entit"></span><div id="KEM-Flow1">
<figure id="figure-3">
        <div id="appendix-E-5.1">
          <div class="alignLeft art-svg artwork" id="appendix-E-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="688" width="560" viewBox="0 0 560 688" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,64 L 552,64" fill="none" stroke="black"></path>
              <path d="M 8,480 L 64,480" fill="none" stroke="black"></path>
              <path d="M 496,480 L 552,480" fill="none" stroke="black"></path>
              <g class="text">
                <text x="24" y="36">Step#</text>
                <text x="64" y="36">PKI</text>
                <text x="108" y="36">entity</text>
                <text x="360" y="36">PKI</text>
                <text x="420" y="36">management</text>
                <text x="492" y="36">entity</text>
                <text x="80" y="52">(Alice)</text>
                <text x="368" y="52">(Bob)</text>
                <text x="24" y="84">1</text>
                <text x="76" y="84">format</text>
                <text x="152" y="84">unprotected</text>
                <text x="220" y="84">genm</text>
                <text x="76" y="100">of</text>
                <text x="108" y="100">type</text>
                <text x="136" y="116">KemCiphertextInfo</text>
                <text x="96" y="132">without</text>
                <text x="156" y="132">value,</text>
                <text x="200" y="132">and</text>
                <text x="80" y="148">KEM</text>
                <text x="144" y="148">certificate</text>
                <text x="204" y="148">in</text>
                <text x="108" y="164">extraCerts</text>
                <text x="24" y="180">2</text>
                <text x="212" y="180">-&gt;</text>
                <text x="260" y="180">genm</text>
                <text x="316" y="180">-&gt;</text>
                <text x="24" y="196">3</text>
                <text x="380" y="196">validate</text>
                <text x="432" y="196">KEM</text>
                <text x="496" y="196">certificate</text>
                <text x="24" y="212">4</text>
                <text x="376" y="212">perform</text>
                <text x="424" y="212">KEM</text>
                <text x="488" y="212">Encapsulate</text>
                <text x="24" y="228">5</text>
                <text x="372" y="228">format</text>
                <text x="448" y="228">unprotected</text>
                <text x="516" y="228">genp</text>
                <text x="372" y="244">of</text>
                <text x="404" y="244">type</text>
                <text x="432" y="260">KemCiphertextInfo</text>
                <text x="400" y="276">providing</text>
                <text x="456" y="276">KEM</text>
                <text x="516" y="276">ciphertext</text>
                <text x="24" y="292">6</text>
                <text x="212" y="292">&lt;-</text>
                <text x="260" y="292">genp</text>
                <text x="316" y="292">&lt;-</text>
                <text x="24" y="308">7</text>
                <text x="80" y="308">perform</text>
                <text x="128" y="308">KEM</text>
                <text x="192" y="308">Decapsulate</text>
                <text x="24" y="324">8</text>
                <text x="80" y="324">perform</text>
                <text x="128" y="324">key</text>
                <text x="188" y="324">derivation</text>
                <text x="76" y="340">to</text>
                <text x="104" y="340">get</text>
                <text x="136" y="340">ssk</text>
                <text x="24" y="356">9</text>
                <text x="76" y="356">format</text>
                <text x="136" y="356">request</text>
                <text x="188" y="356">with</text>
                <text x="104" y="372">MAC-based</text>
                <text x="188" y="372">protection</text>
                <text x="20" y="388">10</text>
                <text x="212" y="388">-&gt;</text>
                <text x="264" y="388">request</text>
                <text x="316" y="388">-&gt;</text>
                <text x="20" y="404">11</text>
                <text x="376" y="404">perform</text>
                <text x="424" y="404">key</text>
                <text x="484" y="404">derivation</text>
                <text x="372" y="420">to</text>
                <text x="400" y="420">get</text>
                <text x="432" y="420">ssk</text>
                <text x="20" y="436">12</text>
                <text x="372" y="436">verify</text>
                <text x="440" y="436">MAC-based</text>
                <text x="404" y="452">protection</text>
                <text x="96" y="484">PKI</text>
                <text x="140" y="484">entity</text>
                <text x="224" y="484">authenticated</text>
                <text x="292" y="484">by</text>
                <text x="320" y="484">PKI</text>
                <text x="380" y="484">management</text>
                <text x="452" y="484">entity</text>
                <text x="20" y="516">13</text>
                <text x="372" y="516">format</text>
                <text x="436" y="516">response</text>
                <text x="492" y="516">with</text>
                <text x="404" y="532">protection</text>
                <text x="488" y="532">depending</text>
                <text x="540" y="532">on</text>
                <text x="400" y="548">available</text>
                <text x="456" y="548">key</text>
                <text x="508" y="548">material</text>
                <text x="20" y="564">14</text>
                <text x="212" y="564">&lt;-</text>
                <text x="268" y="564">response</text>
                <text x="316" y="564">&lt;-</text>
                <text x="20" y="580">15</text>
                <text x="76" y="580">verify</text>
                <text x="148" y="580">protection</text>
                <text x="100" y="596">provided</text>
                <text x="148" y="596">by</text>
                <text x="176" y="596">the</text>
                <text x="80" y="612">PKI</text>
                <text x="140" y="612">management</text>
                <text x="212" y="612">entity</text>
                <text x="20" y="644">16</text>
                <text x="112" y="644">Further</text>
                <text x="180" y="644">messages</text>
                <text x="228" y="644">of</text>
                <text x="260" y="644">this</text>
                <text x="296" y="644">PKI</text>
                <text x="356" y="644">management</text>
                <text x="440" y="644">operation</text>
                <text x="80" y="660">can</text>
                <text x="108" y="660">be</text>
                <text x="160" y="660">exchanged</text>
                <text x="220" y="660">with</text>
                <text x="280" y="660">MAC-based</text>
                <text x="364" y="660">protection</text>
                <text x="420" y="660">by</text>
                <text x="448" y="660">the</text>
                <text x="480" y="660">PKI</text>
                <text x="100" y="676">entity</text>
                <text x="152" y="676">using</text>
                <text x="192" y="676">the</text>
                <text x="256" y="676">established</text>
                <text x="332" y="676">shared</text>
                <text x="388" y="676">secret</text>
                <text x="432" y="676">key</text>
                <text x="472" y="676">(ssk)</text>
              </g>
            </svg><a href="#appendix-E-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-message-flow-when-pki-entit" class="selfRef">Message Flow when PKI entity has a KEM key pair</a>
        </figcaption></figure>
</div>
<p id="appendix-E-6">Message Flow when the PKI entity knows that the PKI management entity uses a KEM key pair and has the authentic public key:<a href="#appendix-E-6" class="pilcrow">¶</a></p>
<span id="name-message-flow-when-the-pki-e"></span><div id="KEM-Flow2">
<figure id="figure-4">
        <div id="appendix-E-7.1">
          <div class="alignLeft art-svg artwork" id="appendix-E-7.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="496" width="560" viewBox="0 0 560 496" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,64 L 552,64" fill="none" stroke="black"></path>
              <path d="M 8,400 L 64,400" fill="none" stroke="black"></path>
              <path d="M 496,400 L 552,400" fill="none" stroke="black"></path>
              <g class="text">
                <text x="24" y="36">Step#</text>
                <text x="64" y="36">PKI</text>
                <text x="108" y="36">entity</text>
                <text x="360" y="36">PKI</text>
                <text x="420" y="36">management</text>
                <text x="492" y="36">entity</text>
                <text x="72" y="52">(Bob)</text>
                <text x="376" y="52">(Alice)</text>
                <text x="24" y="84">1</text>
                <text x="80" y="84">perform</text>
                <text x="128" y="84">KEM</text>
                <text x="192" y="84">Encapsulate</text>
                <text x="24" y="100">2</text>
                <text x="76" y="100">format</text>
                <text x="136" y="100">request</text>
                <text x="208" y="100">providing</text>
                <text x="80" y="116">KEM</text>
                <text x="140" y="116">ciphertext</text>
                <text x="196" y="116">in</text>
                <text x="112" y="132">generalInfo</text>
                <text x="172" y="132">of</text>
                <text x="204" y="132">type</text>
                <text x="140" y="148">KemCiphertextInfo,</text>
                <text x="80" y="164">and</text>
                <text x="116" y="164">with</text>
                <text x="180" y="164">protection</text>
                <text x="104" y="180">depending</text>
                <text x="156" y="180">on</text>
                <text x="208" y="180">available</text>
                <text x="80" y="196">key</text>
                <text x="132" y="196">material</text>
                <text x="24" y="212">3</text>
                <text x="212" y="212">-&gt;</text>
                <text x="264" y="212">request</text>
                <text x="316" y="212">-&gt;</text>
                <text x="24" y="228">4</text>
                <text x="376" y="228">perform</text>
                <text x="424" y="228">KEM</text>
                <text x="488" y="228">Decapsulate</text>
                <text x="24" y="244">5</text>
                <text x="376" y="244">perform</text>
                <text x="424" y="244">key</text>
                <text x="484" y="244">derivation</text>
                <text x="372" y="260">to</text>
                <text x="400" y="260">get</text>
                <text x="432" y="260">ssk</text>
                <text x="24" y="276">6</text>
                <text x="372" y="276">format</text>
                <text x="436" y="276">response</text>
                <text x="492" y="276">with</text>
                <text x="400" y="292">MAC-based</text>
                <text x="484" y="292">protection</text>
                <text x="24" y="308">7</text>
                <text x="212" y="308">&lt;-</text>
                <text x="268" y="308">response</text>
                <text x="316" y="308">&lt;-</text>
                <text x="24" y="324">8</text>
                <text x="80" y="324">perform</text>
                <text x="128" y="324">key</text>
                <text x="188" y="324">derivation</text>
                <text x="76" y="340">to</text>
                <text x="104" y="340">get</text>
                <text x="136" y="340">ssk</text>
                <text x="24" y="356">9</text>
                <text x="76" y="356">verify</text>
                <text x="144" y="356">MAC-based</text>
                <text x="108" y="372">protection</text>
                <text x="96" y="404">PKI</text>
                <text x="156" y="404">management</text>
                <text x="228" y="404">entity</text>
                <text x="312" y="404">authenticated</text>
                <text x="380" y="404">by</text>
                <text x="408" y="404">PKI</text>
                <text x="452" y="404">entity</text>
                <text x="20" y="436">10</text>
                <text x="112" y="436">Further</text>
                <text x="180" y="436">messages</text>
                <text x="228" y="436">of</text>
                <text x="260" y="436">this</text>
                <text x="296" y="436">PKI</text>
                <text x="356" y="436">management</text>
                <text x="440" y="436">operation</text>
                <text x="96" y="452">can</text>
                <text x="124" y="452">be</text>
                <text x="176" y="452">exchanged</text>
                <text x="236" y="452">with</text>
                <text x="296" y="452">MAC-based</text>
                <text x="380" y="452">protection</text>
                <text x="436" y="452">by</text>
                <text x="464" y="452">the</text>
                <text x="120" y="468">PKI</text>
                <text x="180" y="468">management</text>
                <text x="252" y="468">entity</text>
                <text x="304" y="468">using</text>
                <text x="344" y="468">the</text>
                <text x="408" y="468">established</text>
                <text x="220" y="484">shared</text>
                <text x="276" y="484">secret</text>
                <text x="320" y="484">key</text>
                <text x="360" y="484">(ssk)</text>
              </g>
            </svg><a href="#appendix-E-7.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-message-flow-when-the-pki-e" class="selfRef">Message Flow when the PKI entity knows that the PKI management entity uses a KEM key pair and has the authentic public key</a>
        </figcaption></figure>
</div>
<p id="appendix-E-8">Note: <a href="#KEM-Flow2" class="auto internal xref">Figure 4</a> describes the situation where KEM-based message protection may not require more that one message exchange.  In this case, the transactionID <span class="bcp14">MUST</span> also be used by the PKI entity (Bob) to ensure domain separation between different PKI management operations.<a href="#appendix-E-8" class="pilcrow">¶</a></p>
<p id="appendix-E-9">Message Flow when the PKI entity does not know that the PKI management entity uses a KEM key pair:<a href="#appendix-E-9" class="pilcrow">¶</a></p>
<span id="name-message-flow-when-the-pki-en"></span><div id="KEM-Flow3">
<figure id="figure-5">
        <div id="appendix-E-10.1">
          <div class="alignLeft art-svg artwork" id="appendix-E-10.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="320" width="560" viewBox="0 0 560 320" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,64 L 552,64" fill="none" stroke="black"></path>
              <g class="text">
                <text x="24" y="36">Step#</text>
                <text x="64" y="36">PKI</text>
                <text x="108" y="36">entity</text>
                <text x="360" y="36">PKI</text>
                <text x="420" y="36">management</text>
                <text x="492" y="36">entity</text>
                <text x="72" y="52">(Bob)</text>
                <text x="376" y="52">(Alice)</text>
                <text x="24" y="84">1</text>
                <text x="76" y="84">format</text>
                <text x="136" y="84">request</text>
                <text x="188" y="84">with</text>
                <text x="108" y="100">protection</text>
                <text x="192" y="100">depending</text>
                <text x="76" y="116">on</text>
                <text x="128" y="116">available</text>
                <text x="184" y="116">key</text>
                <text x="100" y="132">material</text>
                <text x="24" y="148">2</text>
                <text x="212" y="148">-&gt;</text>
                <text x="264" y="148">request</text>
                <text x="316" y="148">-&gt;</text>
                <text x="24" y="164">3</text>
                <text x="372" y="164">format</text>
                <text x="448" y="164">unprotected</text>
                <text x="520" y="164">error</text>
                <text x="380" y="180">with</text>
                <text x="428" y="180">status</text>
                <text x="504" y="180">"rejection"</text>
                <text x="376" y="196">and</text>
                <text x="428" y="196">failInfo</text>
                <text x="428" y="212">"wrongIntegrity"</text>
                <text x="512" y="212">and</text>
                <text x="544" y="212">KEM</text>
                <text x="408" y="228">certificate</text>
                <text x="468" y="228">in</text>
                <text x="404" y="244">extraCerts</text>
                <text x="24" y="260">4</text>
                <text x="212" y="260">&lt;-</text>
                <text x="264" y="260">error</text>
                <text x="316" y="260">&lt;-</text>
                <text x="24" y="276">5</text>
                <text x="84" y="276">validate</text>
                <text x="136" y="276">KEM</text>
                <text x="200" y="276">certificate</text>
                <text x="24" y="308">6</text>
                <text x="168" y="308">proceed</text>
                <text x="212" y="308">as</text>
                <text x="248" y="308">shown</text>
                <text x="284" y="308">in</text>
                <text x="312" y="308">the</text>
                <text x="356" y="308">Figure</text>
                <text x="412" y="308">before</text>
              </g>
            </svg><a href="#appendix-E-10.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-message-flow-when-the-pki-en" class="selfRef">Message Flow when the PKI entity does not know that the PKI management entity uses a KEM key pair</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sect-f">
<section id="appendix-F">
      <h2 id="name-compilable-asn1-definitions">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-compilable-asn1-definitions" class="section-name selfRef">Compilable ASN.1 Definitions</a>
      </h2>
<p id="appendix-F-1">This section contains the updated 2002 ASN.1 module for <span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span>
as updated in <span>[<a href="#RFC9480" class="cite xref">RFC9480</a>]</span>.
This module replaces the module in Section 9 of <span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span>.
The module contains those changes to the normative ASN.1 module from
Appendix F of <span>[<a href="#RFC4210" class="cite xref">RFC4210</a>]</span> that were specified in <span>[<a href="#RFC9480" class="cite xref">RFC9480</a>]</span>,
as well as changes made in this document.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<div class="breakable lang-asn.1 sourcecode" id="appendix-F-2">
<pre>
PKIXCMP-2023
    { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-cmp2023-02(TBD2) }
DEFINITIONS EXPLICIT TAGS ::=
BEGIN
IMPORTS

AttributeSet{}, SingleAttribute{}, Extensions{}, EXTENSION, ATTRIBUTE
FROM PKIX-CommonTypes-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkixCommon-02(57)}

AlgorithmIdentifier{}, SIGNATURE-ALGORITHM, ALGORITHM,
    DIGEST-ALGORITHM, MAC-ALGORITHM, KEY-DERIVATION
FROM AlgorithmInformation-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0)
    id-mod-algorithmInformation-02(58)}

Certificate, CertificateList, Time, id-kp
FROM PKIX1Explicit-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-explicit-02(51)}

DistributionPointName, GeneralNames, GeneralName, KeyIdentifier
FROM PKIX1Implicit-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-implicit-02(59)}

CertTemplate, PKIPublicationInfo, EncryptedKey, CertId,
    CertReqMessages, Controls, RegControlSet, id-regCtrl
FROM PKIXCRMF-2009
    { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-crmf2005-02(55) }
    -- The import of EncryptedKey is added due to the updates made
    -- in [RFC9480]. EncryptedValue does not need to be imported
    -- anymore and is therefore removed here.

CertificationRequest
FROM PKCS-10
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkcs10-2009(69)}
-- (specified in [RFC2986] with 1993 ASN.1 syntax and IMPLICIT
-- tags).  Alternatively, implementers may directly include
-- the syntax of [RFC2986] in this module.

localKeyId
FROM PKCS-9
    {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
    modules(0) pkcs-9(1)}
    -- The import of localKeyId is added due to the updates made in
    -- [RFC9480]

EnvelopedData, SignedData
FROM CryptographicMessageSyntax-2010
    {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
    smime(16) modules(0) id-mod-cms-2009(58)}
    -- The import of EnvelopedData and SignedData from [RFC6268] is
    -- added due to the updates made in CMP Updates [RFC9480]

KEM-ALGORITHM
FROM KEMAlgorithmInformation-2023  -- [RFC9629]
    { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-kemAlgorithmInformation-2023(109) }
    -- The import of KEM-ALGORITHM was added due to the updates made
    -- in [RFCXXXX]
;

-- History of the PKIXCMP ASN.1 modules
-- [RFC2510]
--    1988 Syntax, PKIXCMP, 1.3.6.1.5.5.7.0.9 (id-mod-cmp)
--    Obsoleted by RFC 4210 PKIXCMP, 1.3.6.1.5.5.7.0.16
--                                   (id-mod-cmp2000)
-- [RFC4210]
--    1988 Syntax, PKIXCMP, 1.3.6.1.5.5.7.0.16 (id-mod-cmp2000)
--    Replaced by RFC 9480 PKIXCMP, 1.3.6.1.5.5.7.0.99
--                                  (id-mod-cmp2021-88)
-- [RFC5912]
--    2002 Syntax, PKIXCMP-2009, 1.3.6.1.5.5.7.0.50
--                               (id-mod-cmp2000-02)
--    Replaced by RFC 9480 PKIXCMP-2021, 1.3.6.1.5.5.7.0.100
--                                       (id-mod-cmp2021-02)
-- [RFC9480]
--    1988 Syntax, PKIXCMP, 1.3.6.1.5.5.7.0.99 (id-mod-cmp2021-88)
--    2002 Syntax, PKIXCMP-2021, 1.3.6.1.5.5.7.0.100
--                               (id-mod-cmp2021-02)
--    Obsoleted by [RFCXXXX] PKIXCMP-2023, 1.3.6.1.5.5.7.0.TBD2
--                                         (id-mod-cmp2023-02)
-- [RFCXXXX]
--    2002 Syntax, PKIXCMP-2023, 1.3.6.1.5.5.7.0.TBD2
--                               (id-mod-cmp2023-02)


-- The rest of the module contains locally defined OIDs and
-- constructs:

CMPCertificate ::= CHOICE { x509v3PKCert Certificate, ... }
-- This syntax, while bits-on-the-wire compatible with the
-- standard X.509 definition of "Certificate", allows the
-- possibility of future certificate types (such as X.509
-- attribute certificates, card-verifiable certificates, or other
-- kinds of certificates) within this Certificate Management
-- Protocol, should a need ever arise to support such generality.
-- Those implementations that do not foresee a need to ever support
-- other certificate types MAY, if they wish, comment out the
-- above structure and "uncomment" the following one prior to
-- compiling this ASN.1 module.  (Note that interoperability
-- with implementations that don't do this will be unaffected by
-- this change.)

-- CMPCertificate ::= Certificate

PKIMessage ::= SEQUENCE {
    header           PKIHeader,
    body             PKIBody,
    protection   [0] PKIProtection OPTIONAL,
    extraCerts   [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                  OPTIONAL }

PKIMessages ::= SEQUENCE SIZE (1..MAX) OF PKIMessage

PKIHeader ::= SEQUENCE {
    pvno                INTEGER     { cmp1999(1), cmp2000(2),
                                      cmp2021(3) },
    sender              GeneralName,
    -- identifies the sender
    recipient           GeneralName,
    -- identifies the intended recipient
    messageTime     [0] GeneralizedTime         OPTIONAL,
    -- time of production of this message (used when sender
    -- believes that the transport will be "suitable", i.e.,
    -- that the time will still be meaningful upon receipt)
    protectionAlg   [1] AlgorithmIdentifier{ALGORITHM, {...}}
                            OPTIONAL,
    -- algorithm used for calculation of protection bits
    senderKID       [2] KeyIdentifier           OPTIONAL,
    recipKID        [3] KeyIdentifier           OPTIONAL,
    -- to identify specific keys used for protection
    transactionID   [4] OCTET STRING            OPTIONAL,
    -- identifies the transaction, i.e., this will be the same in
    -- corresponding request, response, certConf, and PKIConf
    -- messages
    senderNonce     [5] OCTET STRING            OPTIONAL,
    recipNonce      [6] OCTET STRING            OPTIONAL,
    -- nonces used to provide replay protection, senderNonce
    -- is inserted by the creator of this message; recipNonce
    -- is a nonce previously inserted in a related message by
    -- the intended recipient of this message.
    freeText        [7] PKIFreeText             OPTIONAL,
    -- this may be used to indicate context-specific instructions
    -- (this field is intended for human consumption)
    generalInfo     [8] SEQUENCE SIZE (1..MAX) OF
                        InfoTypeAndValue     OPTIONAL
    -- this may be used to convey context-specific information
    -- (this field not primarily intended for human consumption)
}

PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
    -- text encoded as UTF-8 string [RFC3629]

PKIBody ::= CHOICE {       -- message-specific body elements
    ir       [0]  CertReqMessages,        --Initialization Request
    ip       [1]  CertRepMessage,         --Initialization Response
    cr       [2]  CertReqMessages,        --Certification Request
    cp       [3]  CertRepMessage,         --Certification Response
    p10cr    [4]  CertificationRequest,   --imported from [RFC2986]
    popdecc  [5]  POPODecKeyChallContent, --pop Challenge
    popdecr  [6]  POPODecKeyRespContent,  --pop Response
    kur      [7]  CertReqMessages,        --Key Update Request
    kup      [8]  CertRepMessage,         --Key Update Response
    krr      [9]  CertReqMessages,        --Key Recovery Request
    krp      [10] KeyRecRepContent,       --Key Recovery Response
    rr       [11] RevReqContent,          --Revocation Request
    rp       [12] RevRepContent,          --Revocation Response
    ccr      [13] CertReqMessages,        --Cross-Cert. Request
    ccp      [14] CertRepMessage,         --Cross-Cert. Response
    ckuann   [15] CAKeyUpdContent,        --CA Key Update Ann.
    cann     [16] CertAnnContent,         --Certificate Ann.
    rann     [17] RevAnnContent,          --Revocation Ann.
    crlann   [18] CRLAnnContent,          --CRL Announcement
    pkiconf  [19] PKIConfirmContent,      --Confirmation
    nested   [20] NestedMessageContent,   --Nested Message
    genm     [21] GenMsgContent,          --General Message
    genp     [22] GenRepContent,          --General Response
    error    [23] ErrorMsgContent,        --Error Message
    certConf [24] CertConfirmContent,     --Certificate Confirm
    pollReq  [25] PollReqContent,         --Polling Request
    pollRep  [26] PollRepContent          --Polling Response
}

PKIProtection ::= BIT STRING

ProtectedPart ::= SEQUENCE {
    header    PKIHeader,
    body      PKIBody }

id-PasswordBasedMac OBJECT IDENTIFIER ::= { iso(1) member-body(2)
    usa(840) nt(113533) nsn(7) algorithms(66) 13 }
PBMParameter ::= SEQUENCE {
    salt                OCTET STRING,
    -- Note:  Implementations MAY wish to limit acceptable sizes
    -- of this string to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks.
    owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}},
    -- AlgId for the One-Way Function
    iterationCount      INTEGER,
    -- number of times the OWF is applied
    -- Note:  Implementations MAY wish to limit acceptable sizes
    -- of this integer to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks.
    mac                 AlgorithmIdentifier{MAC-ALGORITHM, {...}}
    -- AlgId of the Message Authentication Code algorithm
}

id-DHBasedMac OBJECT IDENTIFIER ::= { iso(1) member-body(2)
    usa(840) nt(113533) nsn(7) algorithms(66) 30 }
DHBMParameter ::= SEQUENCE {
    owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}},
    -- AlgId for a One-Way Function
    mac                 AlgorithmIdentifier{MAC-ALGORITHM, {...}}
    -- AlgId of the Message Authentication Code algorithm
}

-- id-KemBasedMac and KemBMParameter were added in [RFCXXXX]

id-KemBasedMac OBJECT IDENTIFIER ::= { iso(1) member-body(2)
    usa(840) nt(113533) nsn(7) algorithms(66) 16 }
KemBMParameter ::= SEQUENCE {
    kdf              AlgorithmIdentifier{KEY-DERIVATION, {...}},
    -- AlgId of the Key Derivation Function algorithm
    kemContext   [0] OCTET STRING OPTIONAL,
    -- MAY contain additional algorithm specific context information
    len              INTEGER (1..MAX),
    -- Defines the length of the keying material output of the KDF
    -- SHOULD be the maximum key length of the MAC function
    mac              AlgorithmIdentifier{MAC-ALGORITHM, {...}}
    -- AlgId of the Message Authentication Code algorithm
}

PKIStatus ::= INTEGER {
    accepted               (0),
    -- you got exactly what you asked for
    grantedWithMods        (1),
    -- you got something like what you asked for; the
    -- requester is responsible for ascertaining the differences
    rejection              (2),
    -- you don't get it, more information elsewhere in the message
    waiting                (3),
    -- the request body part has not yet been processed; expect to
    -- hear more later (note: proper handling of this status
    -- response MAY use the polling req/rep PKIMessages specified
    -- in Section 5.3.22; alternatively, polling in the underlying
    -- transport layer MAY have some utility in this regard)
    revocationWarning      (4),
    -- this message contains a warning that a revocation is
    -- imminent
    revocationNotification (5),
    -- notification that a revocation has occurred
    keyUpdateWarning       (6)
    -- update already done for the oldCertId specified in
    -- CertReqMsg
}

PKIFailureInfo ::= BIT STRING {
-- since we can fail in more than one way!
-- More codes may be added in the future if/when required.
    badAlg              (0),
    -- unrecognized or unsupported algorithm identifier
    badMessageCheck     (1),
    -- integrity check failed (e.g., signature did not verify)
    badRequest          (2),
    -- transaction not permitted or supported
    badTime             (3),
    -- messageTime was not sufficiently close to the system time,
    -- as defined by local policy
    badCertId           (4),
    -- no certificate could be found matching the provided criteria
    badDataFormat       (5),
    -- the data submitted has the wrong format
    wrongAuthority      (6),
    -- the authority indicated in the request is different from the
    -- one creating the response token
    incorrectData       (7),
    -- the requester's data is incorrect (for notary services)
    missingTimeStamp    (8),
    -- when the timestamp is missing but should be there
    -- (by policy)
    badPOP              (9),
    -- the proof-of-possession failed
    certRevoked         (10),
    -- the certificate has already been revoked
    certConfirmed       (11),
    -- the certificate has already been confirmed
    wrongIntegrity      (12),
    -- KEM ciphertext missing for MAC-based protection of response,
    -- or not valid integrity of message received (password based
    -- instead of signature or vice versa)
    badRecipientNonce   (13),
    -- not valid recipient nonce, either missing or wrong value
    timeNotAvailable    (14),
    -- the TSA's time source is not available
    unacceptedPolicy    (15),
    -- the requested TSA policy is not supported by the TSA
    unacceptedExtension (16),
    -- the requested extension is not supported by the TSA
    addInfoNotAvailable (17),
    -- the additional information requested could not be
    -- understood or is not available
    badSenderNonce      (18),
    -- not valid sender nonce, either missing or wrong size
    badCertTemplate     (19),
    -- not valid cert. template or missing mandatory information
    signerNotTrusted    (20),
    -- signer of the message unknown or not trusted
    transactionIdInUse  (21),
    -- the transaction identifier is already in use
    unsupportedVersion  (22),
    -- the version of the message is not supported
    notAuthorized       (23),
    -- the sender was not authorized to make the preceding
    -- request or perform the preceding action
    systemUnavail       (24),
    -- the request cannot be handled due to system unavailability
    systemFailure       (25),
    -- the request cannot be handled due to system failure
    duplicateCertReq    (26)
    -- certificate cannot be issued because a duplicate
    -- certificate already exists
}

PKIStatusInfo ::= SEQUENCE {
    status        PKIStatus,
    statusString  PKIFreeText     OPTIONAL,
    failInfo      PKIFailureInfo  OPTIONAL }

OOBCert ::= CMPCertificate

OOBCertHash ::= SEQUENCE {
    hashAlg     [0] AlgorithmIdentifier{DIGEST-ALGORITHM, {...}}
                        OPTIONAL,
    certId      [1] CertId                  OPTIONAL,
    hashVal         BIT STRING
    -- hashVal is calculated over the DER encoding of the
    -- self-signed certificate with the identifier certID.
}

POPODecKeyChallContent ::= SEQUENCE OF Challenge
-- One Challenge per encryption or key agreement key certification
-- request (in the same order as these requests appear in
-- CertReqMessages).

-- encryptedRand was added in [RFCXXXX]

Challenge ::= SEQUENCE {
   owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}}
                            OPTIONAL,
   -- MUST be present in the first Challenge; MAY be omitted in
   -- any subsequent Challenge in POPODecKeyChallContent (if
   -- omitted, then the owf used in the immediately preceding
   -- Challenge is to be used).
   witness             OCTET STRING,
   -- the result of applying the one-way function (owf) to a
   -- randomly-generated INTEGER, A. (Note that a different
   -- INTEGER MUST be used for each Challenge.)
   challenge           OCTET STRING,
   -- MUST be used for cmp2000(2) popdecc messages and MUST be
   -- the encryption of Rand (using a mechanism depending on the
   -- private key type).
   -- MUST be an empty OCTET STRING for cmp2021(3) popdecc messages.
   -- Note: Using challenge omitting the optional encryptedRand is
   -- bit-compatible to the syntax without adding this optional
   -- field.
   encryptedRand   [0] EnvelopedData OPTIONAL
   -- MUST be omitted for cmp2000(2) popdecc messages.
   -- MUST be used for cmp2021(3) popdecc messages and MUST contain
   -- the encrypted value of Rand using CMS EnvelopedData using the
   -- key management technique depending on the private key type as
   -- defined in Section 5.2.2.
}

-- Rand was added in [RFC9480]

Rand ::= SEQUENCE {
-- Rand is encrypted involving the public key to form the content of
-- challenge or encryptedRand in POPODecKeyChallContent
   int                  INTEGER,
   -- the randomly generated INTEGER A (above)
   sender               GeneralName
   -- the sender's name (as included in PKIHeader)
}

POPODecKeyRespContent ::= SEQUENCE OF INTEGER
-- One INTEGER per encryption or key agreement key certification
-- request (in the same order as these requests appear in
-- CertReqMessages). The retrieved INTEGER A (above) is returned to
-- the sender of the corresponding Challenge.

CertRepMessage ::= SEQUENCE {
    caPubs       [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                  OPTIONAL,
    response         SEQUENCE OF CertResponse }

CertResponse ::= SEQUENCE {
    certReqId           INTEGER,
    -- to match this response with the corresponding request (a value
    -- of -1 is to be used if certReqId is not specified in the
    -- corresponding request, which can only be a p10cr)
    status              PKIStatusInfo,
    certifiedKeyPair    CertifiedKeyPair    OPTIONAL,
    rspInfo             OCTET STRING        OPTIONAL
    -- analogous to the id-regInfo-utf8Pairs string defined
    -- for regInfo in CertReqMsg [RFC4211]
}

CertifiedKeyPair ::= SEQUENCE {
    certOrEncCert       CertOrEncCert,
    privateKey      [0] EncryptedKey      OPTIONAL,
    -- See [RFC4211] for comments on encoding.
    -- Changed from EncryptedValue to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- [RFC9480].
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change.
    publicationInfo [1] PKIPublicationInfo  OPTIONAL }

CertOrEncCert ::= CHOICE {
    certificate     [0] CMPCertificate,
    encryptedCert   [1] EncryptedKey
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- [RFC9480].
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change.
}

KeyRecRepContent ::= SEQUENCE {
    status                  PKIStatusInfo,
    newSigCert          [0] CMPCertificate OPTIONAL,
    caCerts             [1] SEQUENCE SIZE (1..MAX) OF
                                     CMPCertificate OPTIONAL,
    keyPairHist         [2] SEQUENCE SIZE (1..MAX) OF
                                     CertifiedKeyPair OPTIONAL }

RevReqContent ::= SEQUENCE OF RevDetails

RevDetails ::= SEQUENCE {
    certDetails         CertTemplate,
    -- allows requester to specify as much as they can about
    -- the cert. for which revocation is requested
    -- (e.g., for cases in which serialNumber is not available)
    crlEntryDetails     Extensions{{...}}    OPTIONAL
    -- requested crlEntryExtensions
}

RevRepContent ::= SEQUENCE {
    status       SEQUENCE SIZE (1..MAX) OF PKIStatusInfo,
    -- in same order as was sent in RevReqContent
    revCerts [0] SEQUENCE SIZE (1..MAX) OF CertId OPTIONAL,
    -- IDs for which revocation was requested
    -- (same order as status)
    crls     [1] SEQUENCE SIZE (1..MAX) OF CertificateList OPTIONAL
    -- the resulting CRLs (there may be more than one)
}

CAKeyUpdAnnContent ::= SEQUENCE {
    oldWithNew   CMPCertificate, -- old pub signed with new priv
    newWithOld   CMPCertificate, -- new pub signed with old priv
    newWithNew   CMPCertificate  -- new pub signed with new priv
}

-- CAKeyUpdContent was added in [RFCXXXX]
CAKeyUpdContent ::= CHOICE {
    cAKeyUpdAnnV2      CAKeyUpdAnnContent, -- deprecated
    cAKeyUpdAnnV3  [0] RootCaKeyUpdateContent
}
-- With cmp2021 the use of CAKeyUpdAnnContent is deprecated , use
-- RootCaKeyUpdateContent instead.

CertAnnContent ::= CMPCertificate

RevAnnContent ::= SEQUENCE {
    status              PKIStatus,
    certId              CertId,
    willBeRevokedAt     GeneralizedTime,
    badSinceDate        GeneralizedTime,
    crlDetails          Extensions{{...}}  OPTIONAL
    -- extra CRL details (e.g., crl number, reason, location, etc.)
}

CRLAnnContent ::= SEQUENCE OF CertificateList

PKIConfirmContent ::= NULL

NestedMessageContent ::= PKIMessages

-- CertReqTemplateContent, AttributeTypeAndValue,
-- ExpandedRegControlSet, id-regCtrl-altCertTemplate,
-- AltCertTemplate, regCtrl-algId, id-regCtrl-algId, AlgIdCtrl,
-- regCtrl-rsaKeyLen, id-regCtrl-rsaKeyLen, and RsaKeyLenCtrl
-- were added in [RFC9480]

CertReqTemplateContent ::= SEQUENCE {
   certTemplate           CertTemplate,
   -- prefilled certTemplate structure elements
   -- The SubjectPublicKeyInfo field in the certTemplate MUST NOT
   -- be used.
   keySpec                Controls OPTIONAL
   -- MAY be used to specify supported algorithms
   -- Controls  ::= SEQUENCE SIZE (1..MAX) OF AttributeTypeAndValue
   -- as specified in CRMF [RFC4211]
   }

AttributeTypeAndValue ::= SingleAttribute{{ ... }}

ExpandedRegControlSet ATTRIBUTE ::= { RegControlSet |
   regCtrl-altCertTemplate | regCtrl-algId | regCtrl-rsaKeyLen, ... }

regCtrl-altCertTemplate ATTRIBUTE ::=
   { TYPE AltCertTemplate IDENTIFIED BY id-regCtrl-altCertTemplate }

id-regCtrl-altCertTemplate OBJECT IDENTIFIER ::= { id-regCtrl 7 }

AltCertTemplate ::= AttributeTypeAndValue
   -- specifies a template for a certificate other than an X.509v3
   -- public key certificate

regCtrl-algId ATTRIBUTE ::=
   { TYPE AlgIdCtrl IDENTIFIED BY id-regCtrl-algId }

id-regCtrl-algId OBJECT IDENTIFIER ::= { id-regCtrl 11 }

AlgIdCtrl ::= AlgorithmIdentifier{ALGORITHM, {...}}
   -- SHALL be used to specify supported algorithms other than RSA

regCtrl-rsaKeyLen ATTRIBUTE ::=
   { TYPE RsaKeyLenCtrl IDENTIFIED BY id-regCtrl-rsaKeyLen }

id-regCtrl-rsaKeyLen OBJECT IDENTIFIER ::= { id-regCtrl 12 }

RsaKeyLenCtrl ::= INTEGER (1..MAX)
   -- SHALL be used to specify supported RSA key lengths

-- RootCaKeyUpdateContent, CRLSource, and CRLStatus were added in
-- [RFC9480]

RootCaKeyUpdateContent ::= SEQUENCE {
   newWithNew       CMPCertificate,
   -- new root CA certificate
   newWithOld   [0] CMPCertificate OPTIONAL,
   -- X.509 certificate containing the new public root CA key
   -- signed with the old private root CA key
   oldWithNew   [1] CMPCertificate OPTIONAL
   -- X.509 certificate containing the old public root CA key
   -- signed with the new private root CA key
   }

CRLSource ::= CHOICE {
   dpn          [0] DistributionPointName,
   issuer       [1] GeneralNames }

CRLStatus ::= SEQUENCE {
   source       CRLSource,
   thisUpdate   Time OPTIONAL }

-- KemCiphertextInfo and KemOtherInfo were added in [RFCXXXX]

KemCiphertextInfo ::= SEQUENCE {
   kem              AlgorithmIdentifier{KEM-ALGORITHM, {...}},
   -- AlgId of the Key Encapsulation Mechanism algorithm
   ct               OCTET STRING
   -- Ciphertext output from the Encapsulate function
   }

KemOtherInfo ::= SEQUENCE {
   staticString     PKIFreeText,
   -- MUST be "CMP-KEM"
   transactionID    OCTET STRING,
   -- MUST contain the values from the message previously received
   -- containing the ciphertext (ct) in KemCiphertextInfo
   kemContext   [0] OCTET STRING OPTIONAL
   -- MAY contain additional algorithm specific context information
  }

INFO-TYPE-AND-VALUE ::= TYPE-IDENTIFIER

InfoTypeAndValue ::= SEQUENCE {
    infoType    INFO-TYPE-AND-VALUE.
                    &amp;id({SupportedInfoSet}),
    infoValue   INFO-TYPE-AND-VALUE.
                    &amp;Type({SupportedInfoSet}{@infoType}) }

SupportedInfoSet INFO-TYPE-AND-VALUE ::= { ... }

-- Example InfoTypeAndValue contents include, but are not limited
-- to, the following (uncomment in this ASN.1 module and use as
-- appropriate for a given environment):
--
--   id-it-caProtEncCert    OBJECT IDENTIFIER ::= {id-it 1}
--      CAProtEncCertValue      ::= CMPCertificate
--   id-it-signKeyPairTypes OBJECT IDENTIFIER ::= {id-it 2}
--      SignKeyPairTypesValue   ::= SEQUENCE SIZE (1..MAX) OF
--                                      AlgorithmIdentifier{{...}}
--   id-it-encKeyPairTypes  OBJECT IDENTIFIER ::= {id-it 3}
--      EncKeyPairTypesValue    ::= SEQUENCE SIZE (1..MAX) OF
--                                      AlgorithmIdentifier{{...}}
--   id-it-preferredSymmAlg OBJECT IDENTIFIER ::= {id-it 4}
--      PreferredSymmAlgValue   ::= AlgorithmIdentifier{{...}}
--   id-it-caKeyUpdateInfo  OBJECT IDENTIFIER ::= {id-it 5}
--      CAKeyUpdateInfoValue    ::= CAKeyUpdAnnContent
--      - id-it-caKeyUpdateInfo was deprecated with cmp2021
--   id-it-currentCRL       OBJECT IDENTIFIER ::= {id-it 6}
--      CurrentCRLValue         ::= CertificateList
--   id-it-unsupportedOIDs  OBJECT IDENTIFIER ::= {id-it 7}
--      UnsupportedOIDsValue    ::= SEQUENCE SIZE (1..MAX) OF
--                                          OBJECT IDENTIFIER
--   id-it-keyPairParamReq  OBJECT IDENTIFIER ::= {id-it 10}
--      KeyPairParamReqValue    ::= OBJECT IDENTIFIER
--   id-it-keyPairParamRep  OBJECT IDENTIFIER ::= {id-it 11}
--      KeyPairParamRepValue    ::= AlgorithmIdentifier{{...}}
--   id-it-revPassphrase    OBJECT IDENTIFIER ::= {id-it 12}
--      RevPassphraseValue      ::= EncryptedKey
--      - Changed from Encrypted Value to EncryptedKey as a CHOICE
--      - of EncryptedValue and EnvelopedData due to the changes
--      - made in [RFC9480]
--      - Using the choice EncryptedValue is bit-compatible to
--      - the syntax without this change
--   id-it-implicitConfirm  OBJECT IDENTIFIER ::= {id-it 13}
--      ImplicitConfirmValue    ::= NULL
--   id-it-confirmWaitTime  OBJECT IDENTIFIER ::= {id-it 14}
--      ConfirmWaitTimeValue    ::= GeneralizedTime
--   id-it-origPKIMessage   OBJECT IDENTIFIER ::= {id-it 15}
--      OrigPKIMessageValue     ::= PKIMessages
--   id-it-suppLangTags     OBJECT IDENTIFIER ::= {id-it 16}
--      SuppLangTagsValue       ::= SEQUENCE OF UTF8String
--   id-it-caCerts          OBJECT IDENTIFIER ::= {id-it 17}
--      CaCertsValue            ::= SEQUENCE SIZE (1..MAX) OF
--                                             CMPCertificate
--      - id-it-caCerts added in [RFC9480]
--   id-it-rootCaKeyUpdate  OBJECT IDENTIFIER ::= {id-it 18}
--      RootCaKeyUpdateValue    ::= RootCaKeyUpdateContent
--      - id-it-rootCaKeyUpdate added in [RFC9480]
--   id-it-certReqTemplate  OBJECT IDENTIFIER ::= {id-it 19}
--      CertReqTemplateValue    ::= CertReqTemplateContent
--      - id-it-certReqTemplate added in [RFC9480]
--   id-it-rootCaCert       OBJECT IDENTIFIER ::= {id-it 20}
--      RootCaCertValue         ::= CMPCertificate
--      - id-it-rootCaCert added in [RFC9480]
--   id-it-certProfile      OBJECT IDENTIFIER ::= {id-it 21}
--      CertProfileValue        ::= SEQUENCE SIZE (1..MAX) OF
--                                                 UTF8String
--      - id-it-certProfile added in [RFC9480]
--   id-it-crlStatusList    OBJECT IDENTIFIER ::= {id-it 22}
--      CRLStatusListValue      ::= SEQUENCE SIZE (1..MAX) OF
--                                                  CRLStatus
--      - id-it-crlStatusList added in [RFC9480]
--   id-it-crls             OBJECT IDENTIFIER ::= {id-it 23}
--      CRLsValue               ::= SEQUENCE SIZE (1..MAX) OF
--                                            CertificateList
--      - id-it-crls added in [RFC9480]
--   id-it-KemCiphertextInfo    OBJECT IDENTIFIER ::= {id-it TBD1}
--      KemCiphertextInfoValue  ::= KemCiphertextInfo
--      - id-it-KemCiphertextInfo was added in [RFCXXXX]
--
-- where
--
--   id-pkix OBJECT IDENTIFIER ::= {
--      iso(1) identified-organization(3)
--      dod(6) internet(1) security(5) mechanisms(5) pkix(7)}
-- and
--   id-it   OBJECT IDENTIFIER ::= {id-pkix 4}
--
--
-- This construct MAY also be used to define new PKIX Certificate
-- Management Protocol request and response messages or
-- general-purpose (e.g., announcement) messages for future needs
-- or for specific environments.

GenMsgContent ::= SEQUENCE OF InfoTypeAndValue

-- May be sent by EE, RA, or CA (depending on message content).
-- The OPTIONAL infoValue parameter of InfoTypeAndValue will
-- typically be omitted for some of the examples given above.
-- The receiver is free to ignore any contained OIDs that it
-- does not recognize.  If sent from EE to CA, the empty set
-- indicates that the CA may send
-- any/all information that it wishes.

GenRepContent ::= SEQUENCE OF InfoTypeAndValue
-- The receiver MAY ignore any contained OIDs that it does not
-- recognize.

ErrorMsgContent ::= SEQUENCE {
    pKIStatusInfo          PKIStatusInfo,
    errorCode              INTEGER           OPTIONAL,
    -- implementation-specific error codes
    errorDetails           PKIFreeText       OPTIONAL
    -- implementation-specific error details
}

CertConfirmContent ::= SEQUENCE OF CertStatus

CertStatus ::= SEQUENCE {
    certHash    OCTET STRING,
    -- the hash of the certificate, using the same hash algorithm
    -- as is used to create and verify the certificate signature
    certReqId   INTEGER,
    -- to match this confirmation with the corresponding req/rep
    statusInfo  PKIStatusInfo OPTIONAL,
    hashAlg [0] AlgorithmIdentifier{DIGEST-ALGORITHM, {...}} OPTIONAL
    -- the hash algorithm to use for calculating certHash
    -- SHOULD NOT be used in all cases where the AlgorithmIdentifier
    -- of the certificate signature specifies a hash algorithm
   }

PollReqContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER }

PollRepContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER,
    checkAfter             INTEGER,  -- time in seconds
    reason                 PKIFreeText OPTIONAL }

--
-- Extended key usage extension for PKI entities used in CMP
-- operations, added due to the changes made in [RFC9480]
-- The EKUs for the CA and RA are reused from CMC, as defined in
-- [RFC6402]
--

-- id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp 27 }
-- id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp 28 }
id-kp-cmKGA OBJECT IDENTIFIER ::= { id-kp 32 }

END
</pre><a href="#appendix-F-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sect-g">
<section id="appendix-G">
      <h2 id="name-history-of-changes">
<a href="#appendix-G" class="section-number selfRef">Appendix G. </a><a href="#name-history-of-changes" class="section-name selfRef">History of Changes</a>
      </h2>
<p id="appendix-G-1">Note: This appendix will be deleted in the final version of the document.<a href="#appendix-G-1" class="pilcrow">¶</a></p>
<p id="appendix-G-2">From version 15 -&gt; 16:<a href="#appendix-G-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-3.1">
          <p id="appendix-G-3.1.1">Addressed IESG review comments from Erik Kline, Gunter Van de Velde, Orie Steele, Zaheduzzaman Sarker, Éric Vyncke, and Paul Wouters, except the DISCUSS issue Paul raised<a href="#appendix-G-3.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-4">From version 14 -&gt; 15:<a href="#appendix-G-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-5.1">
          <p id="appendix-G-5.1.1">Addressed SECDIR, OPSDIR, and TSVART review comments<a href="#appendix-G-5.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-6">From version 13 -&gt; 14:<a href="#appendix-G-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-7.1">
          <p id="appendix-G-7.1.1">Implemented some editorial changes throughout the document, specifically in Sections 5.1.1, 5.1.1.3, 5.1.3.4, 5.2.2, 5.2.8.3, 5.3.18, 5.3.19.2, 5.2.22, 7, C.1, and C.4<a href="#appendix-G-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-7.2">
          <p id="appendix-G-7.2.1">Aligned formatting of message flow diagrams<a href="#appendix-G-7.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-7.3">
          <p id="appendix-G-7.3.1">Updated the page header to 'CMP'<a href="#appendix-G-7.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-7.4">
          <p id="appendix-G-7.4.1">Removed one instruction to RFC Editors<a href="#appendix-G-7.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-7.5">
          <p id="appendix-G-7.5.1">Fixed some nits in Section 5.2.2<a href="#appendix-G-7.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-7.6">
          <p id="appendix-G-7.6.1">Fixed one reference to RFC 9629 in the ASN.1 Module<a href="#appendix-G-7.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-8">From version 12 -&gt; 13:<a href="#appendix-G-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-9.1">
          <p id="appendix-G-9.1.1">Updated the definition of "NULL-DN" in Section 5.1.1 and Appendix D.1 and added a specification of how the RA/CA shall generate the rid content to Section 5.2.8.3.3 to clarify direct POP (see thread "CMS RecipientInfo for EnvelopedData in CMC")<a href="#appendix-G-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-9.2">
          <p id="appendix-G-9.2.1">Added one minor clarification in Section 5.2.2<a href="#appendix-G-9.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-9.3">
          <p id="appendix-G-9.3.1">Updated reference from draft-ietf-lamps-cms-kemri to RFC 9629<a href="#appendix-G-9.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-10">From version 11 -&gt; 12:<a href="#appendix-G-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-11.1">
          <p id="appendix-G-11.1.1">Adding a paragraph to Section 5.2.8.3.2 to clarify Indirect POP (see thread "Using cms-kemri this CMP Indirect POP")<a href="#appendix-G-11.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-11.2">
          <p id="appendix-G-11.2.1">Updated Appendix F addressing comments from Russ (see thread "WG Last Call for draft-ietf-lamps-rfc4210bis and draft-ietf-lamps-rfc6712bis")<a href="#appendix-G-11.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-11.3">
          <p id="appendix-G-11.3.1">Extended the Acknowledgments section.<a href="#appendix-G-11.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-12">From version 10 -&gt; 11:<a href="#appendix-G-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-13.1">
          <p id="appendix-G-13.1.1">Updated Section 4.2.2 addressing the comment from Tomas Gustavsson and as presented during IETF 119 (see thread "draft-ietf-lamps-rfc4210bis-v10 Section 4.2.2 - removing normative language")<a href="#appendix-G-13.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-14">From version 09 -&gt; 10:<a href="#appendix-G-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-15.1">
          <p id="appendix-G-15.1.1">Implemented some minor editorial changes modernizing the text in Section 3, 4, and 5.2.8 as proposed during IETF 119, without changing normative language.<a href="#appendix-G-15.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-15.2">
          <p id="appendix-G-15.2.1">Added to Section 4.2.2 two ToDos for further discussion, based on the comment from Tomas Gustavsson as presented during IETF 119.<a href="#appendix-G-15.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-15.3">
          <p id="appendix-G-15.3.1">Addressed erratum 7888<a href="#appendix-G-15.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-16">From version 08 -&gt; 09:<a href="#appendix-G-16" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-17.1">
          <p id="appendix-G-17.1.1">Changed reference from ITU-T X.509 to RFC 5280 (see thread " CMP vs RFC5280").<a href="#appendix-G-17.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-17.2">
          <p id="appendix-G-17.2.1">Deprecated CAKeyUpdAnnContent in favor of RootCaKeyUpdateContent in CMP V3 as proposed by Tomas.<a href="#appendix-G-17.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-17.3">
          <p id="appendix-G-17.3.1">Updated Section 4.4 incorporating RootCaKeyUpdateContent as alternative to using a repository for providing root CA key updates.<a href="#appendix-G-17.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-17.4">
          <p id="appendix-G-17.4.1">Deleting an obsolete sentence in Section 8.8.<a href="#appendix-G-17.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-17.5">
          <p id="appendix-G-17.5.1">Added IANA considerations addressing IANA early review.<a href="#appendix-G-17.5.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-18">From version 07 -&gt; 08:<a href="#appendix-G-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-19.1">
          <p id="appendix-G-19.1.1">Aligned with released RFC 9480 - RFC 9483<a href="#appendix-G-19.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.2">
          <p id="appendix-G-19.2.1">Updated Section 1.3<a href="#appendix-G-19.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.3">
          <p id="appendix-G-19.3.1">Added text on usage of transactionID with KEM-bases message protection to Section 5.1.1<a href="#appendix-G-19.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.4">
          <p id="appendix-G-19.4.1">Reverted a change to Section 5.1.3.1 from -02 and reinserting the deleted text and adding some text explaining when a key expansion is required.<a href="#appendix-G-19.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.5">
          <p id="appendix-G-19.5.1">Consolidated the definition and transferal of KemCiphertextInfo. Added a new Section 5.1.1.5 introducing KemCiphertextInfo in the generalInfo filed and moving text on how to request a KEM ciphertext using genm/genp from Section 5.1.3.4 to Section 5.3.19.18<a href="#appendix-G-19.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.6">
          <p id="appendix-G-19.6.1">Some editorial changes to Section 5.1.3.4 and Appendix E after discussion with David resolving #30 and discussing at IETF 117. Also introducing optional field kemContext to KemBasedMac and KemOtherInfo as CMP-specific alternative to ukm in cms-kemri.<a href="#appendix-G-19.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.7">
          <p id="appendix-G-19.7.1">Added ToDo for reviewing the reduced content of KemOtherInfo to Section 5.1.3.4<a href="#appendix-G-19.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.8">
          <p id="appendix-G-19.8.1">Added a cross-reference to Section 5.1.1.3 regarding use of OrigPKIMessage to Section 5.1.3.5<a href="#appendix-G-19.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.9">
          <p id="appendix-G-19.9.1">Added POP for KEM keys to Section 5.2.8. Restructured the section and fixed some references which broke from RFC2510 to RFC4210. Introduced a section on the usage of raVerified.<a href="#appendix-G-19.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.10">
          <p id="appendix-G-19.10.1">Fixed the issue in Section 5.3.19.15, resulting from a change made in draft-ietf-lamps-cmp-updates-14, that no plain public-key can be used in the request message in CMPCertificate.<a href="#appendix-G-19.10.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-19.11">
          <p id="appendix-G-19.11.1">Updated Appendix B regarding KEM-based message protection and usage of CMS EnvelopedData<a href="#appendix-G-19.11.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-20">From version 06 -&gt; 07:<a href="#appendix-G-20" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-21.1">
          <p id="appendix-G-21.1.1">Updated section 5.1.1.4 addressing a question from Liao Lijun on how to interpret less profile names than certReqMsgs<a href="#appendix-G-21.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-21.2">
          <p id="appendix-G-21.2.1">Updated section 5.1.3.4 specifying establishing a shares secret key for one arbitrary side of the CMP communication only<a href="#appendix-G-21.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-21.3">
          <p id="appendix-G-21.3.1">Removed the note and the security consideration regarding combiner function for HPKE<a href="#appendix-G-21.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-21.4">
          <p id="appendix-G-21.4.1">Added security considerations 8.1 and 8.8<a href="#appendix-G-21.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-21.5">
          <p id="appendix-G-21.5.1">Updates IANA Considerations in section 9 to add new OID for the updates ASN.1 module and for id-it-KemCiphertextInfo<a href="#appendix-G-21.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-21.6">
          <p id="appendix-G-21.6.1">Added new appendix E showing different variants of using KEM keys for PKI message protection<a href="#appendix-G-21.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-21.7">
          <p id="appendix-G-21.7.1">Updates ASN.1 module in appendix F<a href="#appendix-G-21.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-22">From version 05 -&gt; 06:<a href="#appendix-G-22" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-23.1">
          <p id="appendix-G-23.1.1">Updated section 5.1.3.4 exchanging HPKE with plain KEM+KDF as also used in draft-ietf-lamps-cms-kemri<a href="#appendix-G-23.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-24">From version 04 -&gt; 05:<a href="#appendix-G-24" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-25.1">
          <p id="appendix-G-25.1.1">Updated sections 5.1.3.4, 5.2.2, and 8.9 addressing comments from Russ (see thread "I-D Action: draft-ietf-lamps-rfc4210bis-04.txt")<a href="#appendix-G-25.1.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-26">From version 03 -&gt; 04:<a href="#appendix-G-26" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-27.1">
          <p id="appendix-G-27.1.1">Added Section 4.3.4 regarding POP for KEM keys<a href="#appendix-G-27.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-27.2">
          <p id="appendix-G-27.2.1">Added Section 5.1.3.4 on message protection using KEM keys and HPKE<a href="#appendix-G-27.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-27.3">
          <p id="appendix-G-27.3.1">Aligned Section 5.2.2 on guidance which CMS key management technique to use with encrypted values (see thread "CMS: selection of key management technique to use for EnvelopedData") also adding support for KEM keys<a href="#appendix-G-27.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-27.4">
          <p id="appendix-G-27.4.1">Added Section 8.9 and extended Section 3.1.2 regarding use of Certificate Transparency logs<a href="#appendix-G-27.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-27.5">
          <p id="appendix-G-27.5.1">Deleted former Appendix C as announced in the -03<a href="#appendix-G-27.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-27.6">
          <p id="appendix-G-27.6.1">Fixed some nits resulting from XML -&gt; MD conversion<a href="#appendix-G-27.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-28">From version 02 -&gt; 03:<a href="#appendix-G-28" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-29.1">
          <p id="appendix-G-29.1.1">Updated Section 4.4.1 clarifying the definition of "new with new" certificate
validity period (see thread "RFC4210bis - notAfter time of newWithNew certificate")<a href="#appendix-G-29.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-29.2">
          <p id="appendix-G-29.2.1">Added ToDo to Section 4.3 and 5.2.8 on required alignment regarding POP for
KEM keys.<a href="#appendix-G-29.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-29.3">
          <p id="appendix-G-29.3.1">Updated Sections 5.2.1, 5.2.8, and 5.2.8.1 incorporating text of former Appendix
C (see thread "draft-ietf-lamps-rfc4210bis - ToDo on review of Appendix C")<a href="#appendix-G-29.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-29.4">
          <p id="appendix-G-29.4.1">Added a ToDo to Appendix B to indicate additional review need to try pushing
the content to Sections 4 and Section 5<a href="#appendix-G-29.4.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-30">From version 01 -&gt; 02:<a href="#appendix-G-30" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-31.1">
          <p id="appendix-G-31.1.1">Added Section 3.1.1.4 introducing the Key Generation Authority<a href="#appendix-G-31.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.2">
          <p id="appendix-G-31.2.1">Added Section 5.1.1.3 containing description of origPKIMessage content moved
here from Section 5.1.3.4<a href="#appendix-G-31.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.3">
          <p id="appendix-G-31.3.1">Added ToDos on defining POP and message protection using KEM keys<a href="#appendix-G-31.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.4">
          <p id="appendix-G-31.4.1">Added a ToDo to Section 4.4.3<a href="#appendix-G-31.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.5">
          <p id="appendix-G-31.5.1">Added a ToDo to Appendix C to do a more detailed review<a href="#appendix-G-31.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.6">
          <p id="appendix-G-31.6.1">Removed concrete algorithms and referred to CMP Algorithms instead<a href="#appendix-G-31.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.7">
          <p id="appendix-G-31.7.1">Added references to Appendix D and E as well as the Lightweight CMP Profile
for further information<a href="#appendix-G-31.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.8">
          <p id="appendix-G-31.8.1">Broaden the scope from human users also to devices and services<a href="#appendix-G-31.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.9">
          <p id="appendix-G-31.9.1">Addressed idnits feedback, specifically changing from historic LDAP V2 to
LDAP V3 (RFC4511)<a href="#appendix-G-31.9.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-31.10">
          <p id="appendix-G-31.10.1">Did some further editorial alignment to the XML<a href="#appendix-G-31.10.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-32">From version 00 -&gt; 01:<a href="#appendix-G-32" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-33.1">
          <p id="appendix-G-33.1.1">Performed all updates specified in CMP Updates Section 2 and Appendix A.2.<a href="#appendix-G-33.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-33.2">
          <p id="appendix-G-33.2.1">Did some editorial alignment to the XML<a href="#appendix-G-33.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="appendix-G-34">Version 00:<a href="#appendix-G-34" class="pilcrow">¶</a></p>
<p id="appendix-G-35">This version consists of the text of RFC4210 with the following changes:<a href="#appendix-G-35" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G-36.1">
          <p id="appendix-G-36.1.1">Introduced the authors of this document and thanked the authors of RFC4210
for their work.<a href="#appendix-G-36.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-36.2">
          <p id="appendix-G-36.2.1">Added a paragraph to the introduction explaining the background of this document.<a href="#appendix-G-36.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-G-36.3">
          <p id="appendix-G-36.3.1">Added the change history to this appendix.<a href="#appendix-G-36.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-H">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hendrik Brockhaus</span></div>
<div dir="auto" class="left"><span class="org">Siemens</span></div>
<div dir="auto" class="left"><span class="street-address">Werner-von-Siemens-Strasse 1</span></div>
<div dir="auto" class="left">
<span class="postal-code">80333</span> <span class="locality">Munich</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hendrik.brockhaus@siemens.com" class="email">hendrik.brockhaus@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.siemens.com" class="url">https://www.siemens.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David von Oheimb</span></div>
<div dir="auto" class="left"><span class="org">Siemens</span></div>
<div dir="auto" class="left"><span class="street-address">Werner-von-Siemens-Strasse 1</span></div>
<div dir="auto" class="left">
<span class="postal-code">80333</span> <span class="locality">Munich</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:david.von.oheimb@siemens.com" class="email">david.von.oheimb@siemens.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.siemens.com" class="url">https://www.siemens.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Ounsworth</span></div>
<div dir="auto" class="left"><span class="org">Entrust</span></div>
<div dir="auto" class="left"><span class="street-address">1187 Park Place</span></div>
<div dir="auto" class="left">
<span class="locality">Minneapolis</span>, <span class="region">MN</span> <span class="postal-code">55379</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mike.ounsworth@entrust.com" class="email">mike.ounsworth@entrust.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.entrust.com" class="url">https://www.entrust.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Gray</span></div>
<div dir="auto" class="left"><span class="org">Entrust</span></div>
<div dir="auto" class="left"><span class="street-address">1187 Park Place</span></div>
<div dir="auto" class="left">
<span class="locality">Minneapolis</span>, <span class="region">MN</span> <span class="postal-code">55379</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:john.gray@entrust.com" class="email">john.gray@entrust.com</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://www.entrust.com" class="url">https://www.entrust.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
